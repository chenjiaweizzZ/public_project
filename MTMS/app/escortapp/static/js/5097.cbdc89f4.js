"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[5097],{70241:function(t,e,i){i.d(e,{Z:function(){return f}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"g-wrapper"},[e("div",{staticClass:"title"},[e("span",[t._v(t._s(t.condition))]),e("img",{attrs:{src:i(18885),alt:""},on:{click:function(e){e.stopPropagation(),t.gettime.show=!0}}})]),t.noContent?t._e():e("div",{staticClass:"g-main"},t._l(t.aturndoctors,(function(n,s){return e("div",{staticClass:"list"},[e("ul",{on:{click:function(e){return t.plan(n)}}},[e("li",{staticClass:"head"},[e("div",{staticClass:"headDiv"},[e("img",{attrs:{src:i(6489),alt:""}}),e("div",[e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.name))]),e("span",[t._v(t._s(n.period))])]),e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.base))]),e("span",[t._v(t._s(n.mobile))])])])])]),e("li",[e("span",[t._v("轮转科室 ："+t._s(n.dept))])]),e("li",[e("span",[t._v("轮转周期 ："+t._s(t._f("date")(n.begintime))+"-"+t._s(t._f("date")(n.endtime)))])])]),e("div",{staticClass:"footerBtn"})])})),0),t.showreason?e("div",{staticClass:"for-reason"},[e("div",{staticClass:"reason-content"},[e("header",[t._v("请选择未轮转原因")]),e("section",[t._l(t.reasonlist,(function(i,n){return e("label",{on:{click:function(e){return e.preventDefault(),t.getchecked(i.key)}}},[e("input",{staticClass:"radio",attrs:{type:"checkbox"},domProps:{checked:1==i.ischecked}}),t._v(" "+t._s(i.name)+" ")])})),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reason,expression:"reason"}],attrs:{placeholder:"您可以输入具体原因"},domProps:{value:t.reason},on:{input:function(e){e.target.composing||(t.reason=e.target.value)}}})],2),e("footer",[e("a",{on:{click:t.changTurnStatus}},[t._v("确定")]),e("a",{on:{click:function(e){t.showreason=!1}}},[t._v("取消")])])])]):t._e(),e("c-timepicker",{attrs:{config:t.gettime,year:t.defaultyears,month:t.months},on:{confirm:t.selecttime}}),t.noContent?e("no-content"):t._e()],1)},s=[],o=(i(70560),i(77387)),a=i.n(o),r=i(68934),d=i(49931),u=i(84622),c=i(63822),l=(i(95250),{props:["active","shownotturn","titledeptid","deptname"],name:"rotation_admin_right",components:{noContent:u.Z,cTimepicker:d.Z},filters:{date:function(t){return t?t.split("-").join("."):void 0}},data(){return{issubmit:!1,aturndoctors:[],showDate:!1,gettime:{show:!1,isday:!1,istime:!1,custom:!0},defaultyears:[2018,2025],months:[1,12],condition:"轮转月份选择",tpdid:0,uid:"",num:"",year:2e3,month:1,Year:0,Month:0,key:0,showCurrentYear:!0,showCurrentMonth:!0,noContent:!1,enterNum:0,reasonlist:"",reason:"",showreason:!1,data:""}},watch:{active:function(t,e){t&&this.init()},showreason:function(t,e){0==t&&(this.reason="",this.reasonlist.map((t=>{t.ischecked=!1})))},titledeptid:function(t,e){t&&e!=t&&this.init()},deptname:function(t,e){t&&t!=e&&(this.deptname=t)}},mounted(){console.log(111);let t=this;t.$route.query.deptid&&2==t.$route.query.where&&(t.titledeptid=t.$route.query.deptid),t.init(),t.initreason()},methods:{...r.Z,...(0,c.nv)(["showAlert","showConfirm","showLoading","hideLoading","toast","setTurninfo","getRoleAuthority"]),init(t){let e=this;e.post("/turn/querytoturndoctors",{command:"turn/querytoturndoctors",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),deptIdList:Array.isArray(e.titledeptid)?e.titledeptid:[e.titledeptid],turnstatus:3,month:t,includeChildDeptFlag:"0"}).done((function(t){e.aturndoctors=t.turndoctors,0==e.aturndoctors.length?e.noContent=!0:e.noContent=!1})).fail((function(t){e.noContent=!0}))},initreason(){let t=this;t.post("/traineestudent/queryDictionaryList",{command:"traineestudent/queryDictionaryList",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),code:"turnnotinfo"}).done((function(e){e&&0==e.errcode&&e.dic_list.map((t=>{t.ischecked=!1})),t.reasonlist=e.dic_list}))},checkdate:function(t){if(val)return t.split("-").join(".")},plan:function(t){this.setTurninfo({k:"stuid",v:t.id}),this.$router.push({name:"fdRotation_doctor_plan",query:{where:5,type:2,deptid:this.titledeptid,deptname:this.deptname}})},checkDate:function(t){return t<10?"0"+t:t},selecttime(t){this.condition=t,this.init(t)},confirmCourse:function(t){let e=this;e.tpdid=t.tpdid,e.uid=t.id,e.num=t.num,this.showConfirm({title:"入科确认",msg:"确认该住院医生入科吗？",theme:"modal-confirm modal-white",cancel:function(){},ok:function(){e.confirm(e.tpdid,e.uid,e.num)}})},confirm:function(t,e,i){let n=this;n.issubmit=!0,n.post("/turn/updateturnstatus",{command:"turn/updateturnstatus",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),turnstatus:1,tpdid:t,uid:e,num:i}).done((t=>{t&&0==t.errcode?(n.issubmit=!1,n.showAlert({msg:"入科成功！"}),n.init()):t&&t.errdesc&&(n.issubmit=!1,n.showAlert({msg:t.errdesc}))})).fail((()=>{n.issubmit=!1,n.showAlert({msg:"入科失败！"})}))},confirmTurn(t){this.showreason=!0,this.tpdid=t.tpdid,this.uid=t.id,this.num=t.num},changTurnStatus(){let t=this,e=[];this.reasonlist.map((t=>{1==t.ischecked&&e.push(t.key)})),0!=e.length?t.post("/turn/updateturnstatus",{command:"turn/updateturnstatus",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),tpdid:t.tpdid,uid:t.uid,num:t.num,turnstatus:4,remark:t.reason,turnnotkeylist:e}).done((e=>{e&&0==e.errcode?(t.toast("修改成功."),t.showreason=!1,t.init()):e&&e.errdesc&&t.showAlert({msg:e.errdesc})})).fail((()=>{t.showAlert({msg:"修改失败！"})})):this.toast("请选择未轮转原因！")},getchecked(t){this.reasonlist.map((e=>{e.key===t&&(e.ischecked=0==e.ischecked)}))}}}),p=l,h=i(1001),m=(0,h.Z)(p,n,s,!1,null,"3a277b5b",null),f=m.exports},93121:function(t,e,i){i.d(e,{Z:function(){return f}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"g-wrapper"},[t.noContent?t._e():e("div",{staticClass:"g-main"},t._l(t.turndoctors,(function(n,s){return e("div",{staticClass:"list"},[e("ul",{on:{click:function(e){return t.plan(n.id)}}},[e("li",{staticClass:"head"},[e("div",{staticClass:"headDiv"},[e("img",{attrs:{src:i(6489),alt:""}}),e("div",[e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.name))]),e("span",[t._v(t._s(n.period))])]),e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.base))]),e("span",[t._v(t._s(n.mobile))])])])])]),e("li",[e("span",[t._v("轮转科室 ："+t._s(n.dept)+" ")])]),e("li",[e("span",[t._v("轮转周期 ："+t._s(t._f("date")(n.begintime))+"-"+t._s(t._f("date")(n.endtime)))])])]),e("div",{staticClass:"footerBtn"},[e("a",{staticStyle:{"margin-right":".2rem"},on:{click:function(e){return t.confirmTurn(n)}}},[t._v("未轮转原因")])])])})),0),t.showreason?e("div",{staticClass:"for-reason"},[e("div",{staticClass:"reason-content"},[e("header",[t._v(" 请选择未轮转原因 ")]),e("section",[t._l(t.reasonlist,(function(i,n){return e("label",{on:{click:function(e){return e.preventDefault(),t.getchecked(i.key)}}},[e("input",{staticClass:"radio",attrs:{type:"checkbox"},domProps:{checked:1==i.checkflag}}),t._v(" "+t._s(i.name)+" ")])})),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reason,expression:"reason"}],attrs:{placeholder:"您可以输入具体原因"},domProps:{value:t.reason},on:{input:function(e){e.target.composing||(t.reason=e.target.value)}}})],2),e("footer",[e("a",{on:{click:t.changTurnStatus}},[t._v("确定")]),e("a",{on:{click:function(e){t.showreason=!1}}},[t._v("取消")])])])]):t._e(),t.noContent?e("no-content"):t._e()],1)},s=[],o=(i(70560),i(77387)),a=i.n(o),r=i(68934),d=i(49931),u=i(84622),c=i(63822),l=(i(95250),{props:["active","titledeptid","deptname"],name:"rotation_admin_right",components:{noContent:u.Z,cTimepicker:d.Z},filters:{date:function(t){return t?t.split("-").join("."):void 0}},data(){return{issubmit:!1,turndoctors:[],showDate:!1,gettime:{show:!1,isday:!1,istime:!1,custom:!0},defaultyears:[2018,2025],months:[1,12],tpdid:0,uid:"",num:"",year:2e3,month:1,Year:0,Month:0,key:0,showCurrentYear:!0,showCurrentMonth:!0,noContent:!1,enterNum:0,reasonlist:"",reason:"",showreason:!1,data:""}},watch:{active:function(t,e){t&&this.init()},showreason:function(t,e){0==t&&(this.reason="",this.reasonlist.map((t=>{t.ischecked=!1})))},titledeptid:function(t,e){t&&e!=t&&this.init()},deptname:function(t,e){t&&t!=e&&(this.deptname=t)}},mounted(){this.$route.query.deptid&&4==this.$route.query.where&&(this.titledeptid=this.$route.query.deptid)},methods:{...r.Z,...(0,c.nv)(["showAlert","showConfirm","showLoading","hideLoading","toast","setTurninfo"]),init(t){let e=this;e.post("/turn/querytoturndoctors",{command:"turn/querytoturndoctors",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),deptIdList:Array.isArray(e.titledeptid)?e.titledeptid:[e.titledeptid],turnstatus:4,includeChildDeptFlag:"0"}).done((function(t){e.turndoctors=t.turndoctors,0==e.turndoctors.length?e.noContent=!0:e.noContent=!1})).fail((function(t){e.noContent=!0}))},plan:function(t){this.setTurninfo({k:"stuid",v:t}),this.$router.push({name:"fdRotation_doctor_plan",query:{where:4,type:4,deptid:this.titledeptid,deptname:this.deptname}})},initreason(t){let e=this;e.post("/trainee/getnotturninfo",{command:"trainee/getnotturninfo",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),businessid:t,type:1}).done((function(t){e.reasonlist=t.list,e.reason=t.remark,e.reasonlist&&0==e.reasonlist.length?e.noContent=!0:e.noContent=!1})).fail((function(t){e.noContent=!0}))},confirmTurn(t){this.showreason=!0,this.tpdid=t.tpdid,this.uid=t.id,this.num=t.num,this.initreason(t.tpdid)},changTurnStatus(){let t=this,e=[];this.reasonlist.map((t=>{1==t.checkflag&&e.push(t.key)})),0!=e.length?(t.reason&&null!=t.reason&&""!=t.reason||(t.reason=""),t.post("/turn/updateturnstatus",{command:"turn/updateturnstatus",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),tpdid:t.tpdid,uid:t.uid,num:t.num,turnstatus:4,remark:t.reason,turnnotkeylist:e}).done((e=>{e&&0==e.errcode?(t.toast("修改成功."),t.showreason=!1,t.init()):e&&e.errdesc&&t.showAlert({msg:e.errdesc})})).fail((()=>{t.showAlert({msg:"修改失败！"})}))):this.toast("请选择未轮转原因！")},getchecked(t){this.reasonlist.map((e=>{e.key===t&&(e.checkflag=0==e.checkflag)}))}}}),p=l,h=i(1001),m=(0,h.Z)(p,n,s,!1,null,"7288a556",null),f=m.exports},89262:function(t,e,i){i.d(e,{Z:function(){return g}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"g-wrapper"},[e("div",{staticClass:"g-main"},[e("div",{staticClass:"allotTeacher fixed",on:{click:t.allotTeacherAll}},[e("div",[e("img",{directives:[{name:"show",rawName:"v-show",value:t.assingning,expression:"assingning"}],attrs:{src:i(42170),alt:""}}),e("img",{directives:[{name:"show",rawName:"v-show",value:!t.assingning,expression:"!assingning"}],attrs:{src:i(26433),alt:""}}),e("span",[t._v("待 分 配")])]),e("span",[t._v(t._s(t.assignteachlist.length))])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.assingning,expression:"assingning"}],staticClass:"main assignMain",class:{stopscroll:t.isscroll}},t._l(t.assignteachlist,(function(n,s){return e("div",{staticClass:"list"},[e("ul",{on:{click:function(e){return t.plan(n)}}},[e("li",{staticClass:"head"},[e("div",{staticClass:"headDiv"},[e("img",{attrs:{src:i(6489),alt:""}}),e("div",[e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.name))]),e("span",[t._v(t._s(n.period))])]),e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.base))]),e("span",[t._v(t._s(n.mobile))])])])])]),e("li",[e("span",[t._v("轮转科室："+t._s(n.turndeptname))])]),e("li",[e("span",[t._v("轮转周期："+t._s(t._f("date")(n.begintime))+"-"+t._s(t._f("date")(n.endtime)))])]),n.teaching?e("li",[e("span",[t._v("轮转进度："+t._s(t._f("rating")(n.progress)))])]):t._e()]),e("div",{staticClass:"footerBtn"},[null==n.teaching&&t.roleAuthority["app:run:assignTeacher"]&&2!=n.isGraduation?e("a",{directives:[{name:"show",rawName:"v-show",value:!t.isSubmit,expression:"!isSubmit"}],on:{click:function(e){return t.allotTeacher(n.tpdid,n.turningdeptid)}}},[t._v("分配带教老师")]):t._e(),null==n.teaching&&t.roleAuthority["app:run:assignTeacher"]&&2!=n.isGraduation?e("a",{directives:[{name:"show",rawName:"v-show",value:t.isSubmit,expression:"isSubmit"}]},[t._v("分配带教老师")]):t._e()])])})),0),e("div",{staticClass:"allotTeacher allTurn",on:{click:t.showAllTurn}},[e("div",[e("img",{directives:[{name:"show",rawName:"v-show",value:t.allTurn,expression:"allTurn"}],attrs:{src:i(42170),alt:""}}),e("img",{directives:[{name:"show",rawName:"v-show",value:!t.allTurn,expression:"!allTurn"}],attrs:{src:i(26433),alt:""}}),e("span",[t._v("轮 转 中")])]),e("span",[t._v(t._s(t.turnList.length))])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.allTurn,expression:"allTurn"}],staticClass:"main allTurnMain",class:{stopscroll:t.isscroll}},t._l(t.turnList,(function(n,s){return e("div",{staticClass:"list"},[e("ul",{on:{click:function(e){return t.plan(n)}}},[e("li",{staticClass:"head"},[e("div",{staticClass:"headDiv"},[e("img",{attrs:{src:i(6489),alt:""}}),e("div",[e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.name))]),e("span",[t._v(t._s(n.period))])]),e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.base))]),e("span",[t._v(t._s(n.mobile))])])])])]),e("li",[e("span",[t._v("轮转科室："+t._s(n.dept))])]),e("li",[e("span",[t._v("带教老师："+t._s(n.teaching))])]),e("li",[e("span",[t._v("轮转周期："+t._s(t._f("date")(n.begintime))+"-"+t._s(t._f("date")(n.endtime)))]),e("span",{staticClass:"t-turncode"},[t._v("轮转进度："+t._s(t._f("rating")(n.progress)))])])]),e("div",{staticClass:"footerBtn"},[e("a",{directives:[{name:"show",rawName:"v-show",value:!t.isSubmit&&t.roleAuthority["app:run:assignTeacher"]&&2!=n.isGraduation,expression:"!isSubmit && roleAuthority['app:run:assignTeacher'] && item.isGraduation!=2"}],staticStyle:{"margin-right":"0.2rem"},on:{click:function(e){return t.allotTeacher(n.tpdid,n.turningdeptid)}}},[t._v("修改带教老师")])])])})),0),e("div",{staticClass:"allotTeacher allStudent",on:{click:t.showAllStudent}},[e("div",[e("img",{directives:[{name:"show",rawName:"v-show",value:t.allStudent,expression:"allStudent"}],attrs:{src:i(42170),alt:""}}),e("img",{directives:[{name:"show",rawName:"v-show",value:!t.allStudent,expression:"!allStudent"}],attrs:{src:i(26433),alt:""}}),e("span",[t._v("待 出 科")])]),e("span",[t._v(t._s(t.deptOutDoctors.length))])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.allStudent,expression:"allStudent"}],staticClass:"main allStuMain",class:{stopscroll:t.isscroll}},t._l(t.deptOutDoctors,(function(n,s){return e("div",{staticClass:"list"},[e("ul",{on:{click:function(e){return t.plan(n)}}},[e("li",{staticClass:"head"},[e("div",{staticClass:"headDiv"},[e("img",{attrs:{src:i(6489),alt:""}}),e("div",[e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.name))]),e("span",[t._v(t._s(n.period))])]),e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.base))]),e("span",[t._v(t._s(n.mobile))])])])])]),e("li",[e("span",[t._v("轮转科室："+t._s(n.dept))])]),e("li",[e("span",[t._v("分带教："+t._s(n.teaching))])]),e("li",[e("span",[t._v("轮转周期："+t._s(t._f("date")(n.begintime))+"-"+t._s(t._f("date")(n.endtime)))]),e("span",{staticClass:"t-turncode"},[t._v("轮转进度："+t._s(t._f("rating")(n.progress)))])]),t.ckShow?e("li",[e("span",[t._v("是否符合出科条件："+t._s(t._f("exam")(n.auditStatus)))])]):t._e()]),e("div",{staticClass:"footerBtn"},[t.ckShow&&t.roleAuthority["app:outwait:review"]&&2!=n.isGraduation?e("a",{staticStyle:{"margin-right":"0.2rem"},on:{click:function(e){return t.outDepartmentExam(n)}}},[t._v("出科条件审核")]):t._e(),t.checkExam(n.auditStatus)||!t.ckShow?e("a",{directives:[{name:"show",rawName:"v-show",value:t.roleAuthority["app:outwait:confirmOutDept"],expression:"roleAuthority['app:outwait:confirmOutDept']"}],staticStyle:{"margin-right":"0.2rem"},on:{click:function(e){return t.outDepartment(n)}}},[t._v("出科")]):t._e(),t.roleAuthority["app:outwait:outDeptTest"]&&t.checkCkShow(n.auditStatus)?e("a",{staticStyle:{"margin-right":"0.2rem"},on:{click:function(e){return t.outDepartmentScore(n)}}},[t._v("出科考核")]):t._e(),e("a",{directives:[{name:"show",rawName:"v-show",value:!t.isSubmit&&t.roleAuthority["app:outwait:assignTeacher"]&&2!=n.isGraduation,expression:"!isSubmit && roleAuthority['app:outwait:assignTeacher'] && item.isGraduation!=2"}],staticStyle:{"margin-right":"0.2rem"},on:{click:function(e){return t.allotTeacher(n.tpdid,n.turningdeptid)}}},[t._v("修改带教老师")])])])})),0)]),e("c-picker",{attrs:{config:t.selteacher},on:{confirm:t.choiceteacher}})],1)},s=[],o=(i(70560),i(91719),i(77387)),a=i.n(o),r=i(93830),d=i(68934),u=i(62266),c=i(63822),l=i(95250),p={props:["active","showck","titledeptid","deptname"],name:"rotation_admin_left",components:{cModel:r.Z,cPicker:u.Z},filters:{date:function(t){if(t)return t.split("-").join(".")},rating:function(t){if(t||0==t)return(100*t).toFixed(0)+"%"},exam:function(t){return null===t?"待审核":1===t?"是":0===t?"否":"无效状态"}},data(){return{ckShow:!1,isSubmit:!1,isscroll:!1,teachers:[],totalDoctor:[],turndoctors:[],assignteachlist:[],deptOutDoctors:[],turnList:[],periods:["全部","2014级","2015级","2016级","2017级","2018级"],tpdid:0,value:"全部",teacherid:0,slide:!1,allStufixed:!1,assingning:!1,allStudent:!1,allTurn:!1,selteacher:{show:!1,mainlist:[],valueKey:function(t){return'<span class="picker-center">'+t.tech_name+'</span><span class="picker-center">'+t.stud_num+"</span>"}}}},watch:{assingning:function(t,e){},allStudent:function(t,e){},active:function(t,e){if(t){let t=this;t.init("全部"),l.Z.$on("confirmDept",(function(){t.init("全部")})),a()(".allStuMain").css("margin-top","0rem")}},"selteacher.show":function(t){this.isscroll=!!t},titledeptid:function(t,e){t&&e!=t&&this.init()},deptname:function(t,e){t&&t!=e&&(this.deptname=t)}},computed:{...(0,c.rn)(["roleAuthority"])},mounted(){let t=this;t.judgeCk(),this.getRoleAuthority(["app:run:confirmOutDept","app:run:assignTeacher","app:outwait:review","app:outwait:confirmOutDept","app:outwait:outDeptTest","app:outwait:assignTeacher"]),this.$route.query.deptid&&1==this.$route.query.where&&(this.titledeptid=this.$route.query.deptid),this.$nextTick((function(){t.init("全部"),l.Z.$on("confirmDept",(function(){t.init("全部")})),a()(".allStudent").css({position:"fixed",top:"2.78rem","z-index":"10"}),a()(".allTurn").css({position:"inherit",top:"2.14rem","z-index":"10"}),a()(".allStuMain").css("margin-top","0.66rem")}))},methods:{...d.Z,...(0,c.nv)(["showAlert","showConfirm","showLoading","hideLoading","toast","setTurninfo","getRoleAuthority"]),checkCkShow(t){return!!self.ckShow||1==t},judgeCk(){let t=this;t.post("/commparaconf/queryCommparaConfList",{command:"commparaconf/queryCommparaConfList",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),paramcode:"ck_settings",paramvalue:"9"}).then((e=>{e&&"0"==e.errcode&&e.commparaConfList.length>0&&(t.ckShow=Number(e.commparaConfList[0].param1))}))},outDepartmentExam(t){this.$emit("savePreId"),this.$router.push({name:"fdRotation_OutExam",query:{id:t.plandetailid}})},checkExam(t){return null!==t&&1===t},outDepartmentScore(t){let e=this;this.$emit("savePreId"),this.$router.push({name:"fdRotation_out_department_score",query:{type:e.$route.query.type,where:e.$route.query.where,id:e.$route.query.id,deptid:this.titledeptid,deptname:this.deptname,uid:t.id,businessid:t.tpdid,endtime:t.endtime,plandetailid:t.plandetailid,auditStatus:t.auditStatus}})},outDepartment(t){console.log(t),this.$emit("savePreId");let e=this;this.$router.push({name:"fdRotation_out_department",query:{type:e.$route.query.type,where:1,deptid:this.titledeptid,deptname:this.deptname,uid:t.id,businessid:t.tpdid,tpdid:t.tpdid,num:t.num,name:t.name,base:t.base,time:t.begintime+"至"+t.endtime}})},allotTeacherAll(){this.assingning?this.assingning=!1:(this.assingning=!0,this.allStudent=!1,this.allTurn=!1),a()(".allStudent").css({position:"inherit",top:"2.14rem","z-index":"10"}),a()(".allTurn").css({position:"inherit",top:"2.78rem","z-index":"10"})},showAllTurn(){this.allTurn?(this.allTurn=!1,a()(".allStudent").css({position:"inherit",top:"2.78rem","z-index":"10"}),a()(".allTurn").css({position:"inherit",top:"2.14rem","z-index":"10"})):(this.assingning=!1,this.allStudent=!1,this.allTurn=!0,a()(".allTurnMain").css("margin-top","0.66rem"),a()(".allStudent").css({position:"inherit",top:"2.78rem","z-index":"10"}),a()(".allTurn").css({position:"fixed",top:"2.14rem","z-index":"10"}))},showAllStudent(){this.allStudent?(this.allStudent=!1,a()(".allStudent").css({position:"inherit",top:"2.78rem","z-index":"10"}),a()(".allTurn").css({position:"inherit",top:"2.14rem","z-index":"10"})):(this.assingning=!1,this.allStudent=!0,this.allTurn=!1,a()(".allStuMain").css("margin-top","1.32rem"),a()(".allStudent").css({position:"fixed",top:"2.80rem","z-index":"10"}),a()(".allTurn").css({position:"fixed",top:"2.14rem","z-index":"10"}))},plan:function(t){this.$emit("savePreId"),this.setTurninfo({k:"stuid",v:t.id}),this.$router.push({name:"fdRotation_doctor_plan",query:{type:2,where:1,deptid:this.titledeptid,deptname:this.deptname}})},init(t){let e=this,i={command:"turn/queryturningdoctors",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),deptIdList:Array.isArray(e.titledeptid)?e.titledeptid:[e.titledeptid],pageno:1,pagesize:100,includeChildDeptFlag:"0"};"全部"==t||(i.period=t),e.post("/turn/queryturningdoctors",i).done((function(t){t.periods&&(t.periods.unshift("全部"),e.periods=t.periods),e.turndoctors=t.turndoctors,e.assignteachlist=[],e.turndoctors&&(e.assignteachlist=e.turndoctors)})).fail((function(t){}));let n={command:"turn/queryturningdoctors",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),teachidflag:1,deptIdList:Array.isArray(e.titledeptid)?e.titledeptid:[e.titledeptid],pageno:1,pagesize:100};e.post("/turn/queryturningdoctors",n).done((function(t){t.periods&&(t.periods.unshift("全部"),e.periods=t.periods),e.turndoctors=t.turndoctors,e.turnList=[],e.deptOutDoctors=[],e.turnList=[],e.turndoctors&&(e.turndoctors.forEach((t=>{e.isCurrentMonth(t.endtime)?e.deptOutDoctors.push(t):e.turnList.push(t)})),console.log(e.turnList,e.deptOutDoctors))})).fail((function(t){}))},judgeCk(){let t=this;t.post("/commparaconf/queryCommparaConfList",{command:"commparaconf/queryCommparaConfList",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),paramcode:"ck_settings",paramvalue:"9"}).then((e=>{e&&"0"==e.errcode&&e.commparaConfList.length>0&&(t.ckShow=Number(e.commparaConfList[0].param1))}))},isCurrentMonth(t){let e=new Date(t),i=(new Date).getMonth()+1,n=(new Date).getYear(),s=e.getMonth()+1,o=e.getYear();return o<n||!(o>n)&&s<=i},allotTeacher:function(t,e){this.tpdid=t,this.getTeacher(e)},getTeacher:function(t){let e=this;e.isSubmit=!0,this.post("/turn/queryTeacherList",{command:"turn/queryTeacherList",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),dept_id:t,teachertype:1}).done((function(t){e.isSubmit=!1,t.dept_teach_list&&(e.selteacher.mainlist=t.dept_teach_list,e.selteacher.show=!0)})).fail((()=>{e.isSubmit=!1}))},choiceteacher(t){this.teacherid=t.tech_id,this.ok()},ok(){let t=this;""==t.teacher?t.toast("至少选择一个带教老师"):this.showConfirm({title:"分配带教老师",msg:"是否确认为该学员分配带教老师？",theme:"modal-confirm modal-white",cancel:function(){},ok:function(){t.selectTeacher()}})},selectTeacher(){let t=this;t.post("/turn/assignteaching",{command:"turn/assignteaching",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),teachingid:t.teacherid,tpdid:t.tpdid}).done((function(e){t.selteacher.show=!1,t.init(t.value)}))},finishTrain(t,e,i,n){let s=this;s.showConfirm({title:"出科确认",msg:"计划出科日期为"+n+"，是否确认让该学员出科。",theme:"modal-confirm modal-white",cancel:function(){},ok:function(){s.isSubmit=!0,s.post("/turn/turnoutvalidate",{command:"turn/turnoutvalidate",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),turnstatus:3,id:t}).done((function(n){s.isSubmit=!1,n&&(400507==n.errcode?s.showConfirm({title:"出科确认",msg:"当前还有未完成的评价，是否确认该学员出科？",theme:"modal-confirm modal-white",cancel:function(){},ok:function(){s.updatastatus(t,e,i)}}):0==n.errcode&&s.updatastatus(t,e,i))})).fail((function(t){s.isSubmit=!1}))}})},unique:function(t){let e=[],i={};for(var n=0;n<t.length;n++)i[t[n]]||(e.push(t[n]),i[t[n]]=1);return e.sort()},updatastatus(t,e,i){let n=this;n.isSubmit=!0,n.post("/turn/updateturnstatus",{command:"turn/updateturnstatus",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),turnstatus:3,tpdid:t,num:e,uid:i}).done((function(t){n.isSubmit=!1,t&&0==t.errcode?n.init(n.value):t.errdesc?n.toast(t.errdesc):n.toast("服务器错误，请联系管理员。")})).fail((function(t){n.toast(t),n.isSubmit=!1}))}}},h=p,m=i(1001),f=(0,m.Z)(h,n,s,!1,null,"333d4f66",null),g=f.exports},36226:function(t,e,i){i.d(e,{Z:function(){return v}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"g-wrapper"},[e("div",{staticClass:"title"},[e("span",[t._v(t._s(t.condition))]),e("img",{attrs:{src:i(18885),alt:""},on:{click:function(e){e.stopPropagation(),t.gettime.show=!0}}})]),t.noContent?t._e():e("div",{staticClass:"g-main"},t._l(t.turndoctors,(function(n,s){return e("div",{staticClass:"list"},[e("ul",{on:{click:function(e){return t.plan(n)}}},[e("li",{staticClass:"head"},[e("div",{staticClass:"headDiv"},[e("img",{attrs:{src:i(6489),alt:""}}),e("div",[e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.name))]),e("span",[t._v(t._s(n.period))])]),e("p",{staticClass:"headerName"},[e("span",[t._v(t._s(n.base))]),e("span",[t._v(t._s(n.mobile))])])])])]),e("li",[e("span",[t._v("轮转科室 ："+t._s(n.dept)+" ")])]),e("li",[e("span",[t._v("轮转周期 ："+t._s(t._f("date")(n.begintime))+"-"+t._s(t._f("date")(n.endtime)))])])]),e("div",{staticClass:"footerBtn"},[t.shownotturn?e("a",{staticStyle:{"margin-right":".2rem"},on:{click:function(e){return t.confirmTurn(n)}}},[t._v("未轮转")]):t._e(),!t.issubmit&&t.roleAuthority["app:wait:confirmInDept"]&&2!=n.isGraduation?e("a",{class:{noclick:t.issubmit},on:{click:function(e){return t.confirmCourse(n)}}},[t._v("入科确认")]):t._e(),t.issubmit&&t.roleAuthority["app:wait:confirmInDept"]&&2!=n.isGraduation?e("a",{class:{noclick:t.issubmit}},[t._v("入科确认")]):t._e()])])})),0),t.showreason?e("div",{staticClass:"for-reason"},[e("div",{staticClass:"reason-content"},[e("header",[t._v(" 请选择未轮转原因 ")]),e("section",[t._l(t.reasonlist,(function(i,n){return e("label",{on:{click:function(e){return e.preventDefault(),t.getchecked(i.key)}}},[e("input",{staticClass:"radio",attrs:{type:"checkbox"},domProps:{checked:1==i.ischecked}}),t._v(t._s(i.name))])})),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reason,expression:"reason"}],attrs:{placeholder:"您可以输入具体原因"},domProps:{value:t.reason},on:{input:function(e){e.target.composing||(t.reason=e.target.value)}}})],2),e("footer",[e("a",{on:{click:t.changTurnStatus}},[t._v("确定")]),e("a",{on:{click:function(e){t.showreason=!1}}},[t._v("取消")])])])]):t._e(),e("van-popup",{attrs:{position:"bottom"},model:{value:t.timeShow,callback:function(e){t.timeShow=e},expression:"timeShow"}},[e("div",{staticStyle:{width:"100%"}},[e("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center",margin:"10px 0"}},[e("button",{staticClass:"van-picker__cancel",attrs:{type:"button"},on:{click:function(e){t.timeShow=!1}}},[t._v("取消")]),e("div",{staticClass:"van-ellipsis van-picker__title",staticStyle:{"font-weight":"bold"}},[t._v("确认该住院医生入科吗?")]),e("button",{staticClass:"van-picker__confirm",attrs:{type:"button"},on:{click:t.timeConfirm}},[t._v("确认")])]),e("p",{staticStyle:{"text-align":"center",margin:"5px 0",color:"#898989 !important","font-size":"15px"}},[t._v("请选择实际入科时间 ")])]),e("van-datetime-picker",{attrs:{"show-toolbar":!1,type:"date",formatter:t.formatter,"min-date":t.minDate,"max-date":t.maxDate},model:{value:t.realBeginTime,callback:function(e){t.realBeginTime=e},expression:"realBeginTime"}})],1),e("c-timepicker",{attrs:{config:t.gettime,year:t.defaultyears,month:t.months},on:{confirm:t.selecttime}}),t.noContent?e("no-content"):t._e()],1)},s=[],o=(i(70560),i(77387)),a=i.n(o),r=i(68934),d=i(49931),u=i(84622),c=i(63822),l=(i(95250),i(36797)),p=i.n(l),h={props:["active","shownotturn","titledeptid","deptname"],name:"rotation_admin_right",components:{noContent:u.Z,cTimepicker:d.Z},filters:{date:function(t){return t?t.split("-").join("."):void 0}},data(){return{issubmit:!1,turndoctors:[],showDate:!1,gettime:{show:!1,isday:!1,istime:!1,custom:!0},defaultyears:[2018,2025],months:[1,12],condition:"入科日期选择",tpdid:0,uid:"",num:"",year:2e3,month:1,Year:0,Month:0,key:0,showCurrentYear:!0,showCurrentMonth:!0,noContent:!1,enterNum:0,reasonlist:"",reason:"",showreason:!1,data:"",timeShow:!1,realBeginTime:new Date,maxDate:new Date,minDate:new Date(1990,0,1),formatter(t,e){return"year"===t?e+"年":"month"===t?e+"月":"day"===t?e+"日":e}}},watch:{active:function(t,e){t&&this.init()},showreason:function(t,e){0==t&&(this.reason="",this.reasonlist.map((t=>{t.ischecked=!1})))},titledeptid:function(t,e){t&&e!=t&&this.init()},deptname:function(t,e){t&&t!=e&&(this.deptname=t)}},computed:{...(0,c.rn)(["roleAuthority"])},mounted(){this.getRoleAuthority(["app:wait:confirmInDept","app:run:assignTeacher"]),this.$route.query.deptid&&2==this.$route.query.where&&(this.titledeptid=this.$route.query.deptid),this.$nextTick((function(){let t=this;t.initreason()}))},methods:{...r.Z,...(0,c.nv)(["showAlert","showConfirm","showLoading","hideLoading","toast","setTurninfo","getRoleAuthority"]),init(t){let e=this;e.post("/turn/querytoturndoctors",{command:"turn/querytoturndoctors",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),deptIdList:Array.isArray(e.titledeptid)?e.titledeptid:[e.titledeptid],turnstatus:0,month:t,includeChildDeptFlag:"0"}).done((function(t){e.turndoctors=t.turndoctors,0==e.turndoctors.length?e.noContent=!0:e.noContent=!1})).fail((function(t){e.noContent=!0}))},initreason(){let t=this;t.post("/traineestudent/queryDictionaryList",{command:"traineestudent/queryDictionaryList",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),code:"turnnotinfo"}).done((function(e){e&&0==e.errcode&&e.dic_list.map((t=>{t.ischecked=!1})),t.reasonlist=e.dic_list}))},checkdate:function(t){if(val)return t.split("-").join(".")},plan:function(t){this.setTurninfo({k:"stuid",v:t.id}),this.$router.push({name:"fdRotation_doctor_plan",query:{where:2,type:2,deptid:this.titledeptid,deptname:this.deptname}})},checkDate:function(t){return t<10?"0"+t:t},selecttime(t){this.condition=t,this.init(t)},confirmCourse:function(t){let e=this;e.tpdid=t.tpdid,e.uid=t.id,e.num=t.num,this.timeShow=!0},timeConfirm(){console.log(this.realBeginTime,p()(this.realBeginTime).format("YYYY-MM-DD"));let t=this;t.confirm(t.tpdid,t.uid,t.num),this.timeShow=!1},confirm:function(t,e,i){let n=this;n.issubmit=!0,n.post("/turn/updateturnstatus",{command:"turn/updateturnstatus",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),turnstatus:1,tpdid:t,uid:e,num:i,realBeginTime:p()(this.realBeginTime).format("YYYY-MM-DD")}).done((t=>{t&&0==t.errcode?(n.issubmit=!1,n.showAlert({msg:"入科成功！"}),n.init()):t&&t.errdesc&&(n.issubmit=!1,n.showAlert({msg:t.errdesc}))})).fail((()=>{n.issubmit=!1,n.showAlert({msg:"入科失败！"})}))},confirmTurn(t){this.showreason=!0,this.tpdid=t.tpdid,this.uid=t.id,this.num=t.num},changTurnStatus(){let t=this,e=[];this.reasonlist.map((t=>{1==t.ischecked&&e.push(t.key)})),0!=e.length?t.post("/turn/updateturnstatus",{command:"turn/updateturnstatus",sessionid:a().cookie("sid"),loginid:a().cookie("uid"),tpdid:t.tpdid,uid:t.uid,num:t.num,turnstatus:4,remark:t.reason,turnnotkeylist:e}).done((e=>{e&&0==e.errcode?(t.toast("修改成功."),t.showreason=!1,t.init()):e&&e.errdesc&&t.showAlert({msg:e.errdesc})})).fail((()=>{t.showAlert({msg:"修改失败！"})})):this.toast("请选择未轮转原因！")},getchecked(t){this.reasonlist.map((e=>{e.key===t&&(e.ischecked=0==e.ischecked)}))}}},m=h,f=i(1001),g=(0,f.Z)(m,n,s,!1,null,"fb7371f6",null),v=g.exports}}]);
//# sourceMappingURL=5097.cbdc89f4.js.map