"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[5076],{24894:function(t,e,i){i.d(e,{Z:function(){return A}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vue-uploader"},[t.sliderVisible?e("vue-slider",{attrs:{filelist:t.filelist,fdfsurl:t.fdfsurl,index:t.index},on:{getSlider:t.getSlider}}):t._e(),e("div",{staticClass:"upload"},[e("div",{staticClass:"imglist"},[t._l(t.filelist,(function(i,s){return e("div",{staticClass:"imgitem",on:{click:function(e){return t.deletepic(i.fileurl,s)}}},[e("img",{staticClass:"photos",attrs:{src:t.fdfsurl+i.fileurl}}),e("i",{directives:[{name:"show",rawName:"v-show",value:t.isupload,expression:"isupload"}],staticClass:"del",on:{click:function(e){return e.stopPropagation(),t.deleteitems(i.fileurl)}}})])})),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isuploadflag&&t.isupload,expression:"isuploadflag&&isupload"}]},[e("div",[e("i",{staticClass:"icon",on:{click:function(e){return t.uploadimg(1)}}})])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"pic",on:{click:function(e){t.nowurl=" ",t.show=!1}}},[e("img",{attrs:{src:t.fdfsurl+t.nowurl,alt:""}})])],2)])],1)},l=[],a=(i(70560),i(68934)),o=i(63822),n=function(){var t=this,e=t._self._c;return e("div",{ref:"canvas",attrs:{id:"canvas"},on:{click:t.cancelPic}},[e("ul",{attrs:{id:"outer"}},t._l(t.filelist,(function(i,s){return e("li",[e("img",{attrs:{src:t.fdfsurl+i.fileurl,alt:""}})])})),0)])},r=[],c={name:"vue_slide",props:{filelist:{type:Array,default(){return[]}},fdfsurl:{type:String,default:"http://"},sliderVisible:{type:Boolean,default:!1},index:{default:0}},data(){return{wrap:"",radio:"",scaleW:"",idx:0,isSlide:!1}},mounted(){this.slider()},components:{},watch:{filelist(t,e){console.log(t),this.filelist=t,this.slider()}},methods:{slider(t){this.init(),this.renderDom(),this.bindDOM()},cancelPic(){this.$emit("getSlider",!1)},init(){this.radio=window.innerHeight/window.innerWidth,this.scaleW=window.innerWidth,this.idx=0,this.canvas=document.getElementById("canvas"),this.outer=document.getElementById("outer");let t=this.filelist.length,e=this.outer.getElementsByTagName("li");for(let i=0;i<t;i++)e[i].style.width=window.innerWidth+"px",e[i].style.webkitTransform="translate3d("+i*this.scaleW+"px, 0, 0)",e[i].style.transform="translate3d("+i*this.scaleW+"px, 0, 0)",e[i].style.MozTransform="translate3d("+i*this.scaleW+"px, 0, 0)"},renderDom(){this.canvas=document.getElementById("canvas"),this.outer=document.getElementById("outer"),this.outer.style.width=window.innerWidth+"px",this.moveIndex(this.index)},moveIndex(t){let e=this;this.canvas=document.getElementById("canvas"),this.outer=document.getElementById("outer"),e.idx=t;let i=this.filelist.length,s=this.outer.getElementsByTagName("li");for(let l=0;l<i;l++)s[l]&&(s[l].style.webkitTransform="translate3d("+(l-e.idx)*e.scaleW+"px, 0, 0)"),s[l]&&(s[l].style.transform="translate3d("+(l-e.idx)*e.scaleW+"px, 0, 0)")},goIndex(t){let e,i=this.outer.getElementsByTagName("li"),s=i.length;"number"==typeof t?e=t:"string"==typeof t&&(e=this.idx+1*t),e>s-1?e=s-1:e<0&&(e=0),this.idx=e,i[e].style.webkitTransition="-webkit-transform 0.2s ease-out",i[e-1]&&(i[e-1].style.webkitTransition="-webkit-transform 0.2s ease-out"),i[e+1]&&(i[e+1].style.webkitTransition="-webkit-transform 0.2s ease-out"),i[e].style.transition="-webkit-transform 0.2s ease-out",i[e-1]&&(i[e-1].style.transition="-webkit-transform 0.2s ease-out"),i[e+1]&&(i[e+1].style.transition="-webkit-transform 0.2s ease-out"),i[e].style.webkitTransform="translate3d(0,0,0)",i[e-1]&&(i[e-1].style.webkitTransform="translate3d(-"+this.scaleW+"px,0,0)"),i[e+1]&&(i[e+1].style.webkitTransform="translate3d(+"+this.scaleW+"px,0,0)"),i[e].style.transform="translate3d(0,0,0)",i[e-1]&&(i[e-1].style.transform="translate3d(-"+this.scaleW+"px,0,0)"),i[e+1]&&(i[e+1].style.transform="translate3d(+"+this.scaleW+"px,0,0)")},bindDOM(){let t=this,e=function(e){t.startTime=1*new Date,t.startX=e.touches[0].pageX,t.offsetX=0;let i=e.target;while("LI"!=i.nodeName&&"BODY"!=i.nodeName)i=i.parentNode;t.target=i},i=function(e){t.isSlide=!0,t.offsetX=e.targetTouches[0].pageX-t.startX;let i=t.outer.getElementsByTagName("li"),s=t.idx-1,l=s+3;for(s;s<l;s++)i[s]&&(i[s].style.webkitTransition="-webkit-transform 0s ease-out"),i[s]&&(i[s].style.transition="-webkit-transform 0s ease-out"),i[s]&&(i[s].style.webkitTransform="translate3d("+((s-t.idx)*t.scaleW+t.offsetX)+"px, 0, 0)"),i[s]&&(i[s].style.transform="translate3d("+((s-t.idx)*t.scaleW+t.offsetX)+"px, 0, 0)")},s=function(e){let i=t.scaleW/6,s=1*new Date;t.outer.getElementsByTagName("li");s-t.startTime>300?t.offsetX>=i?t.goIndex("-1"):t.offsetX<0&&t.offsetX<-i?t.goIndex("1"):t.goIndex("0"):t.offsetX>50?t.goIndex("-1"):t.offsetX<-50?t.goIndex("+1"):t.goIndex("0")};this.outer.addEventListener("touchstart",e),this.outer.addEventListener("touchmove",i),this.outer.addEventListener("touchend",s)}}},d=c,u=i(1001),h=(0,u.Z)(d,n,r,!1,null,"44d41fc3",null),f=h.exports,p={name:"vue-upload",props:{fdfsurl:{type:String,default:"http://"},isupload:{type:Boolean,default:!0},imgList:{type:Array,default(){return[]}},imgMax:{type:Number,default:5}},data(){return{size:0,filelist:this.imgList,show:!1,nowurl:"",isuploadflag:!0,uploadflag:1,picShow:!1,sliderVisible:!1,index:""}},components:{vueSlider:f},created(){navigator.userAgent.toLowerCase();console.log(this.fdfsurl,this.imgList)},methods:{...a.Z,...(0,o.nv)(["showAlert","showConfirm","showLoading","hideLoading","toast"]),getSlider(t){this.sliderVisible=t},handClick(){alert(1)},callback(){},uploadimg(t){this.filelist.length>this.imgMax-1?this.toast("图片不能超过"+this.imgMax+"张"):1==this.uploadflag&&(1==t?this.invokeNative("TakeAndUploadPhoto",{imgMax:this.imgMax,currentImg:this.filelist.length},this.geturl):this.invokeNative("TakeAndUploadPhoto",{imgMax:this.imgMax,currentImg:this.filelist.length},this.geturlcase))},imgLength(){this.filelist.length>this.imgMax&&(this.isuploadflag=!1)},deleteitems(t){let e=this;this.showConfirm({title:"温馨提示",msg:"您是否要删除当前上传的图片？",theme:"modal-confirm modal-white",cancel:function(){},ok:function(){e.filelist&&e.filelist.map(((i,s)=>{i.fileurl==t&&(e.filelist.splice(s,1),e.imgLength())}))}})},deletepic(t,e){this.nowurl=t,this.sliderVisible=!0,this.index=e},geturl(t){let e=this,i=JSON.parse(t);i.data instanceof Array?i.data.forEach((t=>{e.filelist.push({fileurl:t.uri})})):e.filelist.push({fileurl:i.data.uri}),console.log(e.filelist,"-----")}},mounted(){this.imgLength()},watch:{show(t,e){t?$(".__panel").css({height:"100%"}):$(".__panel").css({height:"auto"})},imgList(t,e){this.filelist=this.imgList},fdfsurl(t,e){this.fdfsurl=t}}},g=p,m=(0,u.Z)(g,s,l,!1,null,"3c9a0a4e",null),A=m.exports},55076:function(t,e,i){i.r(e),i.d(e,{default:function(){return h}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pic-upload"},[e("van-nav-bar",{attrs:{title:t.title,"left-text":"","left-arrow":""},on:{"click-left":t.back}}),e("div",{staticClass:"pic-num"},[e("div",{staticClass:"pic-num-left"},[t._v("照片")]),e("div",{staticClass:"pic-num-right"},[e("span",{staticClass:"right-left"},[t._v(t._s(t.picList.length))]),e("span",{staticClass:"right-right",style:t.rtColor},[t._v("/9")])])]),e("div",{staticClass:"pics"},[t._l(t.picList,(function(s,l){return e("div",{key:l,staticClass:"pic",on:{click:function(e){return t.viewPic(l)}}},[e("img",{staticClass:"photo",attrs:{src:t.fdfsurl+s}}),e("img",{staticClass:"del-icon",attrs:{src:i(37188)},on:{click:function(e){return t.del(l)}}})])})),e("div",{directives:[{name:"show",rawName:"v-show",value:t.picList.length<9,expression:"picList.length < 9"}],staticClass:"addPic",on:{click:t.uploadimg}},[e("div",{staticClass:"addContent"},[e("div",{staticClass:"iconBox"},[e("van-icon",{attrs:{name:"plus",color:"#7B96B1",size:"25px"}})],1)])])],2),e("van-image-preview",{attrs:{images:t.picViewList,startPosition:t.index},on:{change:t.onChange},scopedSlots:t._u([{key:"index",fn:function(){return[t._v("第"+t._s(t.index+1)+"张")]},proxy:!0}]),model:{value:t.show,callback:function(e){t.show=e},expression:"show"}}),e("div",{staticClass:"btn-box"},[e("van-col",{staticStyle:{width:"10px"}}),e("van-button",{attrs:{type:"info"},on:{click:t.picListConfirm}},[t._v("提交")]),e("van-col",{staticStyle:{width:"10px"}})],1)],1)},l=[],a=(i(70560),i(13429),i(24224),i(61121),i(37133),i(5348)),o=i(88848),n=(i(24894),i(68934)),r={name:"pic-upload",data(){return{fdfsurl:"http://192.168.3.191/",isdel:!1,picList:[],picViewList:[],index:0,title:"上传照片",show:!1,isNewPic:!1,androidAttrs:"",color:"color",color1:"#FF0000",isBegin:!0}},created(){let t=this;t.getPicByRoute()},computed:{rtColor(){let t=this;return 0==t.picList.length?{color:"#999999"}:t.picList.length>0&&t.picList.length<9?{color:"#333333"}:9==t.picList.length?{color:"#FF0000"}:void 0}},methods:{...n.Z,getPicByRoute(){let t=this;t.fdfsurl=JSON.parse(t.$route.query.dfsURL),t.$route.query.files&&(t.picList=JSON.parse(t.$route.query.files)),console.log(t.fdfsurl)},back(){let t=this;t.isNewPic?a.Z.confirm({message:"有未提交的照片，确定要退出吗?"}).then((()=>{this.$router.push({name:"grade"})})).catch((()=>{})):this.$router.push({name:"grade"})},uploadimg(){let t=this;t.isBegin=!1;let e=Number(9-t.picList.length);this.invokeNative("TakeAndUploadPhoto",{count:e,currentImg:this.picList.length,imgMax:9},this.geturl)},geturl(t){let e=this,i=JSON.parse(t);console.log("geturl",i),i.data instanceof Array?i.data.forEach((t=>{e.picList.push(t.uri)})):e.picList.push(i.data.uri)},getPicList(){let t=this,e={command:"supervisor/getFiles",supervisorId:Number(t.$route.query.supervisorUserId)};t.post("/supervisor/getFiles",e).done((function(e){console.log(e),t.picList=e.result.files,t.fdfsurl=e.result.dfsURL,console.log(t.picList,t.fdfsurl)}))},base64ToFile(t,e){console.log(t);let i=t.split(","),s=i[0].match(/:(.*?);/)[1],l=atob(i[1]),a=l.length,o=new Uint8Array(a);while(a--)o[a]=l.charCodeAt(a);return new File([o],e,{type:s})},onRead(t){console.log(t);let e=this;if(console.log(t.length),t.length)if(t.length+e.picList.length>9){let t=9-e.picList.length;(0,o.Z)("上传失败,还可以上传"+t+"张")}else t.forEach((t=>{console.log(t);let i=e.base64ToFile(t.content,"filee"),s=new FormData;s.append("file",i),$.ajax({url:"http://192.168.3.191/file/upload",type:"post",data:s,processData:!1,contentType:!1,success:function(t){e.isNewPic=!0,e.picList.push(t.data.uri)}})}));else{let i=e.base64ToFile(t.content,"filee"),s=new FormData;s.append("file",i),$.ajax({url:"http://192.168.3.191/file/upload",type:"post",data:s,processData:!1,contentType:!1,success:function(t){e.isNewPic=!0,e.picList.push(t.data.url)}})}},viewPic(t){console.log(t);let e=this;e.index=t,1!=e.isdel&&(e.picList.forEach((t=>{e.picViewList.push(e.fdfsurl+t)})),e.show=!0)},picListConfirm(){let t=this;a.Z.confirm({message:"确定要提交照片吗?"}).then((()=>{let e={command:"supervisor/uploadPhoto",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),supervisorUserId:t.$route.query.supervisorUserId,files:t.picList};console.log(e),t.post("/supervisor/uploadPhoto",e).done((function(e){console.log(e),(0,o.Z)("提交成功!"),t.isNewPic=!1,t.back()}))})).catch((()=>{}))},del(t){let e=this;e.isdel=!0,e.picList.splice(t,1),setTimeout((()=>{e.isdel=!1}),1e3)},onChange(t){console.log(t);let e=this;e.index=t}}},c=r,d=i(1001),u=(0,d.Z)(c,s,l,!1,null,null,null),h=u.exports},37188:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAJKADAAQAAAABAAAAJAAAAAAqDuP8AAADa0lEQVRYCc1Yu24aQRSd3UUUCEtJkwLJqUC2f8FOCiRchECRFPmLKEWkfESkFJb/IkVSgEkBEoVjfgEQrmzJkdIkEojCApNzVtz17nh3ZxeCxZWGed3H4d553FlLpaRms/kUIq8Xi8Ux6ucoBbQLVGNZ1g0qliu026jParXaH9SJyUrK2Wg03oD3PcpLAMgkkQOoGfjOUU7r9fr3RDImplardTSfzz8DxKGJN24e4HqO43yqVqsXsXxRkwDgIDxfUH+I4lllHMBOEMaPqOdh8qEh63a7T8bj8VcIcJ1sgto7OzvvyuXyX135A0AEM5lMevDMgc78P/vwUD+fzx/qoGy/EYaJntk0GNqkjaUtx48hAIhrBpObCpPfrrSPlzalr7yQcTfNZrOf3swjNjKZzAvZfZ6HuLXjMGSzWZXL5eJYQucoQ9k48tt2PcRDDzH9FiVEhZVKRdm2rYbDoRqNRlGsgfFSqaT29vbU3d2d6nQ66vb2NjDv72CRv+XhKR7iCRxJcKkLBkJqf39f0ZCJyENeyvCPUIeBXAwW7yZ45zdKrESxWFQHB/cnwWAwiPSUgBEA/X5fXV5eSje0BvAZyrMM3FkDRywYahCFAor/nqSHbxUw1EOHoNRsoEq8zQmK/1ZID9+qYEQfsdAzuzKQpI7yFGXFa2wnCRP5NNolIDeX0SZiu3GgKLgiGIoWbMQtNSBK6uHjGGkNMFxHBW77hatphR/E/IFU2NgDpuiBBRf1r+j56Bl9AQunvtBlPElNLPQQc+BUpINhmFiE1gB1w0V9JYqS1GFgZJFT3nROGWxccVF3DEzetAmMvtDTegoha+OasZto8HUQSyYwIhwGiteOiZYYzuzlu4lPlUhiCsFbW8i0tcNAJUhdzolFbvtTMRZWI3FzUwiEN/E5I6Aow/SDOgzkYvAOEuREFxCOfHsxJ2IKMZ1ODXqD0/QMwRhyoR5yoSNKiocUH3FBVcEeFaYFQw2UiQNDHr9tDxBzWiysEzI8JtGm5NO064WMHYTMQeh+oJk4JaHcGtRGqF4BlPeK9TxEpZzgixL1/bG7hrU4UdpY2vLAkD8AiAN8SfJFiSY/p2yK2mGvVhoLhMxvneHbmo8NfmBb8znGD4rtrflgpQPjs4kvFSxK7kTm42Gf9K4Rcl6UzbSf9P4B9Me0HNSd5g8AAAAASUVORK5CYII="}}]);
//# sourceMappingURL=5076.03411449.js.map