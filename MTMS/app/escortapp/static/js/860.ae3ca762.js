"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[860],{24894:function(t,e,i){i.d(e,{Z:function(){return w}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vue-uploader"},[t.sliderVisible?e("vue-slider",{attrs:{filelist:t.filelist,fdfsurl:t.fdfsurl,index:t.index},on:{getSlider:t.getSlider}}):t._e(),e("div",{staticClass:"upload"},[e("div",{staticClass:"imglist"},[t._l(t.filelist,(function(i,s){return e("div",{staticClass:"imgitem",on:{click:function(e){return t.deletepic(i.fileurl,s)}}},[e("img",{staticClass:"photos",attrs:{src:t.fdfsurl+i.fileurl}}),e("i",{directives:[{name:"show",rawName:"v-show",value:t.isupload,expression:"isupload"}],staticClass:"del",on:{click:function(e){return e.stopPropagation(),t.deleteitems(i.fileurl)}}})])})),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isuploadflag&&t.isupload,expression:"isuploadflag&&isupload"}]},[e("div",[e("i",{staticClass:"icon",on:{click:function(e){return t.uploadimg(1)}}})])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"pic",on:{click:function(e){t.nowurl=" ",t.show=!1}}},[e("img",{attrs:{src:t.fdfsurl+t.nowurl,alt:""}})])],2)])],1)},l=[],a=(i(70560),i(68934)),n=i(63822),o=function(){var t=this,e=t._self._c;return e("div",{ref:"canvas",attrs:{id:"canvas"},on:{click:t.cancelPic}},[e("ul",{attrs:{id:"outer"}},t._l(t.filelist,(function(i,s){return e("li",[e("img",{attrs:{src:t.fdfsurl+i.fileurl,alt:""}})])})),0)])},r=[],d={name:"vue_slide",props:{filelist:{type:Array,default(){return[]}},fdfsurl:{type:String,default:"http://"},sliderVisible:{type:Boolean,default:!1},index:{default:0}},data(){return{wrap:"",radio:"",scaleW:"",idx:0,isSlide:!1}},mounted(){this.slider()},components:{},watch:{filelist(t,e){console.log(t),this.filelist=t,this.slider()}},methods:{slider(t){this.init(),this.renderDom(),this.bindDOM()},cancelPic(){this.$emit("getSlider",!1)},init(){this.radio=window.innerHeight/window.innerWidth,this.scaleW=window.innerWidth,this.idx=0,this.canvas=document.getElementById("canvas"),this.outer=document.getElementById("outer");let t=this.filelist.length,e=this.outer.getElementsByTagName("li");for(let i=0;i<t;i++)e[i].style.width=window.innerWidth+"px",e[i].style.webkitTransform="translate3d("+i*this.scaleW+"px, 0, 0)",e[i].style.transform="translate3d("+i*this.scaleW+"px, 0, 0)",e[i].style.MozTransform="translate3d("+i*this.scaleW+"px, 0, 0)"},renderDom(){this.canvas=document.getElementById("canvas"),this.outer=document.getElementById("outer"),this.outer.style.width=window.innerWidth+"px",this.moveIndex(this.index)},moveIndex(t){let e=this;this.canvas=document.getElementById("canvas"),this.outer=document.getElementById("outer"),e.idx=t;let i=this.filelist.length,s=this.outer.getElementsByTagName("li");for(let l=0;l<i;l++)s[l]&&(s[l].style.webkitTransform="translate3d("+(l-e.idx)*e.scaleW+"px, 0, 0)"),s[l]&&(s[l].style.transform="translate3d("+(l-e.idx)*e.scaleW+"px, 0, 0)")},goIndex(t){let e,i=this.outer.getElementsByTagName("li"),s=i.length;"number"==typeof t?e=t:"string"==typeof t&&(e=this.idx+1*t),e>s-1?e=s-1:e<0&&(e=0),this.idx=e,i[e].style.webkitTransition="-webkit-transform 0.2s ease-out",i[e-1]&&(i[e-1].style.webkitTransition="-webkit-transform 0.2s ease-out"),i[e+1]&&(i[e+1].style.webkitTransition="-webkit-transform 0.2s ease-out"),i[e].style.transition="-webkit-transform 0.2s ease-out",i[e-1]&&(i[e-1].style.transition="-webkit-transform 0.2s ease-out"),i[e+1]&&(i[e+1].style.transition="-webkit-transform 0.2s ease-out"),i[e].style.webkitTransform="translate3d(0,0,0)",i[e-1]&&(i[e-1].style.webkitTransform="translate3d(-"+this.scaleW+"px,0,0)"),i[e+1]&&(i[e+1].style.webkitTransform="translate3d(+"+this.scaleW+"px,0,0)"),i[e].style.transform="translate3d(0,0,0)",i[e-1]&&(i[e-1].style.transform="translate3d(-"+this.scaleW+"px,0,0)"),i[e+1]&&(i[e+1].style.transform="translate3d(+"+this.scaleW+"px,0,0)")},bindDOM(){let t=this,e=function(e){t.startTime=1*new Date,t.startX=e.touches[0].pageX,t.offsetX=0;let i=e.target;while("LI"!=i.nodeName&&"BODY"!=i.nodeName)i=i.parentNode;t.target=i},i=function(e){t.isSlide=!0,t.offsetX=e.targetTouches[0].pageX-t.startX;let i=t.outer.getElementsByTagName("li"),s=t.idx-1,l=s+3;for(s;s<l;s++)i[s]&&(i[s].style.webkitTransition="-webkit-transform 0s ease-out"),i[s]&&(i[s].style.transition="-webkit-transform 0s ease-out"),i[s]&&(i[s].style.webkitTransform="translate3d("+((s-t.idx)*t.scaleW+t.offsetX)+"px, 0, 0)"),i[s]&&(i[s].style.transform="translate3d("+((s-t.idx)*t.scaleW+t.offsetX)+"px, 0, 0)")},s=function(e){let i=t.scaleW/6,s=1*new Date;t.outer.getElementsByTagName("li");s-t.startTime>300?t.offsetX>=i?t.goIndex("-1"):t.offsetX<0&&t.offsetX<-i?t.goIndex("1"):t.goIndex("0"):t.offsetX>50?t.goIndex("-1"):t.offsetX<-50?t.goIndex("+1"):t.goIndex("0")};this.outer.addEventListener("touchstart",e),this.outer.addEventListener("touchmove",i),this.outer.addEventListener("touchend",s)}}},u=d,c=i(1001),f=(0,c.Z)(u,o,r,!1,null,"44d41fc3",null),h=f.exports,m={name:"vue-upload",props:{fdfsurl:{type:String,default:"http://"},isupload:{type:Boolean,default:!0},imgList:{type:Array,default(){return[]}},imgMax:{type:Number,default:5}},data(){return{size:0,filelist:this.imgList,show:!1,nowurl:"",isuploadflag:!0,uploadflag:1,picShow:!1,sliderVisible:!1,index:""}},components:{vueSlider:h},created(){navigator.userAgent.toLowerCase();console.log(this.fdfsurl,this.imgList)},methods:{...a.Z,...(0,n.nv)(["showAlert","showConfirm","showLoading","hideLoading","toast"]),getSlider(t){this.sliderVisible=t},handClick(){alert(1)},callback(){},uploadimg(t){this.filelist.length>this.imgMax-1?this.toast("图片不能超过"+this.imgMax+"张"):1==this.uploadflag&&(1==t?this.invokeNative("TakeAndUploadPhoto",{imgMax:this.imgMax,currentImg:this.filelist.length},this.geturl):this.invokeNative("TakeAndUploadPhoto",{imgMax:this.imgMax,currentImg:this.filelist.length},this.geturlcase))},imgLength(){this.filelist.length>this.imgMax&&(this.isuploadflag=!1)},deleteitems(t){let e=this;this.showConfirm({title:"温馨提示",msg:"您是否要删除当前上传的图片？",theme:"modal-confirm modal-white",cancel:function(){},ok:function(){e.filelist&&e.filelist.map(((i,s)=>{i.fileurl==t&&(e.filelist.splice(s,1),e.imgLength())}))}})},deletepic(t,e){this.nowurl=t,this.sliderVisible=!0,this.index=e},geturl(t){let e=this,i=JSON.parse(t);i.data instanceof Array?i.data.forEach((t=>{e.filelist.push({fileurl:t.uri})})):e.filelist.push({fileurl:i.data.uri}),console.log(e.filelist,"-----")}},mounted(){this.imgLength()},watch:{show(t,e){t?$(".__panel").css({height:"100%"}):$(".__panel").css({height:"auto"})},imgList(t,e){this.filelist=this.imgList},fdfsurl(t,e){this.fdfsurl=t}}},p=m,g=(0,c.Z)(p,s,l,!1,null,"3c9a0a4e",null),w=g.exports},90860:function(t,e,i){i.r(e),i.d(e,{default:function(){return h}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pic-upload"},[e("van-nav-bar",{attrs:{title:t.title,"left-text":"","left-arrow":""},on:{"click-left":t.back}}),t.picList.length>0?e("div",{staticClass:"pics"},t._l(t.picList,(function(i,s){return e("div",{key:s,staticClass:"pic",on:{click:function(e){return t.viewPic(s)}}},[e("img",{staticClass:"photo",attrs:{src:t.fdfsurl+i}})])})),0):e("div",{staticClass:"nodata"},[e("img",{attrs:{src:i(55972)}}),e("div",{staticClass:"nodataText"},[t._v("暂无照片")])]),e("van-image-preview",{attrs:{images:t.picViewList,startPosition:t.index},on:{change:t.onChange},scopedSlots:t._u([{key:"index",fn:function(){return[t._v("第"+t._s(t.index+1)+"张")]},proxy:!0}]),model:{value:t.show,callback:function(e){t.show=e},expression:"show"}})],1)},l=[],a=(i(70560),i(13429),i(24224),i(61121),i(37133),i(77387)),n=i.n(a),o=i(68934),r=i(5348),d=(i(24894),{name:"pic-view",data(){return{fdfsurl:"http://192.168.3.191/",isdel:!1,picList:[],picViewList:[],index:0,title:"查看照片",show:!1}},created(){let t=this;t.getPicList()},methods:{...o.Z,back(){this.$router.push({name:"couple_back"})},getPicList(){let t=this,e={sessionid:n().cookie("sid"),loginid:n().cookie("uid"),command:"supervisor/getFiles",supervisorId:Number(t.$route.query.supervisorId)};t.post("/supervisor/getFiles",e).done((function(e){t.picList=e.result.files,t.fdfsurl=e.result.dfsURL}))},base64ToFile(t,e){let i=t.split(","),s=i[0].match(/:(.*?);/)[1],l=atob(i[1]),a=l.length,n=new Uint8Array(a);while(a--)n[a]=l.charCodeAt(a);return new File([n],e,{type:s})},onRead(t){let e=this,i=e.base64ToFile(t.content,"filee"),s=new FormData;s.append("file",i),console.log(i),n().ajax({url:"/file/upload",type:"post",data:s,processData:!1,contentType:!1,success:function(t){console.log(t.data.url)}})},viewPic(t){console.log(t);let e=this;e.index=t,1!=e.isdel&&(e.picList.forEach((t=>{e.picViewList.push(e.fdfsurl+t)})),e.show=!0,e.show=!0)},del(t){let e=this;e.isdel=!0,r.Z.confirm({message:"确定要删除该张照片吗?"}).then((()=>{console.log(t),e.isdel=!1})).catch((()=>{console.log("cancel"),e.isdel=!1}))},onChange(t){console.log(t);let e=this;e.index=t}}}),u=d,c=i(1001),f=(0,c.Z)(u,s,l,!1,null,null,null),h=f.exports},55972:function(t,e,i){t.exports=i.p+"static/img/noddata.13dc2190.png"}}]);
//# sourceMappingURL=860.ae3ca762.js.map