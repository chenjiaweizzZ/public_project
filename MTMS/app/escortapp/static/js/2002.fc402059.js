"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[2002],{92002:function(t,i,s){s.r(i),s.d(i,{default:function(){return b}});var a=function(){var t=this,i=t._self._c;return i("div",{staticClass:"g-wrapper"},[i("c-header",[i("div",{attrs:{slot:"headerLeft"},slot:"headerLeft"},[i("a",{staticClass:"header-back-btn",on:{click:function(i){return t.back()}}},[i("img",{attrs:{src:s(88579)}})])]),t._v(" 出科小结 "),i("div",{attrs:{slot:"headerRight"},slot:"headerRight"},[0!=t.role||t.disabled?t._e():i("button",{staticStyle:{"font-size":"0.3rem"},on:{click:t.submit_Stu}},[t._v("提交")]),1!=t.role||t.telDisabled?t._e():i("button",{staticStyle:{"font-size":"0.3rem"},on:{click:t.submit_Tea}},[t._v("提交")]),2!=t.role||t.directorDisabled?t._e():i("button",{staticStyle:{"font-size":"0.3rem"},on:{click:t.submit_Director}},[t._v("提交")])])]),i("div",{staticClass:"g-main",attrs:{id:"sign-box"}},[i("div",{staticClass:"stu-info-box"},[i("ul",[i("li",[i("span",[t._v("姓名:")]),i("span",[t._v(t._s(t.infoData.username))])]),i("li",[i("span",[t._v("年级:")]),i("span",[t._v(t._s(t.infoData.turngrade))])]),i("li",[i("span",[t._v("基地:")]),i("span",[t._v(t._s(t.infoData.base))])]),i("li",[i("span",[t._v("轮转周期:")]),i("span",[t._v(t._s(t.infoData.turnRealtime))])]),i("li",[i("span",[t._v("教学活动次数:")]),i("span",[t._v(t._s(t.infoData.teachingActionCount))])]),i("li",[i("span",[t._v("出勤率:")]),i("span",[t._v(t._s(t.infoData.attendanceRate))])]),i("li",[i("span",[t._v("岗位胜任力评价得分:")]),i("span",[t._v(t._s(t._f("formatData")(t.infoData.stdScore)))])]),i("li",[i("span",[t._v("出科考核:")]),i("div",{staticClass:"score-box"},t._l(t.infoData.turnscoreList,(function(s,a){return i("div",{key:a,staticClass:"score-item"},[i("span",[t._v("综合- "+t._s(s.theoryScore))]),i("span",[t._v("技能- "+t._s(s.skillScore))]),i("span",[t._v("理论- "+t._s(s.compreScore))]),i("span",[t._v("病历- "+t._s(s.bigCaseScore))])])})),0)]),i("li",[i("span",[t._v("轮转手册完成进度:")]),i("span",[t._v(t._s(t.infoData.turnManualRate))])])])]),i("div",{staticClass:"stu-summary-box"},[i("div",{staticClass:"title"},[t._v("个人小结:")]),i("van-cell-group",{staticClass:"boxs"},[i("van-field",{attrs:{disabled:t.disabled,label:"",type:"textarea",placeholder:t.message,rows:"8",maxlength:"1000",autosize:""},on:{focus:t.onFocus,blur:t.onBlurs},model:{value:t.infoData.stdAppraise,callback:function(i){t.$set(t.infoData,"stdAppraise","string"===typeof i?i.trim():i)},expression:"infoData.stdAppraise"}})],1),t.infoData.phase>=0?i("div",{staticClass:"sign-box"},[i("span",[t._v(t._s(t.infoData.stdname))]),i("span",[t._v(t._s(t.infoData.stdDate))])]):t._e()],1),t.infoData.phase>0||1==t.role?i("div",{staticClass:"tea-summary-box"},[i("div",{staticClass:"title"},[t._v("带教评语:")]),i("van-cell-group",{staticClass:"boxs"},[i("van-field",{attrs:{disabled:t.telDisabled,label:"",type:"textarea",placeholder:"请输入带教评语",rows:"8",maxlength:"1000",autosize:""},on:{focus:t.onFocus,blur:t.onBlurs},model:{value:t.infoData.tecAppraise,callback:function(i){t.$set(t.infoData,"tecAppraise",i)},expression:"infoData.tecAppraise"}})],1),t.infoData.phase>0?i("div",{staticClass:"sign-box"},[i("span",[t._v(t._s(t.infoData.tecname))]),i("span",[t._v(t._s(t.infoData.tecDate))])]):t._e()],1):t._e(),t.infoData.phase>1||2==t.role?i("div",{staticClass:"director-summary-box"},[i("div",{staticClass:"top-box"},[i("div",[t._v("出科鉴定意见：")]),i("div",{staticClass:"radio-box"},[0==t.infoData.isSubmit?[i("van-radio-group",{model:{value:t.radio,callback:function(i){t.radio=i},expression:"radio"}},[1==t.radio?i("van-radio",{attrs:{name:"1","checked-color":"#3499db"}},[t._v("同意出科")]):t._e(),0==t.radio?i("van-radio",{attrs:{name:"0","checked-color":"#3499db"}},[t._v("不同意出科")]):t._e()],1)]:[i("van-radio-group",{attrs:{disabled:t.directorDisabled},model:{value:t.radio,callback:function(i){t.radio=i},expression:"radio"}},[i("van-radio",{attrs:{name:"1","checked-color":"#3499db"}},[t._v("同意出科")]),i("van-radio",{attrs:{name:"0","checked-color":"#3499db"}},[t._v("不同意出科")])],1)]],2)]),i("van-cell-group",{staticClass:"boxs"},[i("van-field",{attrs:{disabled:t.directorDisabled,label:"",type:"textarea",placeholder:"请输入出科评语",rows:"8",maxlength:"1000",autosize:""},on:{focus:t.onFocus,blur:t.onBlurs},model:{value:t.infoData.directorAppraise,callback:function(i){t.$set(t.infoData,"directorAppraise",i)},expression:"infoData.directorAppraise"}})],1),t.infoData.phase>1?i("div",{staticClass:"sign-box"},[i("span",[t._v(t._s(t.infoData.directorname))]),i("span",[t._v(t._s(t.infoData.directorDate))])]):t._e()],1):t._e()]),i("transition",{attrs:{"enter-active-class":"animated slideInRight","leave-active-class":"animated fadeOut"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.signBoxShow,expression:"signBoxShow"}],staticClass:"g-wrapper signature-box"},[i("c-header",[i("div",{attrs:{slot:"headerLeft"},slot:"headerLeft"},[i("a",{staticClass:"header-back-btn",on:{click:function(i){t.signBoxShow=!1}}},[i("img",{attrs:{src:s(88579)}})])]),t._v(" 签名 "),i("div",{attrs:{slot:"headerRight"},slot:"headerRight"},[i("button",{staticClass:"header-button",staticStyle:{"font-size":"0.3rem"},on:{click:t.submit_sign}},[t._v("提交")])])]),i("div",{staticClass:"g-main"},[i("div",{staticClass:"signature-c"},[i("p",{staticClass:"sign-p",on:{click:t.signatureFn}},[t._v("此处签名")]),i("div",{ref:"canvas",attrs:{id:"canvas"}})]),i("div",{staticClass:"signature-btn"},[i("button",{ref:"clearCanvas",staticStyle:{"margin-left":"0.2rem"},attrs:{id:"clearCanvas"}},[t._v("清除签名")])])])],1)])],1)},e=[],n=(s(70560),s(77387)),o=s.n(n),r=s(68934),l=s(63822),d=s(22760),c={data(){return{isSign:!1,signSrc:"",radio:"",signBoxShow:!1,plandetailid:"",turnid:"",role:"",infoData:"",disabled:!1,telDisabled:!1,directorDisabled:!1,message:"个人小结：（结合培训细则对医德医风、组织纪律、服务态度及质量，理论学习、管理病床数，学习的病种、所参加的手术、技术操作、查房时的表现等方面进行小结）"}},components:{cHeader:d.Z},filters:{compreScore(t){return t?"综合-"+parseInt(t):"综合-"},skillScore(t){return t?"技能-"+parseInt(t):"技能-"},theoryScore(t){return t?"理论-"+parseInt(t):"理论-"},caseScore(t){return t?"病历-"+parseInt(t):"病历-"},formatData(t){return t?parseFloat(t).toFixed(2):t}},computed:{...(0,l.rn)(["turninfo","turnManual"])},methods:{...r.Z,...(0,l.nv)(["showConfirm"]),onFocus(){o()(".g-main").css("padding-bottom","6rem")},onBlurs(){o()(".g-main").css("padding-bottom","0")},submit_Stu(){this.infoData.stdAppraise?this.submitComment(this.infoData.id,"",0,this.plandetailid,this.infoData.stdAppraise,"","",""):this.$toast("个人小结不能为空!")},submit_Tea(){this.showConfirm({title:"温馨提示",msg:"是否确认提交?",theme:"modal-confirm modal-white",cancelLabel:"直接提交",okLabel:"取消",cancel:()=>{this.submitComment(this.infoData.id,"",1,this.plandetailid,this.infoData.tecAppraise,"",this.infoData.tecsignature,"")},ok:()=>{}})},submit_Director(){this.showConfirm({title:"温馨提示",msg:"是否确认提交?",theme:"modal-confirm modal-white",cancelLabel:"直接提交",okLabel:"取消",cancel:()=>{this.submitComment(this.infoData.id,o().cookie("uid"),2,this.plandetailid,this.infoData.directorAppraise,this.radio,"",this.infoData.directorsignature)},ok:()=>{}})},submit_sign(){this.isSign&&1==this.role?this.submitComment(this.infoData.id,"",1,this.plandetailid,this.infoData.tecAppraise,"",this.signSrc,""):this.isSign&&2==this.role?this.submitComment(this.infoData.id,o().cookie("uid"),2,this.plandetailid,this.infoData.directorAppraise,this.radio,"",this.signSrc):this.$toast("请签名后提交")},submitComment(t,i,s,a,e,n,r,l){let d={id:t,uid:i,roleId:s,detailId:a,evaluationInfo:e,status:n,tecsignature:r,directorsignature:l};return t||delete d.id,new Promise(((t,i)=>{this.post("/turnAppraise/addTurnAppraise",{command:"turnAppraise/addTurnAppraise",sessionid:o().cookie("sid"),loginid:o().cookie("uid"),...d}).done((i=>{i&&0==i.errcode?(this.signBoxShow=!1,this.$toast("提交成功!"),t(i),setTimeout((()=>{this.$router.go(-1)}),500)):this.$toast(i.errdesc)})).fail((t=>{i(t)}))}))},toCanvas(){1==this.role||2==this.role&&this.radio?(this.signBoxShow=!0,this.$nextTick((()=>{this.lineCanvas({el:this.$refs.canvas,clearEl:this.$refs.clearCanvas,saveEl:this.$refs.saveCanvas})}))):this.$toast("请选择是否同意该学生出科")},lineCanvas(t){for(var i in this.linewidth=1,this.color="#000000",this.background="#ffffff",t)this[i]=t[i];this.canvas||(this.canvas=document.createElement("canvas"),this.el.appendChild(this.canvas),this.cxt=this.canvas.getContext("2d"),this.canvas.width=this.el.clientWidth,this.canvas.height=this.el.clientHeight-10,this.cxt.fillStyle=this.background,this.cxt.fillRect(0,0,this.canvas.width,this.canvas.width),this.cxt.strokeStyle=this.color,this.cxt.lineWidth=this.linewidth,this.cxt.lineCap="round"),this.canvas.addEventListener("touchstart",function(t){o()(".sign-p").css("display","none"),this.cxt.beginPath(),this.cxt.moveTo(t.changedTouches[0].pageX,t.changedTouches[0].pageY-o()(".signature-c").offset().top)}.bind(this),!1),this.canvas.addEventListener("touchmove",function(t){this.cxt.lineTo(t.changedTouches[0].pageX,t.changedTouches[0].pageY-o()(".signature-c").offset().top),this.isSign=!0,this.cxt.stroke()}.bind(this),!1),this.canvas.addEventListener("touchend",function(){this.cxt.closePath();let t=this.canvas.toDataURL();this.signSrc=t,console.log(this.signSrc),this.isSign=!0}.bind(this),!1),this.clearEl.addEventListener("click",function(){this.cxt.clearRect(0,0,this.canvas.width,this.canvas.height),this.isSign=!1}.bind(this),!1)},signatureFn(){o()(".sign-p").html("")},getPersonalInfo(t){this.post("/turnAppraise/queryTurnAppraise",{command:"turnAppraise/queryTurnAppraise",sessionid:o().cookie("sid"),loginid:o().cookie("uid"),turnId:t,roleId:this.role,detailId:this.plandetailid}).done((t=>{t&&0==t.errcode&&(this.infoData=t.result,this.radio=t.result.status,t.result.directorDate?(this.disabled=!0,this.telDisabled=!0,this.directorDisabled=!0):t.result.tecDate?1==this.role?(this.disabled=!0,this.telDisabled=!1,this.directorDisabled=!1):2==this.role?(this.disabled=!0,this.telDisabled=!0,this.directorDisabled=!1):(this.disabled=!0,this.telDisabled=!0,this.directorDisabled=!0):t.result.stdDate&&(0==this.role?(this.disabled=!1,this.telDisabled=!0,this.directorDisabled=!0):1==this.role?(this.disabled=!0,this.telDisabled=!1,this.directorDisabled=!0):(this.disabled=!0,this.telDisabled=!0,this.directorDisabled=!0)),console.log(t.result),console.log(this.disabled,this.telDisabled,this.directorDisabled))})).fail((t=>{}))},initData(){return new Promise(((t,i)=>{this.post("/turn/getturndetailbyid",{command:"turn/getturndetailbyid",sessionid:o().cookie("sid"),loginid:o().cookie("uid"),plandetailid:this.plandetailid}).done((i=>{t(i.detailinfo.turnId)})).fail((t=>{i(t)}))}))},back(){0==this.role?this.$router.push({name:"fdRotation_doctor_exam",query:{type:this.turninfo.type,id:this.turninfo.plandetailid}}):1==this.role&&1==this.$route.query.type?this.$router.push({name:"fdRotation_teacher"}):1==this.role&&2==this.$route.query.type?this.$router.push({name:"fdRotation_teacher_history"}):1!=this.role||this.$route.query.type?2==this.role&&this.$router.push({name:"directorAppraisal"}):window.location.href="/pages/futuredoctorapp/index.html/#/wxIndex"}},mounted(){this.role=this.$route.query.role,this.plandetailid=this.$route.query.plandetailid,this.initData().then((t=>{this.getPersonalInfo(t)}));let t=this;this.registerToNative("goBack",(function(i){t.back()}))}},h=c,u=s(1001),p=(0,u.Z)(h,a,e,!1,null,"0b6a08bc",null),b=p.exports},22760:function(t,i,s){s.d(i,{Z:function(){return h}});var a=function(){var t=this,i=t._self._c;return i("div",{staticClass:"header",attrs:{id:"header"}},[t._t("headerLeft",(function(){return[i("a",{staticClass:"header-back-btn",on:{click:function(i){return t.back()}}},[i("img",{attrs:{src:s(88579)}})])]})),i("div",{staticClass:"header-center-blank"}),i("div",{staticClass:"header-center"},[t._t("default",(function(){return[t._v(t._s(t.title))]}))],2),t._t("headerRight")],2)},e=[],n=(s(77387),s(68934)),o=s(63822),r={props:["title"],data(){return{}},created(){},mounted(){},computed:(0,o.rn)(["loginUser"]),methods:{...(0,o.nv)(["showAlert","showLoading","hideLoading","toast"]),...n.Z,back(){this.$router.go(-1)}}},l=r,d=s(1001),c=(0,d.Z)(l,a,e,!1,null,null,null),h=c.exports},88579:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAiCAYAAABfqvm9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyNzcxQUNDRDA2RTQxMUU3OUMwRERCODQ1NkU4NTc5NSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyNzcxQUNDRTA2RTQxMUU3OUMwRERCODQ1NkU4NTc5NSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjI3NzFBQ0NCMDZFNDExRTc5QzBEREI4NDU2RTg1Nzk1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjI3NzFBQ0NDMDZFNDExRTc5QzBEREI4NDU2RTg1Nzk1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+XL81twAAAT5JREFUeNpi+P//PwOFmBGIK4D4AhCHUGoYMxDP+Y8AlygxjBOIN/5HBXnkGiYIxIeRDPoDxGkgOXIMkwbiy0iGfQfiQJg8qYZpAfEjJMPeA7E9shpSDLME4rdIhj0DYj10dcQa5gPEX5EMuw7E8tjUEmNYAhD/RjLsBBAL41JPyLByIP6HZNg2IObGpweXBBMQ96OlsUVAzErIR9gE2YB4BZphPdAsxkCqgbxAvAfJIJB3i0lJWsgccSA+g2TYTyCOJjXhwxhKQHwbybDPQOxGTrYEEQZA/BzJsFdAbEpuoQEi7iEZdh+I1Sgp0pgYGMCYeoAWXqZ6pOBLNlGUGIgrYRdQYiCurNdJbtajSeFAk+KLZgUsTaoAXJXUEyDWocRAbNXoOyC2ocRAqlf0NGmK0KSxRJPmHNYGJ0CAAQCI5DhjJbDsxgAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=2002.fc402059.js.map