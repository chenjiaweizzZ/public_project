"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[4820,4537],{8055:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"extranceExamCreate"},[t("div",{staticClass:"extranceNavbar"},[t("van-nav-bar",{attrs:{title:e.Navtitle,"left-arrow":"","right-text":"提交"},on:{"click-left":function(t){return e.back()},"click-right":function(t){return e.examSubmit()}}})],1),t("div",{staticClass:"createContent"},[t("van-form",[t("van-field",{attrs:{name:"checkboxGroup",label:"考核级别",disabled:e.examing},scopedSlots:e._u([{key:"input",fn:function(){return[t("van-radio-group",{attrs:{direction:"horizontal"},model:{value:e.surelevel,callback:function(t){e.surelevel=t},expression:"surelevel"}},e._l(e.levelList,(function(s,i){return t("van-radio",{key:i,attrs:{name:s.levelcode,disabled:e.examing}},[e._v(e._s(s.levelname))])})),1)]},proxy:!0}])}),t("transition",{attrs:{name:"plus-icon"}},[t("van-field",{directives:[{name:"show",rawName:"v-show",value:e.surelevel,expression:"surelevel"}],attrs:{disabled:e.examing,clickable:"",readonly:"","right-icon":"arrow",name:"picker",label:"base"==e.surelevel?"基地":"office"==e.surelevel?"科室":"选择基地/科室",placeholder:""},on:{click:function(t){return e.selLevel()}},model:{value:e.selectlevels.name,callback:function(t){e.$set(e.selectlevels,"name",t)},expression:"selectlevels.name"}})],1),t("div",{staticStyle:{height:"8px"}}),t("van-field",{attrs:{disabled:e.examing,readonly:"",clickable:"","right-icon":"arrow",name:"picker",label:"考核类型",placeholder:""},on:{click:function(t){return e.seltypeFn()}},model:{value:e.typename.name,callback:function(t){e.$set(e.typename,"name",t)},expression:"typename.name"}}),t("transition",{attrs:{name:"plus-icon"}},[t("van-field",{directives:[{name:"show",rawName:"v-show",value:e.typename.name,expression:"typename.name"}],attrs:{disabled:e.examing,readonly:"",clickable:"","right-icon":"arrow",name:"picker",label:"考核项目",placeholder:""},on:{click:function(t){return e.initexamitems()}},model:{value:e.selectexamitemsnames,callback:function(t){e.selectexamitemsnames=t},expression:"selectexamitemsnames"}})],1),t("div",{staticStyle:{height:"8px"}}),t("van-field",{attrs:{disabled:e.examing,readonly:"",clickable:"","right-icon":"arrow",name:"picker",label:"考核开始时间",placeholder:""},on:{click:e.showstarttime},model:{value:e.starttime,callback:function(t){e.starttime=t},expression:"starttime"}}),t("van-field",{attrs:{readonly:"",clickable:"","right-icon":"arrow",name:"picker",label:"考核结束时间",placeholder:""},on:{click:function(t){e.getendtime.show=!0}},model:{value:e.endtime,callback:function(t){e.endtime=t},expression:"endtime"}}),t("div",{staticStyle:{height:"8px"}}),t("van-field",{attrs:{autosize:"",label:"考核地点",type:"textarea",maxlength:"50",rows:"1",placeholder:"","show-word-limit":""},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}}),t("div",{staticStyle:{height:"8px"}}),t("van-field",{attrs:{disabled:e.examing,readonly:"",clickable:"","right-icon":"arrow",name:"picker",label:"考官",placeholder:""},on:{click:function(t){return e.initteacher()}},model:{value:e.teachernames,callback:function(t){e.teachernames=t},expression:"teachernames"}}),t("van-field",{attrs:{readonly:"",clickable:"","right-icon":"arrow",name:"picker",label:"考核学员",placeholder:""},on:{click:function(t){return e.initstudent()}},model:{value:e.studentnames,callback:function(t){e.studentnames=t},expression:"studentnames"}}),t("div",{staticStyle:{height:"8px"}}),t("van-field",{attrs:{autosize:"",label:"备注",type:"textarea",maxlength:"100",placeholder:"","show-word-limit":""},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}})],1)],1),t("van-action-sheet",{attrs:{actions:e.seltype.mainlist,"cancel-text":"取消","close-on-click-action":""},on:{select:e.selecttype,cancel:function(t){e.seltype.show=!1}},model:{value:e.seltype.show,callback:function(t){e.$set(e.seltype,"show",t)},expression:"seltype.show"}}),t("transition",{attrs:{"enter-active-class":"animated slideInRight","leave-active-class":"animated fadeOut"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.choicetype,expression:"choicetype"}],staticClass:"department g-wrapper"},[t("div",{staticClass:"transContent"},[t("van-nav-bar",{attrs:{title:"选择考核项","left-arrow":""},on:{"click-left":function(t){e.choicetype=!1}}}),t("div",{staticClass:"transContentSearch"},[t("van-search",{attrs:{placeholder:"请输入搜索关键词"},on:{keyup:function(t){return e.searchtypeitems()}},model:{value:e.searchitemsname,callback:function(t){e.searchitemsname=t},expression:"searchitemsname"}})],1),t("div",{staticClass:"transContentTab"},[t("van-tabs",{ref:"tabs",on:{click:e.examitemsSwitch},model:{value:e.index,callback:function(t){e.index=t},expression:"index"}},[t("van-tab",{attrs:{title:"我的考核项"}},[t("div",{staticClass:"myList"},e._l(e.mytypeitemslist,(function(s,i){return t("van-row",{key:i,staticClass:"myListItem"},[t("van-col",{attrs:{span:"1"}}),t("van-col",{staticClass:"myListItemLeft",attrs:{span:"19"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.myitemsselect,expression:"myitemsselect"}],staticClass:"checkbox",attrs:{type:"checkbox",disabled:0==s.status},domProps:{value:{examitemid:s.examitemid,examitemname:s.examitemname},checked:Array.isArray(e.myitemsselect)?e._i(e.myitemsselect,{examitemid:s.examitemid,examitemname:s.examitemname})>-1:e.myitemsselect},on:{change:function(t){var i=e.myitemsselect,a=t.target,n=!!a.checked;if(Array.isArray(i)){var l={examitemid:s.examitemid,examitemname:s.examitemname},c=e._i(i,l);a.checked?c<0&&(e.myitemsselect=i.concat([l])):c>-1&&(e.myitemsselect=i.slice(0,c).concat(i.slice(c+1)))}else e.myitemsselect=n}}}),t("span",{class:{myListItemName:!0,myListItemNameDisabled:!s.status}},[e._v(e._s(s.examitemname))])]),t("van-col",{attrs:{span:"2"}},[s.status?t("van-icon",{attrs:{name:"eye"},on:{click:function(t){return e.scoresheetPreview(s.examitemid,s.examitemname)}}}):e._e()],1),t("van-col",{attrs:{span:"2"}},[t("van-icon",{attrs:{name:"star",color:s.active?"#3499db":""},on:{click:function(t){return e.scFn(s)}}})],1)],1)})),1)]),t("van-tab",{attrs:{title:"全部考核项"}},[t("div",{staticClass:"myList"},e._l(e.alltypeitemslist,(function(s,i){return t("van-row",{key:i,staticClass:"myListItem"},[t("van-col",{attrs:{span:"1"}}),t("van-col",{staticClass:"myListItemLeft",attrs:{span:"19"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.myitemsselect,expression:"myitemsselect"}],key:s.examitemid,staticClass:"checkbox",attrs:{type:"checkbox",disabled:0==s.status},domProps:{value:{examitemid:s.examitemid,examitemname:s.examitemname},checked:Array.isArray(e.myitemsselect)?e._i(e.myitemsselect,{examitemid:s.examitemid,examitemname:s.examitemname})>-1:e.myitemsselect},on:{change:function(t){var i=e.myitemsselect,a=t.target,n=!!a.checked;if(Array.isArray(i)){var l={examitemid:s.examitemid,examitemname:s.examitemname},c=e._i(i,l);a.checked?c<0&&(e.myitemsselect=i.concat([l])):c>-1&&(e.myitemsselect=i.slice(0,c).concat(i.slice(c+1)))}else e.myitemsselect=n}}}),t("span",{class:{myListItemName:!0,myListItemNameDisabled:!s.status}},[e._v(e._s(s.examitemname))])]),t("van-col",{attrs:{span:"2"}},[s.status?t("van-icon",{attrs:{name:"eye"},on:{click:function(t){return e.scoresheetPreview(s.examitemid,s.examitemname)}}}):e._e()],1),t("van-col",{attrs:{span:"2"}},[s.status?t("van-icon",{attrs:{name:"star",color:s.active?"#3499db":""},on:{click:function(t){return e.scFn(s)}}}):e._e()],1)],1)})),1)])],1)],1),t("div",{staticClass:"countBottom"},[t("transition",{attrs:{name:"plus-icon"}},[e.selectExamitem.show?t("div",{staticClass:"countBottomList"},[t("div",{staticClass:"countBottomListTop"},[e._v("已选考核项目")]),t("div",{staticClass:"countBottomListContent"},e._l(e.myitemsselect,(function(s,i){return t("div",{key:i,staticClass:"countBottomListItem"},[t("span",[e._v(e._s(s.examitemname))]),t("van-icon",{attrs:{name:"delete-o"},on:{click:function(t){return e.deletedoctor("examitem",i)}}})],1)})),0)]):e._e()]),t("div",{staticClass:"countBottomFoot"},[t("span",{staticClass:"countInput"}),t("span",{staticClass:"countNumber"},[t("span",[t("span",{staticClass:"countNq"},[e._v("已选考核项")]),t("span",{class:{countNw:!0,countNe:e.selectexamitems.length>0}},[e._v(e._s(e.myitemsselect.length))]),t("span",{staticClass:"countNq"},[e._v("个")])]),t("span",{staticClass:"countNr",on:{click:function(t){e.selectExamitem.show=!e.selectExamitem.show}}},[e._v(" 查看列表 "),e.selectExamitem.show?t("van-icon",{attrs:{name:"arrow-up",color:"#999999"}}):t("van-icon",{attrs:{name:"arrow-down",color:"#999999"}})],1)]),t("span",{staticStyle:{width:"10px"}})])],1),t("van-overlay",{attrs:{show:e.selectExamitem.show},on:{click:function(t){e.selectExamitem.show=!1}}})],1)])]),t("transition",{attrs:{"enter-active-class":"animated slideInRight","leave-active-class":"animated fadeOut"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.choiceteacher,expression:"choiceteacher"}],staticClass:"department g-wrapper"},[t("div",{staticClass:"transContent"},[t("van-nav-bar",{attrs:{title:"选择考官","left-arrow":""},on:{"click-left":function(t){e.choiceteacher=!1}}}),t("div",{staticClass:"transContentSearch"},[t("van-search",{attrs:{placeholder:"请输入考官姓名"},on:{keyup:function(t){return e.searchteacher()}},model:{value:e.searchname,callback:function(t){e.searchname=t},expression:"searchname"}})],1),t("div",{staticClass:"transContentTeacherList"},[t("div",{staticClass:"flex-item class-sel-list",staticStyle:{"padding-bottom":"0.6rem"}},[t("div",{staticClass:"list info-list list-inner"},e._l(e.teacherlist,(function(s,i){return t("div",{key:i,staticClass:"item"},[t("label",{staticClass:"flex flex-start flex-row"},[t("div",{staticClass:"fitem"},[e._v(e._s(s.name)+"-"+e._s(s.username))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.teacher,expression:"teacher"}],staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(e.teacher)?e._i(e.teacher,s)>-1:e.teacher},on:{change:function(t){var i=e.teacher,a=t.target,n=!!a.checked;if(Array.isArray(i)){var l=s,c=e._i(i,l);a.checked?c<0&&(e.teacher=i.concat([l])):c>-1&&(e.teacher=i.slice(0,c).concat(i.slice(c+1)))}else e.teacher=n}}})])])})),0)])]),t("div",{staticClass:"countBottom"},[t("transition",{attrs:{name:"plus-icon"}},[e.selectTeacher.show?t("div",{staticClass:"countBottomList"},[t("div",{staticClass:"countBottomListTop"},[e._v("已选考官")]),t("div",{staticClass:"countBottomListContent"},e._l(e.teacher,(function(s,i){return t("div",{key:i,staticClass:"countBottomListItem"},[t("span",[e._v(" "+e._s(s.name)+" "),s.username?t("span",[e._v("-"+e._s(s.username))]):e._e()]),t("van-icon",{attrs:{name:"delete-o"},on:{click:function(t){return e.deletedoctor("examiner",i)}}})],1)})),0)]):e._e()]),t("div",{staticClass:"countBottomFoot"},[t("span",{staticClass:"countInput"}),t("span",{staticClass:"countNumber"},[t("span",[t("span",{staticClass:"countNq"},[e._v("已选考官")]),t("span",{class:{countNw:!0,countNe:e.teacher.length>0}},[e._v(e._s(e.teacher.length))]),t("span",{staticClass:"countNq"},[e._v("位")])]),t("span",{staticClass:"countNr",on:{click:function(t){e.selectTeacher.show=!e.selectTeacher.show}}},[e._v(" 查看列表 "),e.selectTeacher.show?t("van-icon",{attrs:{name:"arrow-up",color:"#999999"}}):t("van-icon",{attrs:{name:"arrow-down",color:"#999999"}})],1)]),t("span",{staticStyle:{width:"10px"}})])],1),t("van-overlay",{attrs:{show:e.selectTeacher.show},on:{click:function(t){e.selectTeacher.show=!1}}})],1)])]),t("transition",{attrs:{"enter-active-class":"animated slideInRight","leave-active-class":"animated fadeOut"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.choicestudent,expression:"choicestudent"}],staticClass:"department g-wrapper"},[t("div",{staticClass:"transContent"},[t("van-nav-bar",{attrs:{title:"选择考核学员","left-arrow":""},on:{"click-left":function(t){e.choicestudent=!1,e.selectStudent.deptchecked=[],e.selectStudent.show=!1,e.selectStudent.turndeptshow=!1}}}),t("div",{staticClass:"transContentSearch"},["office"==e.surelevel?t("div",{staticClass:"timeAndDept"},[t("span",{staticClass:"timeAndDeptLeft"},[t("span",{on:{click:function(t){return e.startTimeShow()}}},[e._v(e._s(e.searchStudentstarttimeShow?e.searchStudentstarttimeShow:"轮转开始时间"))]),t("span",[e._v("至")]),t("span",{on:{click:function(t){return e.endTimeShow()}}},[e._v(e._s(e.searchStudentendtimeShow?e.searchStudentendtimeShow:"轮转结束时间"))])]),t("span",{staticClass:"timeAndDeptMiddle"}),t("span",{staticClass:"ttime",on:{click:function(t){return e.getDefaultTime()}}},[e._v("默认时间")])]):e._e(),"office"==e.surelevel?t("div",{staticClass:"searchAndDept"},[t("div",{staticClass:"timeAndDeptLeft"},[t("van-search",{attrs:{placeholder:"请输入学员姓名"},on:{keyup:function(t){return e.initstudentlist(e.selectlevels.id)}},model:{value:e.searchStudent,callback:function(t){e.searchStudent=t},expression:"searchStudent"}})],1),t("span",{staticClass:"timeAndDeptMiddle"},[e._v("|")]),t("span",{staticClass:"timeAndDeptRight",on:{click:function(t){e.selectStudent.turndeptshow=!0,e.selectStudent.show=!1}}},[t("span",[e._v(e._s(e.searchStudentturndept?e.searchStudentturndept:"轮转科室"))]),t("van-icon",{class:{active:e.show2},attrs:{name:"play"}})],1)]):e._e(),"base"==e.surelevel?t("div",{staticClass:"searchAndDept2"},[t("van-search",{attrs:{placeholder:"请输入学员姓名"},on:{keyup:function(t){return e.initstudentlist(e.selectlevels.id)}},model:{value:e.searchStudent,callback:function(t){e.searchStudent=t},expression:"searchStudent"}})],1):e._e()]),t("div",{staticClass:"transContentTeacherList",class:{active:"office"==e.surelevel}},e._l(e.studentlist,(function(s,i){return t("div",{key:i,staticClass:"transContentStudentItem"},[t("div",{staticClass:"studentName"},[t("span",{staticClass:"studentCheck"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.student,expression:"student"}],staticClass:"checkbox2",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(e.student)?e._i(e.student,s)>-1:e.student},on:{change:function(t){var i=e.student,a=t.target,n=!!a.checked;if(Array.isArray(i)){var l=s,c=e._i(i,l);a.checked?c<0&&(e.student=i.concat([l])):c>-1&&(e.student=i.slice(0,c).concat(i.slice(c+1)))}else e.student=n}}})]),t("span",[e._v(e._s(s.name)+"-"+e._s(s.username))])]),"office"==e.surelevel?t("div",{staticClass:"studentDept"},[e._v("轮转科室:"+e._s(s.deptName))]):e._e(),"office"==e.surelevel?t("div",{staticClass:"studentTurn"},[e._v("计划轮转周期: "+e._s(s.planBeginTime)+"至"+e._s(s.planEndTime))]):e._e(),t("div",{staticClass:"studentBase"},[e._v("专业基地:"+e._s(s.basename))]),t("div",{staticClass:"x-line"})])})),0),t("div",{staticClass:"countBottom"},[t("transition",{attrs:{name:"plus-icon"}},[e.selectStudent.show?t("div",{staticClass:"countBottomList"},[t("div",{staticClass:"countBottomListTop"},[e._v("已选学员")]),t("div",{staticClass:"countBottomListContent"},e._l(e.student,(function(i,a){return t("div",{key:a,staticClass:"countBottomListItem"},[t("div",{staticClass:"hfiayu"},[t("span",[e._v(" "+e._s(i.name)+" "),i.username?t("span",[e._v("-"+e._s(i.username))]):e._e()]),i.showDel?t("img",{attrs:{src:s(18355)},on:{click:function(t){return e.deletedoctor("student",a)}}}):e._e()]),t("div",{staticClass:"x-line"})])})),0)]):e._e(),e.selectStudent.turndeptshow?t("div",{staticClass:"countBottomList"},[t("div",{staticClass:"countBottomListTop"},[e._v("轮转科室")]),t("div",{staticClass:"countBottomListContent"},e._l(e.selectlevels.tree,(function(s,i){return t("div",{key:i,staticClass:"countBottomListItem"},[t("span",[e._v(e._s(s.name))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectStudent.deptchecked,expression:"selectStudent.deptchecked"}],staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(e.selectStudent.deptchecked)?e._i(e.selectStudent.deptchecked,s)>-1:e.selectStudent.deptchecked},on:{change:function(t){var i=e.selectStudent.deptchecked,a=t.target,n=!!a.checked;if(Array.isArray(i)){var l=s,c=e._i(i,l);a.checked?c<0&&e.$set(e.selectStudent,"deptchecked",i.concat([l])):c>-1&&e.$set(e.selectStudent,"deptchecked",i.slice(0,c).concat(i.slice(c+1)))}else e.$set(e.selectStudent,"deptchecked",n)}}})])})),0)]):e._e()]),t("div",{staticClass:"countBottomFoot"},[t("span",{staticClass:"countInput"},[t("van-checkbox",{attrs:{shape:"square"},on:{click:e.studentCheck},model:{value:e.studentCheckedAll,callback:function(t){e.studentCheckedAll=t},expression:"studentCheckedAll"}},[e._v("全选")])],1),t("span",{staticClass:"countNumber"},[t("span",[t("span",{staticClass:"countNq"},[e._v("已选学员")]),t("span",{class:{countNw:!0,countNe:e.student.length>0}},[e._v(e._s(e.student.length))]),t("span",{staticClass:"countNq"},[e._v("位")])]),t("span",{staticClass:"countNr",on:{click:function(t){e.selectStudent.turndeptshow=!1,e.selectStudent.show=!e.selectStudent.show}}},[e._v(" 查看列表 "),e.selectStudent.show?t("van-icon",{attrs:{name:"arrow-up",color:"#999999"}}):t("van-icon",{attrs:{name:"arrow-down",color:"#999999"}})],1)]),t("span",{staticStyle:{width:"10px"}})])],1),t("van-overlay",{attrs:{show:e.selectStudent.show||e.selectStudent.turndeptshow},on:{click:function(t){e.selectStudent.show=!1,e.selectStudent.turndeptshow=!1}}})],1)])]),e.examitempreviewvisible?t("scoresheet-preview",{attrs:{examitemid:e.examitemidpreview,examitemname:e.examitempreviewname},on:{setPreviewVisible:e.setPreviewVisible}}):e._e(),t("div",{staticClass:"rotationh"},[t("div",{staticClass:"rotationc"},[t("van-popup",{attrs:{"lazy-render":!1,"close-on-click-overlay":!1,position:"bottom"},model:{value:e.popShow,callback:function(t){e.popShow=t},expression:"popShow"}},[t("van-nav-bar",{attrs:{title:"请选择","left-text":"取消","right-text":"确定","left-arrow":""},on:{"click-left":e.onClickLeft,"click-right":e.onClickRight}}),t("van-toast"),t("div",{staticClass:"popCK"},[t("div",{staticClass:"popCBox"},[t("van-sidebar",{on:{change:e.onChange},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},e._l(e.columns,(function(e,s){return t("van-sidebar-item",{key:s,attrs:{title:e.name}})})),1)],1),t("div",{staticClass:"popKBox"},[t("el-tree",{ref:"tree",attrs:{"show-checkbox":"","check-strictly":!0,data:e.deptList,props:e.defaultProps,"node-key":"id"},on:{"check-change":e.checkClick}})],1)])],1)],1)]),t("div",{staticClass:"rotationc"},[t("van-popup",{attrs:{"lazy-render":!1,"close-on-click-overlay":!1,position:"bottom"},model:{value:e.popShow2,callback:function(t){e.popShow2=t},expression:"popShow2"}},[t("van-nav-bar",{attrs:{title:"请选择","left-text":"取消","right-text":"确定","left-arrow":""},on:{"click-left":e.onClickLeft2,"click-right":e.onClickRight2}}),t("van-toast"),t("div",{staticClass:"popCK"},[t("div",{staticClass:"popCBox"},[t("van-sidebar",{on:{change:e.onChange2},model:{value:e.activeKey2,callback:function(t){e.activeKey2=t},expression:"activeKey2"}},e._l(e.columns2,(function(e,s){return t("van-sidebar-item",{key:s,attrs:{title:e.name}})})),1)],1),t("div",{staticClass:"popKBox"},[t("el-tree",{ref:"tree2",attrs:{"show-checkbox":"","check-strictly":!0,data:e.baseList,props:e.defaultProps,"node-key":"id"},on:{"check-change":e.checkClick2}})],1)])],1)],1),t("van-dialog",{attrs:{title:"base"==e.surelevel?"基地列表":"科室列表",confirmButtonColor:"#3499db"},model:{value:e.choicedeptOut,callback:function(t){e.choicedeptOut=t},expression:"choicedeptOut"}},[t("div",{staticClass:"choicetypeOutList"},e._l(e.selectlevels.tree,(function(s,i){return t("div",{key:i,staticClass:"choicetypeOutItem"},[t("span",[e._v(e._s(s.name))])])})),0)]),t("van-dialog",{attrs:{title:"考核项目",confirmButtonColor:"#3499db"},model:{value:e.choicetypeOut,callback:function(t){e.choicetypeOut=t},expression:"choicetypeOut"}},[t("div",{staticClass:"choicetypeOutList"},e._l(e.selectexamitems,(function(s,i){return t("div",{key:i,staticClass:"choicetypeOutItem"},[t("span",[e._v(e._s(s.examitemname))])])})),0)]),t("van-dialog",{attrs:{title:"考官列表",confirmButtonColor:"#3499db"},model:{value:e.choiceteacherOut,callback:function(t){e.choiceteacherOut=t},expression:"choiceteacherOut"}},[t("div",{staticClass:"choicetypeOutList"},e._l(e.teacher,(function(s,i){return t("div",{key:i,staticClass:"choicetypeOutItem"},[t("span",[e._v(e._s(s.name))])])})),0)]),t("van-popup",{attrs:{position:"bottom"},model:{value:e.getstarttime.show,callback:function(t){e.$set(e.getstarttime,"show",t)},expression:"getstarttime.show"}},[t("van-datetime-picker",{attrs:{type:"datetime",title:"考核开始时间","min-date":e.minDate,"max-date":e.maxDate,"confirm-button-text":"确定","cancel-button-text":"取消"},on:{confirm:e.selectstarttime,cancel:e.cancelstarttime},model:{value:e.starttime2,callback:function(t){e.starttime2=t},expression:"starttime2"}})],1),t("van-popup",{attrs:{position:"bottom"},model:{value:e.getendtime.show,callback:function(t){e.$set(e.getendtime,"show",t)},expression:"getendtime.show"}},[t("van-datetime-picker",{attrs:{type:"datetime",title:"考核结束时间","min-date":e.minDate,"max-date":e.maxDate,"confirm-button-text":"确定","cancel-button-text":"取消"},on:{confirm:e.selectendtime,cancel:e.cancelendtime},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1),t("van-popup",{attrs:{position:"bottom"},model:{value:e.startTimeShown,callback:function(t){e.startTimeShown=t},expression:"startTimeShown"}},[t("van-datetime-picker",{attrs:{type:"date",title:"计划轮转周期开始时间","min-date":e.minDate2,"max-date":e.maxDate2,formatter:e.formatter,"confirm-button-text":"确定","cancel-button-text":"取消"},on:{confirm:e.selectstarttime2,cancel:function(t){e.startTimeShown=!1}},model:{value:e.searchStudentstarttime2,callback:function(t){e.searchStudentstarttime2=t},expression:"searchStudentstarttime2"}})],1),t("van-popup",{attrs:{position:"bottom"},model:{value:e.endTimeShown,callback:function(t){e.endTimeShown=t},expression:"endTimeShown"}},[t("van-datetime-picker",{attrs:{type:"date",title:"计划轮转周期结束时间","min-date":e.minDate2,"max-date":e.maxDate2,formatter:e.formatter,"confirm-button-text":"确定","cancel-button-text":"取消"},on:{confirm:e.selectendtime2,cancel:function(t){e.endTimeShown=!1}},model:{value:e.searchStudentendtime2,callback:function(t){e.searchStudentendtime2=t},expression:"searchStudentendtime2"}})],1)],1)},a=[],n=(s(70560),s(5348)),l=s(68934),c=(s(63822),s(82130)),o=s(36797),r=s.n(o),m={components:{scoresheetPreview:c["default"]},data(){return{choiceteacherOut:!1,choicedeptOut:!1,selectexamitemsnamesSave:[],index:0,listLength:0,jl:!0,allselectsign:"全选",allselectstate:!1,haha:[],addstdlist:[],delstdlist:[],addteclist:[],delteclist:[],getstudent:[],getteacher:[],iscreate:"",isoverdue:"",examing:"",beforeexam:"",isshowdialog:!this.isoverdue,searchIndex:0,modify:!1,loading:!1,issubmit:!1,choicelevel:!1,examType:"",searchitemsname:"",address:"",allitemsselect:[],myitemsselect:[],selectexamitems:[],getselectexamitems:[],getstudent:[],officelist:{show:!1,mainlist:[],valueKey:"deptname"},mytypeitemslist:[],alltypeitemslist:[],selectexamitem:[],data:"",levelList:[],levelname:"科室",surelevel:"",selectlevels:{name:"",id:"",tree:[]},baselist:{show:!1,mainlist:[],valueKey:"deptname"},choicetype:!1,isstutype:"grade",getstarttime:{show:!1,istime:!0,isday:!0},getendtime:{show:!1,istime:!0,isday:!0},seltype:{show:!1,mainlist:[],valueKey:"name"},typeitems:{show:!1,mainlist:[],valueKey:"name"},typelist:[],searchname:"",choiceteacher:!1,choicestudent:!1,starttime:"",endtime:"",starttime2:"",endtime2:"",typename:{id:"",name:""},placename:"",teacher:[],student:[],remark:"",teacherlist:[],studentlist:[],tempstudentlist:[],examtype:"",selectExamitem:{show:!1,title:"考核项"},selectTeacher:{show:!1,title:"已选考官"},selectStudent:{turndeptshow:!1,deptchecked:[],selectStudent:[],show:!1,title:"考核人员"},timer:"",examitemidpreview:"",examitempreviewvisible:!1,examitempreviewname:"",choicetypeOut:!1,searchStudent:"",searchStudentstarttime:"",searchStudentendtime:"",searchStudentstarttimeShow:"",searchStudentendtimeShow:"",searchStudentturndept:"",startTimeShown:!1,endTimeShown:!1,turnDeptShown:!1,popShow:!1,columns:[],deptList:[],hosIdByDeptSave:0,oriactiveKey:0,activeKey:0,deptnameidList:[],orideptnameidList:[],defaultProps:{children:"childrens",label:"name",disabled:function(e,t){return 1!=e.havePermission}},popShow2:!1,columns2:[],deptList2:[],hosIdByDeptSave2:0,oriactiveKey2:"",activeKey2:0,deptnameidList2:[],orideptnameidList2:[],minDate:"",maxDate:""}},computed:{Navtitle(){return this.$route.query.id?"编辑出科考核":"创建出科考核"},studentCheckedAll(){let e=this,t=new Set(e.student.map((e=>e.uid)));for(let s=0;s<e.studentlist.length;s++)if(!t.has(e.studentlist[s].uid))return!1;return!0},selectexamitemsnames(){return this.selectexamitems.map((e=>e.examitemname)).join("、")},teachernames(){return this.teacher.map((e=>e.name)).join("、")},studentnames(){return this.student.map((e=>e.name)).join("、")},maxDate(){let e=new Date,t=e.getFullYear()+10,s=new Date(t,e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());return s},minDate(){return new Date},maxDate2(){let e=new Date,t=e.getFullYear()+3,s=new Date(t,e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());return s},minDate2(){let e=new Date,t=e.getFullYear()-3,s=new Date(t,e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());return s}},watch:{surelevel:function(e){"base"==e&&(this.levelname="基地"),"office"==e&&(this.levelname="科室"),this.selectlevels={name:"",id:"",tree:[]},this.student=[],this.teacher=[],this.selectexamitems=[],this.$refs.tree.setCheckedKeys([]),this.$refs.tree2.setCheckedKeys([])},myitemsselect(e){this.unique()},selectStudent:{handler(e){this.selectStudent.deptchecked.length>0&&this.initstudentlist(this.selectlevels.id)},immediate:!0,deep:!0}},mounted(){this.getMinMaxTime(),this.initLevel(),this.getTree(),this.inittypelist(),this.getExamStatus(),this.$route.query.id&&this.getturndetail()},methods:{...l.Z,examSubmit(){this.iscreate?this.submit():this.beforeexam?this.modifyFn():this.examing&&this.examingModify()},studengDeptCheck(e){},startTimeShow(){let e=this;e.startTimeShown=!0},endTimeShow(){let e=this;e.endTimeShown=!0},turnDeptShow(){let e=this;e.turnDeptShown=!1},studentCheck(){let e=this;if(e.studentCheckedAll){let t=new Set(e.studentlist.map((e=>e.uid))),s=e.student.filter((e=>!t.has(e.uid)));e.student=s}else if(e.student.length){let t=new Set(e.student.map((e=>e.uid)));for(let s of e.studentlist)t.has(s.uid)||e.student.push(s)}else e.student=e.studentlist},getExamStatus(){0==this.$route.query.editflag?(this.isoverdue=!1,this.examing=!0,this.beforeexam=!1):1==this.$route.query.editflag?(this.isoverdue=!1,this.beforeexam=!0,this.examing=!1):2==this.$route.query.editflag?(this.isoverdue=!1,this.examing=!0,this.beforeexam=!1):(this.isoverdue=!1,this.beforeexam=!1,this.examing=!1,this.iscreate=!0)},getMinMaxTime(){let e=new Date,t=e.getFullYear()+10,s=new Date(t,e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());this.maxDate=s,this.minDate=new Date},initLevel(){return new Promise(((e,t)=>{this.post("/turnExamInfo/getturnexamlevel",{command:"turnExamInfo/getturnexamlevel",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),uid:$.cookie("uid")}).done((t=>{e(),0==t.errcode&&(this.levelList=t.turnexamlevellist)}))}))},getTree(){let e=this;e.post("/base/dept/getMyDeptTree",{showHospital:1,showNoDeptHospital:0,needBaseDept:0,hospitalId:""}).done((t=>{t&&200==t.resCode&&Array.isArray(t.model)&&t.model.length>0&&(e.columns=t.model,e.deptList=t.model[0].childrens)})),e.post("/base/dept/getHosBaseTree").done((t=>{t&&200==t.resCode&&Array.isArray(t.model)&&t.model.length>0&&(e.columns2=t.model,e.baseList=t.model[0].childrens)}))},selLevel(){let e=this;if(this.examing)return this.choicedeptOut=!0,void console.log(e.selectlevels);"office"==this.surelevel?(e.popShow=!0,e.listLength=this.selectlevels.tree.length):"base"==this.surelevel?(e.popShow2=!0,e.listLength=this.selectlevels.tree.length):e.$toast("请先选择考核级别")},initselectlevels(){this.selectlevels={name:"",id:"",tree:[]}},seltypeFn(){this.examing||(this.seltype.show=!0)},back(){n.Z.confirm({title:"温馨提示",message:"你当前操作尚未提交保存，是否确认返回？",confirmButtonColor:"#3499db"}).then((()=>{window.history.back()})).catch((()=>{}))},inittypelist(){let e=this;return new Promise(((t,s)=>{this.post("/traineestudent/queryDictionaryList",{command:"traineestudent/queryDictionaryList",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),code:"turnexam_type"}).done((s=>{t("fadf"),s&&0==s.errcode?(this.seltype.mainlist=s.dic_list,this.seltype.mainlist=this.seltype.mainlist.filter((e=>{if(3!=e.key)return e}))):s.errdesc?this.toast(s.errdesc):e.toast("服务器错误，请联系管理员。")}))}))},getDefaultTime(){let e=this;e.searchStudentendtimeShow="",e.searchStudentstarttimeShow="",this.initstudentlist(this.selectlevels.id),console.log(this.studentlist),console.log(this.student)},selecttype(e){console.log(e),this.typename=e,this.seltype.show=!1,e!==this.examtype&&(this.student=[]),"2"==e.key&&(this.examtype=2),"1"==e.key&&(this.examtype=1),this.selectexamitems=[],this.allitemsselect=[],this.myitemsselect=[]},showstarttime(){this.examing||(this.getstarttime.show=!0)},initexamitems(){this.examing?this.choicetypeOut=!0:(this.choicetype=!0,this.$nextTick((()=>{this.$refs.tabs.resize()})),this.gettypeitemslist(this.searchitemsname),this.examitemsfn(0))},gettypeitemslist(e){let t={command:"turnannualresult/queryexamitemlist",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),examitemname:e,examitemtype:this.examtype,sysType:1};this.surelevel,t.deptList=this.selectlevels.id,this.post("/turnannualresult/queryexamitemlist",t).done((e=>{e&&0==e.errcode?this.alltypeitemslist=e.examitemlist:this.$toast("请选择基地或者科室"),this.setscActive()}))},setscActive(){this.alltypeitemslist.map((e=>{e.active=!1,this.mytypeitemslist.map((t=>{t.examitemid==e.examitemid&&(e.active=!0,t.active=!0)}))})),console.log(this.mytypeitemslist)},examitemFn(){this.unique(),this.choicetype=!1,this.selectExamitem.show=!1},unique(){let e={},t=[];for(var s of(this.selectexamitems=this.allitemsselect.concat(this.myitemsselect),this.selectexamitems))e[s["examitemid"]]||(t.push(s),e[s["examitemid"]]=!0);this.selectexamitems=t},searchtypeitems(){clearTimeout(this.timer),this.timer=setTimeout((()=>{1==this.searchIndex?this.gettypeitemslist(this.searchitemsname):this.examitemsfn(this.searchIndex,this.searchitemsname)}),250)},examitemsSwitch(e){this.examitemsfn(e)},scoresheetPreview(e,t){this.examitemidpreview=e,this.examitempreviewvisible=!0,this.examitempreviewname=t},scFn(e){e.active||this.post("/turnExamInfo/collectexamitem",{command:"turnExamInfo/collectexamitem",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),examitemid:e.examitemid}).done((e=>{0==e.errcode&&this.examitemsfn(0)})),e.active&&this.post("/turnExamInfo/removeexamitem",{command:"turnExamInfo/removeexamitem",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),examitemid:e.examitemid}).done((e=>{0==e.errcode&&this.examitemsfn(0)}))},scoresheetPreview(e,t){this.examitemidpreview=e,this.examitempreviewvisible=!0,this.examitempreviewname=t},submit(){let e=this;if(""===this.surelevel)return void this.$toast("请选择考核级别");if(!this.selectlevels.id)return void this.$toast("请选择科室或者基地！");if(!this.typename.id)return void this.$toast("请选择考核类型！");if(this.typename&&0==this.selectexamitems.length)return void this.$toast("请添加考核项");if(!this.starttime)return void this.$toast("请选择考核开始时间！");if(!this.endtime)return void this.$toast("请选择考核结束时间！");if(!this.address)return void this.$toast("请选择考核地点！");if(this.teacher.length<=0)return void this.$toast("请选择考官！");if(this.student.length<=0)return void this.$toast("请选择考核学员！");let t=[];this.student.length>0&&this.student.map((e=>{t.push({stdid:e.uid,seiid:e.seiid,turnDeptId:e.deptid})}));let s=[];this.teacher.map((e=>{s.push(e.id)}));let i=[];this.selectexamitems.map((e=>{i.push(e.examitemid)})),this.issubmit=!0,n.Z.confirm({title:"温馨提示",message:"您是否确认提交？",confirmButtonColor:"#3499db"}).then((()=>{let a={command:"turnExamInfo/addturnexam",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),examLevel:"base"==e.surelevel?1:0,startTime:e.starttime,endTime:e.endtime,examTypeId:parseInt(e.typename.key),examType:parseInt(e.typename.key),place:e.address,remark:e.remark,teclist:s,stdlist:t,examitemlist:i};e.surelevel,a.deptIdList=e.selectlevels.id,e.post("/turnExamInfo/addturnexam",a).done((t=>{e.issubmit=!1,t&&0==t.errcode?(e.$toast("新增成功~"),e.$router.push({name:"extranceExamlist"})):t.errdesc?e.$toast(t.errdesc):e.$toast("服务器错误，请联系管理员。")})).fail((function(t){e.issubmit=!1}))})).catch((()=>{}))},modifyFn(){let e=this;if(""===this.surelevel)return void this.$toast("请选择考核级别");if(!this.selectlevels.id)return void this.$toast("请选择科室或者基地！");if(!this.typename.id)return void this.$toast("请选择考核类型！");if(this.typename&&1==this.typename.key&&0==this.selectexamitems.length)return void this.$toast("请添加考核项");if(!this.starttime)return void this.$toast("请选择考核开始时间！");if(!this.endtime)return void this.$toast("请选择考核结束时间！");if(!this.address)return void this.$toast("请填写考核地点！");if(this.teacher.length<=0)return void this.$toast("请选择考官！");if(this.student.length<=0)return void this.$toast("请选择考核学员！");if(r()(this.endtime).format("X")<=r()(this.starttime).format("X"))return void this.$toast("结束时间必须大于开始时间！");let t=[];this.student.map((e=>{t.push({stdid:e.uid,seiid:e.seiid,turnDeptId:e.deptid})}));let s=[];this.teacher.map((e=>{s.push(e.id)}));let i=[];this.selectexamitems.map((e=>{i.push(e.examitemid)})),this.issubmit=!0,n.Z.confirm({title:"温馨提示",message:"您是否确认提交？",confirmButtonColor:"#3499db"}).then((()=>{e.post("/turnExamInfo/modifyturnexam",{command:"turnExamInfo/modifyturnexam",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),id:e.$route.query.id,examLevel:"base"==e.surelevel?1:0,deptIdList:e.selectlevels.id,startTime:e.starttime,endTime:e.endtime,examTypeId:parseInt(e.typename.key),examType:parseInt(e.typename.key),place:e.address,remark:e.remark,stdlist:t,teclist:s,examitemlist:i}).done((t=>{e.issubmit=!1,t&&0==t.errcode?(e.$toast("提交成功~"),e.$router.push({name:"extranceExamlist"})):t.errdesc?e.$toast(t.errdesc):e.$toast("服务器错误，请联系管理员。")})).fail((function(t){e.issubmit=!1}))})).catch((()=>{}))},formatter(e,t){return"year"===e?`${t}年`:"month"===e?`${t}月`:"day"===e?`${t}日`:t},scFn(e){e.active||this.post("/turnExamInfo/collectexamitem",{command:"turnExamInfo/collectexamitem",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),examitemid:e.examitemid}).done((e=>{0==e.errcode&&this.examitemsfn(0)})),e.active&&this.post("/turnExamInfo/removeexamitem",{command:"turnExamInfo/removeexamitem",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),examitemid:e.examitemid}).done((e=>{0==e.errcode&&this.examitemsfn(0)}))},setPreviewVisible(){this.examitempreviewvisible=!1},initstudent(){this.isoverdue?this.selectStudent.show=!0:this.selectlevels.tree?(this.initstudentlist(this.selectlevels.id,""),console.log(this.selectlevels.id)):this.$toast("请先选择科室/基地")},initstudentlist(e){let t=this,s={};console.log(this.selectStudent.deptchecked),s=this.selectStudent.deptchecked.length>0?"base"==this.surelevel?{baseIdList:this.selectStudent.deptchecked.map((e=>e.id))}:{deptIdList:this.selectStudent.deptchecked.map((e=>e.id))}:"base"==this.surelevel?{baseIdList:e}:{deptIdList:e},this.post("/turnExamInfo/queryexamineelist",{command:"turnExamInfo/queryexamineelist",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),keyword:this.searchStudent,planBeginTime:this.searchStudentstarttimeShow,planEndTime:this.searchStudentendtimeShow,turnExamId:t.beforeexam?t.$route.query.id:"",examtype:this.examtype,...s}).done((e=>{e&&0==e.errcode?(this.studentlist=e.dept_stu_list,this.studentlist.forEach((e=>{e.showDel=!0})),setTimeout((()=>{this.studentSup()}),500)):this.$toast("当前没有查询到该类型的学员。")})).fail((()=>{}))},studentSup(){setTimeout((()=>{console.log("student",this.student),console.log("studentlist",this.studentlist),this.choicestudent=!0}));for(let e=0;e<this.student.length;e++)for(let t=0;t<this.studentlist.length;t++)if(this.student[e].uid==this.studentlist[t].uid&&1==this.student[e].showDel&&this.student[e].deptId==this.studentlist[t].deptid){let s={};s=this.studentlist[t],this.student[e]=s}},examitemsfn(e,t){this.searchIndex=e,0===e&&this.post("/turnExamInfo/querymyexamitemlist",{command:"turnExamInfo/querymyexamitemlist",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),examitemname:t,sysType:1,examitemtype:this.examtype,deptList:this.selectlevels.id}).done((e=>{0==e.errcode?(this.mytypeitemslist=e.examitemlist,this.setscActive()):this.$toast(e.errdesc)})).fail((()=>{this.$toast("服务器错误，请联系管理员。")}))},unique(){let e={},t=[];for(var s of(this.selectexamitems=this.allitemsselect.concat(this.myitemsselect),this.selectexamitems))e[s["examitemid"]]||(t.push(s),e[s["examitemid"]]=!0);this.selectexamitems=t},deletedoctor(e,t){let s,i=this,a=[];if("student"==e&&(s="考核人员",a=this.student),"examitem"==e&&(s="考核项",a=this.selectexamitems),"examiner"==e&&(s="考官",a=this.teacher),e&&("student"==e&&i.student.splice(t,1),"examiner"==e&&i.teacher.splice(t,1),"examitem"==e)){console.log(a),console.log(i.allitemsselect),console.log(i.myitemsselect);let e=a[t].examitemid;i.selectexamitems.splice(t,1),i.allitemsselect.map(((t,s)=>{t.examitemid==e&&i.allitemsselect.splice(s,1)})),i.myitemsselect.map(((t,s)=>{t.examitemid==e&&i.myitemsselect.splice(s,1)}))}},initteacher(){this.examing?this.choiceteacherOut=!0:this.isoverdue?this.selectTeacher.show=!0:this.selectlevels.id?(this.choiceteacher=!0,this.initteacherlist(this.selectlevels.id,"")):this.$toast("请先选择科室或基地")},initteacherlist(e,t){let s,i=this;s="base"==i.surelevel?{keyword:t,teachingType:"escort"==localStorage.getItem("system")?4:"",baseList:e}:{keyword:t,deptIdList:e,teachingType:"escort"==localStorage.getItem("system")?4:""},i.post("/base/teachers/listExaminer",s).done((e=>{this.teacherlist=e.model}))},searchteacher(){console.log(this.selectlevels),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.initteacherlist(this.selectlevels.id,this.searchname)}),250)},formatDate(e){const t=new Date(e),s=t.getFullYear(),i=(t.getMonth()+1).toString().padStart(2,"0"),a=t.getDate().toString().padStart(2,"0"),n=("0"+t.getHours()).slice(-2),l=("0"+t.getMinutes()).slice(-2),c=("0"+t.getSeconds()).slice(-2),o=`${s}-${i}-${a} ${n}:${l}:${c}`;return o},formatDate2(e){const t=new Date(e),s=t.getFullYear(),i=(t.getMonth()+1).toString().padStart(2,"0"),a=t.getDate().toString().padStart(2,"0"),n=(("0"+t.getHours()).slice(-2),("0"+t.getMinutes()).slice(-2),("0"+t.getSeconds()).slice(-2),`${s}-${i}-${a}`);return n},formatDateString(e){const t=new Date(e),s=t.toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"});return s},selectstarttime(e){if(this.endtime2){if(r()(this.endtime2)<r()(e))return void this.$toast("选择开始时间小于结束时间");this.starttime=this.formatDate(e),this.starttime2=e}else this.starttime=this.formatDate(e),this.starttime2=e;this.getstarttime.show=!1},selectstarttime2(e){if(this.searchStudentendtime){if(r()(this.searchStudentendtime)<r()(e))return void this.$toast("选择开始时间小于结束时间");this.searchStudentstarttimeShow=this.formatDate2(e),this.searchStudentstarttime=e,this.initstudentlist(this.selectlevels.id)}else this.searchStudentstarttimeShow=this.formatDate2(e),this.searchStudentstarttime=e;this.startTimeShown=!1},selectendtime2(e){if(this.searchStudentstarttime){if(r()(this.searchStudentstarttime)>r()(e))return void this.$toast("选择开始时间小于结束时间");this.searchStudentendtimeShow=this.formatDate2(e),this.searchStudentendtime=e,this.initstudentlist(this.selectlevels.id)}else this.searchStudentendtimeShow=this.formatDate2(e),this.searchStudentendtime=e;this.endTimeShown=!1},selectendtime(e){if(console.log(this.starttime2,e),this.starttime2){if(r()(this.starttime2)>r()(e))return void this.$toast("选择结束时间大于开始时间");this.endtime=this.formatDate(e),this.endtime2=e}else this.endtime=this.formatDate(e),this.endtime2=e;this.getendtime.show=!1},cancelstarttime(){this.getstarttime.show=!1},cancelendtime(){this.getendtime.show=!1},getturndetail(){this.post("/turnExamInfo/turnexamdetail",{command:"turnExamInfo/turnexamdetail",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),id:this.$route.query.id}).done((e=>{0==e.errcode&&(this.jl=!1,this.surelevel=e.examlevel?"base":"office",this.$set(this.typename,"name",this.filterType(e.exam_typeid)),this.examtype=Number(e.examtype),this.starttime=e.starttime,this.endtime=e.endtime,this.address=e.place,this.remark=e.remark,this.getselectexamitems=e.examitemlist,this.allitemsselect=this.getselectexamitems,this.myitemsselect=this.getselectexamitems,this.selectexamitems=this.getselectexamitems,this.starttime2=e.starttime,setTimeout((()=>{this.selectlevels.tree=e.deptIdNameVoList,this.selectlevels.tree.forEach((e=>{e.name=e.deptName,e.id=e.deptId})),this.selectlevels.name=e.deptIdNameVoList.map((e=>e.deptName)).join("、"),e.examlevel,this.selectlevels.id=e.deptIdNameVoList.map((e=>e.deptId)),this.$refs.tree.setCheckedKeys(this.selectlevels.id),this.typename.id=e.exam_typeid,this.typename.key=e.examtype,this.teacher=e.teacherlist,this.teacher.map((e=>{this.$set(e,"name",e.teachername),this.$set(e,"id",String(e.teacherid)),delete e["teachername"],delete e["teacherid"]})),this.getteacher=JSON.parse(JSON.stringify(this.teacher)),this.delteacher=JSON.parse(JSON.stringify(this.teacher)),this.student=e.studentlist,this.student.map((e=>{this.$set(e,"name",e.studentname),this.$set(e,"uid",e.studentid),this.$set(e,"seiid",e.seiid),this.$set(e,"deptId",e.deptId),delete e["studentname"],delete e["studentid"],this.$set(e,"showDel",!!this.beforeexam)})),console.log(this.student),console.log(this.selectlevels),this.getstudent=JSON.parse(JSON.stringify(this.student)),this.delstudent=JSON.parse(JSON.stringify(this.student)),setTimeout((()=>{this.jl=!0}),100)}),1e3))}))},filterType(e){for(let t of this.seltype.mainlist)if(t.key==e)return t.name},examingModify(){let e=this;console.log(this.typename,this.selectexamitems),this.selectlevels.id?this.typename?this.typename&&0==this.selectexamitems.length?this.$toast("请添加考核项"):this.starttime?this.endtime?this.address?this.teacher.length<=0?this.$toast("请选择考官！"):r()(this.endtime).format("X")<=r()(this.starttime).format("X")?this.$toast("结束时间必须大于开始时间！"):(this.exammingStd(),this.examingTec(),this.issubmit=!0,n.Z.confirm({title:"温馨提示",message:"您是否确认提交？",confirmButtonColor:"#3499db"}).then((()=>{e.addstdlist.forEach((e=>{e.turnDeptId=e.deptid})),e.post("/turnExamInfo/tempmodifyturnexam",{command:"turnExamInfo/tempmodifyturnexam",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),endtime:e.endtime,place:e.address,remark:e.remark,id:e.$route.query.id,addstdlist:e.addstdlist,delstdlist:e.delstdlist,addteclist:e.addteclist,delteclist:e.delteclist}).done((t=>{e.issubmit=!1,t&&0==t.errcode?(e.$toast("提交成功~"),e.$router.push({name:"extranceExamlist"})):t.errdesc?e.$toast(t.errdesc):e.$toast("服务器错误，请联系管理员。")})).fail((function(t){e.issubmit=!1}))})).catch((()=>{}))):this.$toast("请选择考核地点！"):this.$toast("请选择考核结束时间！"):this.$toast("请选择考核开始时间！"):this.$toast("请选择考核类型！"):this.$toast("考核考核级别！")},exammingStd(){this.addstdlist=[],this.delstdlist=[],console.log(this.student,this.getstudent),this.student.forEach((e=>{e.deptid&&(e.deptId=e.deptid)}));for(let e of this.student){let t=!1;for(let s of this.getstudent)if(e.uid==s.uid&&e.deptId==s.deptId){t=!0;break}t||this.addstdlist.push(e)}this.addstdlist.map((e=>{this.$set(e,"stdid",e.uid),delete e["name"],delete e["uid"]}));for(let e=0;e<this.delstudent.length;e++)for(let t=0;t<this.student.length;t++)if(this.student[t].uid==this.delstudent[e].uid){this.delstudent.splice(e--,1);break}this.delstdlist=JSON.parse(JSON.stringify(this.delstudent)),this.delstdlist.map((e=>{this.$set(e,"stdid",e.uid),delete e["uid"],delete e["name"]}))},examingTec(){this.addteclist=[],this.delteclist=[],console.log(this.teacher,this.getteacher);for(let s of this.teacher){let e=!1;for(let t of this.getteacher)if(s.id==t.id){e=!0;break}e||this.addteclist.push(s)}let e=[];this.addteclist.map((t=>{e.push(t.id)})),this.addteclist=e,console.log(this.delteacher);for(let s=0;s<this.delteacher.length;s++)for(let e=0;e<this.teacher.length;e++)if(this.teacher[e].id==this.delteacher[s].id){this.delteacher.splice(s--,1);break}this.delteclist=JSON.parse(JSON.stringify(this.delteacher));let t=[];for(let s of this.delteclist)t.push(s.id);this.delteclist=t},selectdept(e){},selectbase(e){console.log("selectbase"),this.selectlevels.name=e.deptname,this.selectlevels.id=e.id},onChange(e){let t=this;t.hosIdByDeptSave=t.columns[e].id,t.deptList=t.columns[e].childrens,this.$refs.tree.setCheckedKeys(t.selectlevels.id)},checkClick(e,t,s){let i=this;if(i.jl)if(console.log("click"),t)console.log(e),console.log(this.selectlevels),i.selectlevels.tree.push(e),this.selectlevels.name=i.selectlevels.tree.map((e=>e.name)).join("、"),this.selectlevels.id=i.selectlevels.tree.map((e=>e.id)),console.log(this.selectlevels);else{let t=i.selectlevels.tree;console.log(i.selectlevels.tree),this.selectexamitems=[],this.myitemsselect=[];for(var a=t.length-1;a>=0;a--)t[a].id!==e.id&&t[a].baseId!==e.id&&t[a].deptId!==e.id||t.splice(a,1),i.selectlevels.tree=t,this.selectlevels.name=i.selectlevels.tree.map((e=>e.name)).join("、"),this.selectlevels.id=i.selectlevels.tree.map((e=>e.id)),console.log(this.selectlevels);this.selectlevels.tree.length<this.listLength&&(this.selectexamitems=[],this.myitemsselect=[],this.teacher=[],this.student=[])}},onClickLeft(){let e=this;e.popShow=!1},onClickRight(){let e=this;e.popShow=!1},onChange2(e){let t=this;t.hosIdByDeptSave2=t.columns2[e].id,t.baseList=t.columns2[e].childrens,this.$refs.tree2.setCheckedKeys(t.selectlevels.id)},checkClick2(e,t,s){console.log("click2");let i=this;if(i.jl)if(t)i.selectlevels.tree.push(e),this.selectlevels.name=i.selectlevels.tree.map((e=>e.name)).join("、"),this.selectlevels.id=i.selectlevels.tree.map((e=>e.id)),console.log(this.selectlevels);else{let t=i.selectlevels.tree;this.myitemsselect=[];for(var a=t.length-1;a>=0;a--)t[a].id===e.id&&t.splice(a,1),i.selectlevels.tree=t,this.selectlevels.name=i.selectlevels.tree.map((e=>e.name)).join("、"),this.selectlevels.id=i.selectlevels.tree.map((e=>e.id)),console.log(this.selectlevels);this.selectlevels.tree.length<this.listLength&&(this.selectexamitems=[],this.myitemsselect=[],this.teacher=[],this.student=[])}},onClickLeft2(){let e=this;e.popShow2=!1},setscActive(){this.alltypeitemslist.map((e=>{e.active=!1,this.mytypeitemslist.map((t=>{t.examitemid==e.examitemid&&(e.active=!0,t.active=!0)}))}))},onClickRight2(){let e=this;e.popShow2=!1}}},d=m,h=s(1001),u=(0,h.Z)(d,i,a,!1,null,"745367b2",null),p=u.exports},18355:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA2CAYAAACMRWrdAAAAAXNSR0IArs4c6QAAAARzQklUCAgICHwIZIgAAAVoSURBVGiB7VpNaGRFEK7qnpiF5DCQEQMK5hDZwAqbS2Av4uYmM5kZByUXERzQw57Wg+BFwYOg4MGreIkXD5tLMvOckwvZmxcPK2Qh6ooRAwaZwCATSeD1Kw++N1TX9Jv3s2/CHuaDhane6uqq19XVX3cHYIYZngpg0Qb39/ffVUq9AQDXUna5AIB7jUbjmyL9KDSwXq+3bIz5K0dX3xjzbKvVGhTliyrKEAAAIpZyds3bLxaFp2Kn0/kIEd+ClKmIiEMi+rbRaHxetC8zzPAUYGyNdTqdVUR8XjSXlVLPBEHw9xX55QQiLgPAv0T0D283xvzRarWOLV0udLvdLwDgg6l7OAUg4qf1ev3jSJbl/s0r9qdIbHHBCgwRf7xaX4pDEAQ/cdnaGPv9/tuVSuUeES2y5lcB4J1IIKLPEPGXqXopQETriHiXNX0NAD9EAiIOz87OvuN9Ejdoz/NuE9EBG+ROs9n8qgiH06Lb7b4PAF8yHzaazebE7EpDqQ65gIjX87mXH3LMy8vLo6Q+iYHV6/U+APRZ09ok/U6ns7q3t7eSZDeC53kVz/NuHhwcxPJFIlpn4vH29vYwyW5aEsy/0HqcUqfT+QQRf9Va/+553t04vQjdbvcWEf1JRA+Hw+H3E1T5x0ycLYCUgSEiT8fl3d3dxRi9WvSbiF5PsktEr0FIlono9s7Ozhhx7vV6ywBQZk3FBUZEP3N5fn4+Lh15iryQZBcRX+Ryu92+kDpBEFhjSV/ikDYw6ysh4ssxqvyg6JxVYYfrOA+ZQRBYYyHiwyS7ACkDK5VK0tiNGFXu3HKSXSKqxPQdQSllVURjTHGpWKvVTsXAzlRExBMue55Xcekx8OBPYnT4jJ2mvT7IcjXAv5QzFY0x51z2fX9iOopUdJZwIuJjpUpDgAyBicq44qqMSqlT0bQyySYR8QIj+0Yzzmc9VRoCZAhMVqO5ublVqYOIVpporWNnbG9vryya+lKHiGRF/C2Vs5A/FUEpNbbOfN+X+T9pjVmBEdG5VBBpCEqpQ6kTh9SBGWMkZ7w5ZkwpWQCei7Ontbb2OUQ8ljoOXlp8YOHRmy/wsRkrlUpWARDFwYI4GgEiuooHH6Mf8tZUyHphytNxLLBwWxhBFAcL4f3FCL7vu5we8VJRvBKRNTBufM3F7cAuArJAcFjrr1QqWR8lLC48+OkFFgSBVRnL5bJro+YpFRuYTEWt9VDIlm05dhIyBaa1TqyMAHDMfsfSKqWUdcVXrVatwiM5IgA8TudlaD+LMoxvkBNnTM6KwEQCLDmig69ORKbA6vX6Efz/nhUN7iLDozWGiLHFg4j4bLr4H/9oA1mYkpD5GQkRJ1ZGENTIwTAiO7x4uAgwT8XUVCpCnvex0SBEtCbvKhwMwhmYSFOrcIQ8dCWS057BODIHZozhF5Ol8/Nza9bk0UUyDIYV9tuaZXlCT3tq5sgcmNbaqk6SqEoG4SogjpOBtTnLE7o8wafBk64xIKLrQj4V+mMlf3Fx0UrPIAjOhMoN8f/TD2xhYeEIAPxIll83JMujyqm1Hlsf1Wr1hFEkHxHvCxV+JBrKJ6I0yBzY5uamP6kytlqtgVJqg4juAMArtVrNufD7/f6GMWbTGPOS47o68z2iRN7X+iMIy7FcYwAAW1tbh5DA7cKrtgeyPeSf3GYmjhgh159DBEHwiInXPM+beO2dBQ7++cipmIBcgTlOsoUF5uCfV5eKvu8/1lqPZCL6sNvtNvPYkhAPELlKPUDOwAaDwdHS0hJvuhX+e2IgWk92F81mMxOrj5ArFdvt9gUiPsjTNyNyj5H7b6mCIHgv3H8S36pyYIiI97XW7SnYnmGGGQrAf9xT7c/9boaZAAAAAElFTkSuQmCC"}}]);
//# sourceMappingURL=4820.5e1b8d86.js.map