"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[9323],{66021:function(t,i,e){e.r(i),e.d(i,{default:function(){return v}});var s=function(){var t=this,i=t._self._c;return i("div",{staticClass:"g-wrapper"},[i("c-header",[i("div",{attrs:{slot:"headerLeft"},slot:"headerLeft"},[i("a",{staticClass:"header-back-btn",on:{click:function(i){return t.back()}}},[i("img",{attrs:{src:e(88579)}})])]),t._v(" 活动详情 "),[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showadd,expression:"showadd"}],staticClass:"btn-group",attrs:{slot:"headerRight"},slot:"headerRight"},[i("img",{attrs:{src:e(57501)},on:{click:function(i){t.addconfig.show=!0}}})])]],2),i("add-group",{attrs:{config:t.addconfig,"data-list":t.addlist},on:{confirm:t.addselect}}),i("i",{directives:[{name:"show",rawName:"v-show",value:t.code,expression:"code"}],staticClass:"shade"}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.code,expression:"code"}],staticClass:"codecontent",on:{click:t.closecode}},[i("div",{attrs:{id:"code"}})]),i("div",{staticClass:"g-main"},[i("div",{staticClass:"teachingPlan-detail"},[i("div",{staticClass:"topDetail"},[i("p",{staticClass:"theme"},[i("span",{staticClass:"title"},[t._v(t._s(t.detail.theme))]),i("span",{staticClass:"typeTips"},[t._v(t._s(t.detail.typename))])]),i("p",{staticClass:"info"},[i("span",[t._v(t._s(t.detail.speakers)+"  |  ")]),i("span",[t._v(t._s(t.detail.actionlevelname)+"  |  ")]),i("span",[t._v(t._s(t.detail.showofficename))])])]),i("div",{staticClass:"baseInfo activeTime"},[i("div",{staticClass:"title"},[t._m(0),i("span",{staticClass:"detailBtn",on:{click:function(i){return t.toshowlist(2)}}},[t._v("查看详情")])]),i("p",{staticClass:"address"},[t._v("活动地点："+t._s(t.detail.place))]),i("p",[t._v("参与人员："+t._s(t.detail.attendercount)+"人")])]),i("div",{staticClass:"activeTime"},[i("div",{staticClass:"title"},[t._m(1),i("span",{staticClass:"detailBtn",on:{click:t.checkTime}},[t._v("查看详情")])]),t.detail.showTime&&t.detail.showTime.length>0?i("div",{staticClass:"timeBox"},t._l(t.detail.showTime,(function(e,s){return i("div",{key:t.indx,staticClass:"boxItem"},[i("p",[t._v(t._s(e.date))]),i("p",[t._v(t._s(e.startTime)+"-"+t._s(e.endTime))])])})),0):t._e()]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.detail.remark,expression:"detail.remark"}],staticClass:"baseInfo psinfo"},[t._m(2),i("p",[t._v(t._s(t.detail.remark))])]),t.detail.fileuploadlist&&t.detail.fileuploadlist.length>0?i("div",{staticClass:"baseInfo psinfo otherFils"},[t._m(3),t._l(t.detail.fileuploadlist,(function(e,s){return i("p",{staticClass:"otherItem",on:{click:function(i){return t.dowmload(t.fdfsurl+"/"+e.fileurl,e.filename)}}},[t._v(t._s(e.filename))])}))],2):t._e(),t.videolist.length>0?i("div",{staticClass:"baseInfo psinfo otherFils"},[t._m(4),t._l(t.videolist,(function(e,s){return i("a",{staticClass:"otherItem",attrs:{target:"_blank",href:"javascript:void(0)"},on:{click:function(i){return t.vedioOpen(e)}}},[t._v(t._s(e.filename))])}))],2):t._e()])]),i("van-dialog",{attrs:{title:t.dialogTitle,className:"timeDialog-detail"},model:{value:t.showTime,callback:function(i){t.showTime=i},expression:"showTime"}},[i("van-steps",{staticClass:"detailTime",attrs:{direction:"vertical",active:-1}},[t.pastTime.length>1?i("van-step",[i("p",{staticClass:"pastTime"},[i("span",[t._v(t._s(t.pastTime.length)+"个已过时段")]),t.isShowDetail?i("span",{staticClass:"actionBtn",on:{click:t.toggleArrow}},[t._v("收起"),i("van-icon",{attrs:{name:"arrow-up",color:"#2F7DCD",size:"15px"}})],1):i("span",{staticClass:"actionBtn",on:{click:t.toggleArrow}},[t._v("展开"),i("van-icon",{attrs:{name:"arrow-down",color:"#2F7DCD",size:"15px"}})],1)]),t.isShowDetail?i("div",{staticClass:"pastBox"},t._l(t.pastTime,(function(e,s){return i("p",{key:t.indx},[t._v(t._s(e.dateStr))])})),0):t._e()]):t._e(),1==t.pastTime.length?i("van-step",[i("p",[t._v(t._s(t.pastTime[0].dateStr))])]):t._e(),t._l(t.currentTime,(function(s,a){return i("van-step",{key:t.indx},[i("p",{class:0==a?"firstItem":""},[0==a?i("img",{staticClass:"timeicon",attrs:{src:e(43368),width:"18"}}):t._e(),i("span",[t._v(t._s(s.dateStr))])])])}))],2)],1),i("c-modal",{attrs:{config:t.showdetail}},[i("div",{staticClass:"flex-item class-sel-list"},[i("div",{staticClass:"list info-list list-inner"},[i("ul",{staticClass:"doctorupdata"},t._l(t.showlist,(function(e,s){return i("li",[i("span",[t._v(" "+t._s(e.name)+" "),e.username?i("span",[t._v("-"+t._s(e.username))]):t._e(),e.count?i("span",[t._v("("+t._s(e.count)+"人)")]):t._e()])])})),0)])])])],1)},a=[function(){var t=this,i=t._self._c;return i("div",{staticClass:"left"},[i("img",{attrs:{src:e(24233)}}),i("span",[t._v("基本信息")])])},function(){var t=this,i=t._self._c;return i("div",{staticClass:"left"},[i("img",{attrs:{src:e(41417)}}),i("span",[t._v("活动时间")])])},function(){var t=this,i=t._self._c;return i("div",{staticClass:"title"},[i("img",{attrs:{src:e(96369)}}),i("span",[t._v("备注")])])},function(){var t=this,i=t._self._c;return i("div",{staticClass:"title"},[i("img",{attrs:{src:e(52151)}}),i("span",[t._v("附件")])])},function(){var t=this,i=t._self._c;return i("div",{staticClass:"title"},[i("img",{attrs:{src:e(38373)}}),i("span",[t._v("视频")])])}],o=(e(70560),e(68934)),l=e(22760),n=e(77387),d=e.n(n),r=e(85965),c=e(93830),u=e(63822),h={data(){return{isShowDetail:!1,pastTime:[],currentTime:[],dialogTitle:"",showTime:!1,showadd:!1,code:!1,detailid:"",detail:"",fdfsurl:"",showlist:[],showdetail:{show:!1,title:"查看主讲人",hideOnClickOut:!0},addconfig:{show:!1,label:"name",fixedtop:".8rem",fixedright:".1rem"},addlist:[{name:"编辑",key:"editflag",router:"fdAction_edit",isused:!1},{name:"二维码",key:"ercode",isused:!1},{name:"记录",key:"statistics",router:"fdAction_census",isused:!1},{name:"反馈",key:"evaluate",router:"fdAction_tickling",isused:!1}],videofdfsurl:"",videolist:[]}},components:{cHeader:l.Z,addGroup:r.Z,cModal:c.Z},computed:{},watch:{},filters:{levelname:function(t){return"hospital"==t?"医院":"base"==t?"基地":"科室"},name:function(t){return"base"==t?"正在该基地轮转的学员":"trun"==t?"专业在该基地的学员":""}},created(){this.detailid=this.$route.query.id},mounted(){let t=this;this.initcodelist(),this.$nextTick((function(){e(94492)})),this.registerToNative("goBack",(function(i){t.back()}))},methods:{...o.Z,...(0,u.nv)(["showAlert","showConfirm","showLoading","hideLoading","toast"]),toggleArrow(){this.isShowDetail=!this.isShowDetail},initvideo(){this.post("/actionplan/getuploadpicinfo",{command:"actionplan/getuploadpicinfo",sessionid:d().cookie("sid"),loginid:d().cookie("uid"),actionplanid:this.detailid,searchflag:1}).done((t=>{this.videolist=t.bean.piclist?t.bean.piclist:[],this.videolist=this.videolist.filter((t=>7==t.type)),this.videofdfsurl=t.fdfsurl}))},vedioOpen(t){this.invokeNative("OpenDocument",{url:this.videofdfsurl+t.fileurl,filename:t.filename})},initcodelist(){let t=this;this.post("/actionplanbase/getjurisdictionbycoode",{command:"actionplanbase/getjurisdictionbycoode",sessionid:d().cookie("sid"),loginid:d().cookie("uid"),beanlist:[{uid:d().cookie("uid"),jurisdiccode:"ercode",id:t.detailid},{uid:d().cookie("uid"),jurisdiccode:"statistics",id:t.detailid},{uid:d().cookie("uid"),jurisdiccode:"evaluate",id:t.detailid}]}).done((i=>{i&&0==i.errcode?(i.jurisdiclist.map((i=>{t.addlist.map((t=>{i.jurisdiccode==t.key&&(t.isused=i.jurisdicvalue)}))})),this.init()):i.errdesc?t.toast(i.errdesc):t.toast("服务器错误，请联系管理员。")}))},checkTime(){this.showTime=!0,this.detail.actiontime.forEach((t=>{let i=t.date.split("-"),e=t.startTime.split(":").slice(0,2).join(":"),s=t.endTime.split(":").slice(0,2).join(":");t.dateStr=i[0]+"月"+i[1]+"日 "+e+"-"+s})),this.pastTime=this.detail.actiontime.filter((t=>t.subtract<=0)).sort(((t,i)=>t.subtract-i.subtract)),this.currentTime=this.detail.actiontime.filter((t=>t.subtract>0)).sort(((t,i)=>t.subtract-i.subtract)),console.log(this.pastTime,this.currentTime,"----"),this.dialogTitle=this.detail.theme},init(){let t=this;this.post("/actionplan/getactionplandetail",{command:"actionplan/getactionplandetail",sessionid:d().cookie("sid"),loginid:d().cookie("uid"),uid:d().cookie("uid"),actionplanid:t.detailid,clientflag:1}).done((i=>{t.addlist[0].isused=i.bean.editflag;for(let o=0;o<t.addlist.length;o++)if(1==t.addlist[o].isused){t.showadd=!0;break}i.bean.actiontime=JSON.parse(i.bean.actiontime),console.log(i.bean.actiontime);let e=[],s=(new Date).getTime();i.bean.actiontime.forEach((t=>{let i=t.date.replace(/-/g,"/");console.log(t,"---");let a=new Date(i+" "+t.endTime).getTime(),o=Number(a)-Number(s),l=t.date.split("-");t.date=l[1]+"-"+l[2],t.startTime=t.startTime.split(":").slice(0,2).join(":"),t.endTime=t.endTime.split(":").slice(0,2).join(":"),t.subtract=o,e.push({subtract:o,...t})}));let a=[];i.bean.speakerlist.forEach((t=>{a.push(t.uname)})),i.bean.fileuploadlist=i.bean.fileuploadlist.filter((t=>1==t.type)),i.bean.speakers=a.join("、"),i.bean.showTime=e.filter((t=>t.subtract>0)).sort(((t,i)=>t.subtract-i.subtract)),i.bean.showTime.length>3&&(i.bean.showTime=i.bean.showTime.slice(0,2)),t.detail=i.bean,t.fdfsurl=i.fdfsurl})),this.initvideo()},update(){let t=this;this.$router.push({name:"fdAction_edit",query:{id:t.$route.query.id,ishistory:t.$route.query.ishistory,isOverseer:t.$route.query.isOverseer,grade:t.$route.query.grade}})},toshowlist(t){this.showlist=[],1==t?(this.showdetail.title="查看主讲人",this.detail.speakerlist.map((t=>{this.showlist.push({name:t.uname,username:t.username,id:t.uid})}))):(this.showdetail.title="查看参与人员",this.detail.attendinfolist.map((t=>{1==t.type?this.showlist.push({name:t.attendbusinfo.split("-")[0],count:t.attendbusinfo.split("-")[1],type:t.type,id:t.attendbusid}):this.showlist.push({name:t.attendbusinfo,type:t.type,id:t.attendbusid})}))),this.showdetail.show=!0},census(){let t=this;console.log(123141414),this.$router.push({name:"fdAction_census",query:{id:t.detail.id,ishistory:t.$route.query.ishistory,status:t.detail.status,isOverseer:!0,grade:t.$route.query.grade}})},qrcode(){let t=this,i=JSON.stringify({type:10,actionplanid:this.detail.id});d()("#code").qrcode({text:i,width:200,height:200}),t.code=!0},closecode(){this.code=!1,d()("#code").html("")},torecord(){let t=this;t.post("/turnevaluate/validateEvaluate",{command:"turnevaluate/validateEvaluate",sessionid:d().cookie("sid"),loginid:d().cookie("uid"),uid:d().cookie("uid"),businessid:t.detailid,type:6}).done((function(i){i&&0==i.errcode?t.$router.push({name:"fdAction_tickling",query:{id:t.detailid,ishistory:t.$route.query.ishistory}}):400102==i.errcode?t.$router.push({name:"fdAction_tickling",query:{id:t.detailid,ishistory:t.$route.query.ishistory,from:!0}}):t.toast(i.errdesc)}))},dowmload(t,i){this.invokeNative("OpenDocument",{url:t,filename:i})},addselect(t){let i=this;this.addconfig.show=!1,"ercode"==t.key?i.qrcode():"editflag"==t.key?i.update(t.router):"statistics"==t.key?i.census(t.router):"evaluate"==t.key&&i.torecord(t.router)},back(){let t=this;t.$route.query.grade?t.$router.push({name:"grade"}):t.$router.push({name:"couple_back"})}}},p=h,m=e(1001),f=(0,m.Z)(p,s,a,!1,null,"1c2a665c",null),v=f.exports}}]);
//# sourceMappingURL=9323.835de2d1.js.map