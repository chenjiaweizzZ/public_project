"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[678],{62266:function(e,t,s){s.d(t,{Z:function(){return r}});var i=function(){var e=this,t=e._self._c;return t("transition",{attrs:{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.config.show,expression:"config.show"}],attrs:{id:"picker"}},[t("div",{attrs:{id:"picker-main"}},[t("header",[t("span",{on:{click:e.cancle}},[e._v("取消")]),t("span",{class:{noclick:e.isdisabled},on:{click:e.sure}},[e._v("确定")])]),t("section",[t("div",{staticClass:"on"}),t("ul",{style:e.style,on:{touchstart:function(t){return t.preventDefault(),e.start.apply(null,arguments)},touchmove:function(t){return t.preventDefault(),e.move.apply(null,arguments)},touchend:function(t){return t.preventDefault(),e.end.apply(null,arguments)}}},e._l(e.list,(function(s,i){return t("li",{domProps:{innerHTML:e._s(s.txt)}})})),0)])])])])},a=[],l=(s(70560),{name:"picker",props:{config:{default:function(){return{show:!1,mainlist:{type:Array,default:[]},defaultVal:[String,Number],valueKey:{type:[Function,String],default:"name"}}}}},data(){return{isdisabled:!1,activeItem:0,itemLength:0,activeItemValue:0,curVal:"",style:{},Y:0,t:.1,touchStartTime:0,touchEndTime:0,eY:45,sY:90,itemHeight:45}},watch:{"config.mainlist":function(e,t){e!==t&&(this.activeItem=0,this.Y=0,this.eY=45,this.sY=90,this.style={transform:"translate3d(0px, "+this.sY+"px, 0px)",transition:"all ease "+this.t+"s"})}},filters:{},computed:{list(){let e=[],t=typeof this.config.valueKey;return 0==this.config.mainlist.length?(this.isdisabled=!0,this.config.mainlist=[{name:"暂无数据"}],this.config.mainlist.map((e=>{e.txt=e.name}))):(this.isdisabled=!1,this.config.mainlist.map((s=>{if("string"===t)s.txt=s[this.config.valueKey],e.push(s);else if("function"===t){let t=this.config.valueKey(s);s.txt=t,e.push(s)}}))),this.curVal=e[this.activeItem],this.itemLength=e.length,e}},mounted(){this.config.defaultVal?this.moveTo():this.style={transform:"translate3d(0px, "+this.sY+"px, 0px)",transition:"all ease "+this.t+"s"}},methods:{moveTo(e){this.list.map(((t,s)=>{t==(e||this.config.defaultVal)&&(this.activeItem=s,this.activeItemValue=t)})),this.Y=45*this.activeItem,this.eY=45*this.activeItem,this.style={transform:"translate3d(0px, "+this.Y+"px, 0px)",transition:"all ease "+this.t+"s"}},start(e){this.sY=e.touches[0].clientY,this.touchStartTime=e.timeStamp},move(e){this.Y=this.eY+e.touches[0].clientY-this.sY,this.t=.1,this.style={transform:"translate3d(0, "+this.Y+"px, 0)",transition:"all ease "+this.t+"s"}},end(e){let t=90,s=-45*(this.itemLength-1)+t;if(this.eY=this.Y,this.touchEndTime=e.timeStamp-this.touchStartTime,this.t=.1,this.sY==e.changedTouches[0].clientY)return;Math.abs(this.eY%45)<=22.5?this.eY=45*parseInt(this.eY/45):this.eY>0?this.eY=45*parseInt(this.eY/45)+45:this.eY=45*parseInt(this.eY/45)-45,this.eY>t&&(this.Y=0,this.eY=90,this.activeItem=0),this.eY<=s&&(this.Y=s,this.eY=s,this.activeItem=this.itemLength-1),this.style={transform:"translate3d(0, "+this.eY+"px, 0)",transition:"all ease "+this.t+"s"};let i=Math.abs((this.eY-t)/45);this.activeItem=Math.round(i),this.curVal=this.list[this.activeItem],this.$emit("changeCurVal",this.type,this.curVal)},cancle(){this.config.show=!1},sure(){this.$emit("confirm",this.curVal)}}}),n=l,o=s(1001),c=(0,o.Z)(n,i,a,!1,null,"e3fc68ee",null),r=c.exports},30908:function(e,t,s){s.d(t,{Z:function(){return r}});var i=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.btn.active,expression:"btn.active"}]},[e._t("default")],2)},a=[],l={props:{defaultCls:{type:String,default:"tab"},title:{type:String,require:!0},active:{type:Boolean,default:!1},className:{type:String,default:""},data:{},bus:{}},data(){return{btn:{title:"",active:!1}}},watch:{title:function(e){this.btn.title=e}},created(){this.btn.title=this.title,this.btn.active=!!this.active,this.btn.data=this.data},mounted(){this.bus.$emit("addtabbtn",this.btn)},computed:{}},n=l,o=s(1001),c=(0,o.Z)(n,i,a,!1,null,null,null),r=c.exports},53003:function(e,t,s){s.d(t,{Z:function(){return h}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tabs-container",class:{"g-wrapper":"pin"===e.mode}},[t("div",{staticClass:"tabs",class:e.className},e._l(e.tabBtns,(function(s,i){return t("div",{staticClass:"tab",class:{active:s.active},attrs:{tapmode:""},on:{click:function(t){return e.activeTab(i)}}},[t("label",[e._v(e._s(s.title))]),i<=0?[t("div",{staticClass:"tab-current-bg"})]:e._e()],2)})),0),t("div",{staticClass:"tabs-content",class:e.contentclass},[e._t("default")],2)])},a=[],l=(s(70560),s(77387)),n=s.n(l),o={props:{active:{type:Number,default:0},type:{type:String,require:!0},shape:{type:String,default:""},className:{type:String,default:""},contentClassName:{type:String,default:""},bus:{},mode:{type:String,default:""}},data(){return{tabBtns:[],activeSS:this.active}},events:{},computed:{contentclass:function(){return this.contentClassName+" "+("pin"===this.mode?"g-main":"")}},components:{},created(){let e=!0;this.bus.$on("addtabbtn",(t=>{this.tabBtns.push(t);for(let e=0;e<this.tabBtns.length;e++)this.tabBtns[e].active&&(this.activeSS=e);e&&0===this.activeSS&&(e=!1,this.$emit("change-tab",this.tabBtns[0])),this.$nextTick((function(){this.moveBg(this.activeSS)}))}))},mounted(){},watch:{activeSS:function(e,t){console.log(e,789),this.moveBg(e),this.$emit("change-tab",this.tabBtns[e])}},methods:{activeTab:function(e){this.activeSS=e;for(let t=0;t<this.tabBtns.length;t++)this.tabBtns[t].active=e===t},moveBg(e){let t=n()(this.$el),s=t.find(".tabs"),i=s.find(`.tab:eq(${e})`),a=s.find(".tab-current-bg"),l=i.find("label"),o=a.closest(".tab").offset(),c=l.offset(),r=(c&&c.left||0)-(o&&o.left||0);a.css({width:l.outerWidth(),"-webkit-transform":"translate3d("+r+"px,0,0)",transform:"translate3d("+r+"px,0,0)"})}}},c=o,r=s(1001),d=(0,r.Z)(c,i,a,!1,null,null,null),h=d.exports},92463:function(e,t,s){s.r(t),s.d(t,{default:function(){return _}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"g-wrapper new-add-active"},[t("c-header",[t("div",{attrs:{slot:"headerLeft"},slot:"headerLeft"},[t("a",{staticClass:"header-back-btn",on:{click:function(t){return e.back()}}},[t("img",{attrs:{src:s(88579)}})])]),e._v("新增教学活动计划 ")]),t("div",{staticClass:"g-main"},[t("div",{staticClass:"self-form-add"},[t("div",{staticClass:"whiteCol"},[t("div",{staticClass:"selectRdaio"},[t("span",[e._v("活动级别")]),t("el-radio-group",{staticClass:"selfRdaio",model:{value:e.levelcode,callback:function(t){e.levelcode=t},expression:"levelcode"}},e._l(e.levellist,(function(s,i){return t("el-radio",{key:i,attrs:{label:s.levelcode,name:s.levelcode,disabled:0==s.levelvalue},nativeOn:{click:function(t){return e.selectlevel(s,t)}}},[e._v(e._s(s.levelname))])})),1)],1)]),t("van-cell",{class:"请选择"==e.form.dept?"":"weightCol",attrs:{title:e.levelname,value:e.form.dept,"is-link":"",size:"large"},on:{click:e.sellevel}}),t("div",{staticClass:"margin-gap"},[t("van-field",{attrs:{label:"活动主题",placeholder:"请输入",size:"large","input-align":"right",maxlength:"120"},model:{value:e.form.theme,callback:function(t){e.$set(e.form,"theme",t)},expression:"form.theme"}}),t("van-cell",{class:"请选择"==e.form.type?"":"weightCol",attrs:{title:"活动类型",value:e.form.type,"is-link":"",size:"large"},on:{click:function(t){e.seltype.show=!0}}})],1),e._l(e.timeArr,(function(i,a){return t("div",{key:a,staticClass:"margin-gap gap-time"},[t("van-cell",{attrs:{title:"活动时间"}},[t("img",{attrs:{src:s(54816)},on:{click:function(t){return e.deleteTime(a)}}})]),t("van-cell",{class:"请选择"==i.date?"":"weightCol",attrs:{title:"活动日期",value:i.date,"is-link":"",size:"large"},on:{click:function(t){return e.selectDate(a)}}}),t("van-cell",{class:"请选择"==i.startTime?"":"weightCol",attrs:{title:"开始时间",value:i.startTime,"is-link":"",size:"large"},on:{click:function(t){return e.selectTime(a,0)}}}),t("van-cell",{class:"请选择"==i.endTime?"":"weightCol",attrs:{title:"结束时间",value:i.endTime,"is-link":"",size:"large"},on:{click:function(t){return e.selectTime(a,1)}}})],1)})),t("div",{staticClass:"whiteCol"},[t("div",{staticClass:"addTime",on:{click:e.addTime}},[t("div",[e._v("添加活动时间")])])]),t("div",{staticClass:"margin-gap"},[e.periodShow?t("van-field",{attrs:{label:"学时",placeholder:"",size:"large","input-align":"right",maxlength:"512",readonly:""},model:{value:e.form.period,callback:function(t){e.$set(e.form,"period",t)},expression:"form.period"}}):e._e(),t("van-field",{attrs:{label:"活动地点",placeholder:"请输入",size:"large","input-align":"right",maxlength:"512"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),t("div",{staticClass:"margin-gap"},[t("van-cell",{class:"请选择"==e.form.speakers?"":"weightCol",attrs:{title:"主讲人/主持人",value:e.form.speakers,"is-link":"",size:"large"},on:{click:e.initteacher}}),t("van-cell",{class:"请选择"==e.form.student?"":"weightCol",attrs:{title:"参与人员",value:e.form.student,"is-link":"",size:"large"},on:{click:e.initstudent}})],1),t("div",{staticClass:"margin-gap bottom-gap"},[e._m(0),t("van-field",{attrs:{type:"textarea",placeholder:"请输入",autosize:e.autosize,maxlength:"100"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}},[t("template",{slot:"label"},[e._v(e._s(e.form.remark.length)+"/100")])],2)],1),t("div",{staticClass:"bottom"},[t("div",{staticClass:"submitBtn",on:{click:e.submit}},[e._v("提交")])]),t("van-popup",{attrs:{position:"bottom",overlay:""},model:{value:e.showDate,callback:function(t){e.showDate=t},expression:"showDate"}},[t("van-datetime-picker",{attrs:{type:"date","min-date":e.minDate},on:{confirm:e.closeDate,cancel:e.cancelDate},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),t("van-popup",{attrs:{position:"bottom",overlay:""},model:{value:e.showTime,callback:function(t){e.showTime=t},expression:"showTime"}},[t("van-datetime-picker",{attrs:{type:"time"},on:{confirm:e.closeTime,cancel:e.cancelTime},model:{value:e.selectTimePick,callback:function(t){e.selectTimePick=t},expression:"selectTimePick"}})],1)],2),t("c-modal",{attrs:{config:e.selectTeacher}},[t("div",{staticClass:"flex-item class-sel-list"},[t("div",{staticClass:"list info-list list-inner"},[t("ul",{staticClass:"doctorupdata"},e._l(e.teacher,(function(s,i){return t("li",[e._v(" "+e._s(s.name)+" "),s.username?[e._v("-"+e._s(s.username))]:e._e(),t("i",{staticClass:"deleteitem",on:{click:function(t){return e.deletedoctor(s.id,0)}}},[e._v("删 除")])],2)})),0)])])]),t("c-modal",{attrs:{config:e.selectDoctor}},[t("div",{staticClass:"flex-item class-sel-list"},[t("div",{staticClass:"list info-list list-inner"},[t("ul",{staticClass:"doctorupdata"},e._l(e.student,(function(s,i){return t("li",[t("span",[e._v(" "+e._s(s.name)+" "),s.username?[e._v("-"+e._s(s.username))]:e._e(),s.count?[e._v("("+e._s(s.count)+"人)")]:e._e()],2),1!==s.type?t("i",{staticClass:"deleteitem",on:{click:function(t){return e.deletedoctor(s.id,1,s.type)}}},[e._v("删 除")]):e._e()])})),0),"office"==e.surelevel.levelcode||"hospital"==e.surelevel.levelcode?[t("ul",{staticClass:"doctorupdata"},e._l(e.student_turndoctor,(function(s,i){return t("li",[t("span",[e._v(" "+e._s(s.name)+" "),s.username?[e._v("-"+e._s(s.username))]:e._e(),s.count?[e._v("("+e._s(s.count)+"人)")]:e._e()],2),1!==s.type?t("i",{staticClass:"deleteitem",on:{click:function(t){return e.deletedoctor(s.id,1,s.type)}}},[e._v("删 除")]):e._e()])})),0),t("ul",{staticClass:"doctorupdata"},e._l(e.student_trainee,(function(s,i){return t("li",[t("span",[e._v(" "+e._s(s.name)+" "),s.username?[e._v("-"+e._s(s.username))]:e._e(),s.count?[e._v("("+e._s(s.count)+"人)")]:e._e()],2),1!==s.type?t("i",{staticClass:"deleteitem",on:{click:function(t){return e.deletedoctor(s.id,1,s.type)}}},[e._v("删 除")]):e._e()])})),0)]:e._e()],2)])]),t("transition",{attrs:{"enter-active-class":"animated slideInRight","leave-active-class":"animated fadeOut"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.choiceteacher,expression:"choiceteacher"}],staticClass:"department g-wrapper"},[t("c-header",[t("div",{attrs:{slot:"headerLeft"},slot:"headerLeft"},[t("a",{staticClass:"header-back-btn",on:{click:function(t){e.choiceteacher=!1}}},[t("img",{attrs:{src:s(88579)}})])]),e._v("选择主讲人 "),t("div",{staticStyle:{"font-size":"0.3rem"},attrs:{slot:"headerRight"},on:{click:e.closeteacher},slot:"headerRight"},[e._v("确定")])]),t("div",{staticClass:"g-main"},[t("div",{staticClass:"search"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchname,expression:"searchname"}],attrs:{type:"text",placeholder:"搜索"},domProps:{value:e.searchname},on:{input:function(t){t.target.composing||(e.searchname=t.target.value)}}}),t("i",{on:{click:function(t){return e.searchteacher()}}})]),t("div",{staticClass:"flex-item class-sel-list",staticStyle:{"padding-bottom":"0.6rem"}},[t("div",{staticClass:"list info-list list-inner"},e._l(e.teacherlist,(function(s){return t("div",{staticClass:"item"},[t("label",{staticClass:"flex flex-start flex-row"},[t("div",{staticClass:"fitem"},[e._v(e._s(s.name)+"-"+e._s(s.username))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.teacher,expression:"teacher"}],staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(e.teacher)?e._i(e.teacher,s)>-1:e.teacher},on:{change:function(t){var i=e.teacher,a=t.target,l=!!a.checked;if(Array.isArray(i)){var n=s,o=e._i(i,n);a.checked?o<0&&(e.teacher=i.concat([n])):o>-1&&(e.teacher=i.slice(0,o).concat(i.slice(o+1)))}else e.teacher=l}}})])])})),0)])]),t("div",{staticClass:"result",on:{click:function(t){e.selectTeacher.show=!0}}},[t("p",[e._v("已选主讲人（"+e._s(e.teacher.length)+"）")])])],1)]),t("transition",{attrs:{"enter-active-class":"animated slideInRight","leave-active-class":"animated fadeOut"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.choicestudent,expression:"choicestudent"}],staticClass:"department g-wrapper"},[t("c-header",[t("div",{attrs:{slot:"headerLeft"},slot:"headerLeft"},[t("a",{staticClass:"header-back-btn",on:{click:function(t){e.choicestudent=!1}}},[t("img",{attrs:{src:s(88579)}})])]),e._v("选择参与人员 "),t("div",{staticStyle:{"font-size":"0.3rem"},attrs:{slot:"headerRight"},on:{click:function(t){return e.confirmselofficetrainee1(0)}},slot:"headerRight"},[e._v("确定")])]),t("div",{staticClass:"g-main"},["base"==e.surelevel.levelcode?[t("ul",e._l(e.basechecklist,(function(s,i){return t("li",{staticClass:"checkbase",class:{"checkbase-active":s.ischecked},on:{click:function(t){return e.checkbase(s)}}},[e._v(e._s(s.name)+"("+e._s(s.count)+"人)")])})),0)]:[t("ul",[t("li",{staticClass:"choice",on:{click:function(t){return e.initstudentlist("turndoctor")}}},[e._v("护培生")])])],t("c-modal",{attrs:{config:e.selhospital}},[t("div",{staticClass:"flex-item class-sel-list"},[t("div",{staticClass:"list info-list list-inner"},e._l(e.studentlist,(function(s){return t("div",{staticClass:"item"},[t("label",{staticClass:"flex flex-start flex-row"},[t("div",{staticClass:"fitem"},[e._v(" "+e._s(s.name)+" "),s.count?[e._v("("+e._s(s.count)+"人)")]:e._e()],2),t("input",{directives:[{name:"model",rawName:"v-model",value:e.student,expression:"student"}],staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(e.student)?e._i(e.student,s)>-1:e.student},on:{change:function(t){var i=e.student,a=t.target,l=!!a.checked;if(Array.isArray(i)){var n=s,o=e._i(i,n);a.checked?o<0&&(e.student=i.concat([n])):o>-1&&(e.student=i.slice(0,o).concat(i.slice(o+1)))}else e.student=l}}})])])})),0)]),t("template",{slot:"buttons"},[t("button",{staticClass:"btn",attrs:{type:"button"},on:{click:function(t){e.selhospital.show=!1}}},[e._v("确定")])])],2),t("c-modal",{attrs:{config:e.seloffice}},[t("div",{staticClass:"flex-item class-sel-list"},[t("div",{staticClass:"list info-list list-inner"},[t("div",{staticClass:"item",on:{click:function(t){return e.choiceall("turndoctor")}}},[t("label",{staticClass:"flex flex-start flex-row"},[t("div",{staticClass:"fitem"},[e._v("全部")]),t("input",{staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{checked:e.student_turndoctor.length==e.selofficelist.length}})])]),e._l(e.selofficelist,(function(s){return t("div",{staticClass:"item"},[t("label",{staticClass:"flex flex-start flex-row"},[t("div",{staticClass:"fitem"},[e._v(e._s(s.name)+"-"+e._s(s.username))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.student_turndoctor,expression:"student_turndoctor"}],staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(e.student_turndoctor)?e._i(e.student_turndoctor,s)>-1:e.student_turndoctor},on:{change:function(t){var i=e.student_turndoctor,a=t.target,l=!!a.checked;if(Array.isArray(i)){var n=s,o=e._i(i,n);a.checked?o<0&&(e.student_turndoctor=i.concat([n])):o>-1&&(e.student_turndoctor=i.slice(0,o).concat(i.slice(o+1)))}else e.student_turndoctor=l}}})])])}))],2)]),t("template",{slot:"buttons"},[t("button",{staticClass:"btn",attrs:{type:"button"},on:{click:function(t){return e.confirmselofficetrainee(0)}}},[e._v("确定")])])],2),t("c-modal",{attrs:{config:e.selofficetrainee}},[t("div",{staticClass:"flex-item class-sel-list"},[t("div",{staticClass:"list info-list list-inner"},[t("div",{staticClass:"item",on:{click:function(t){return e.choiceall("trainee")}}},[t("label",{staticClass:"flex flex-start flex-row"},[t("div",{staticClass:"fitem"},[e._v("全部")]),t("input",{staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{checked:e.student_trainee.length==e.selofficetraineelist.length}})])]),e._l(e.selofficetraineelist,(function(s){return t("div",{staticClass:"item"},[t("label",{staticClass:"flex flex-start flex-row"},[t("div",{staticClass:"fitem"},[e._v(e._s(s.name)+"-"+e._s(s.username))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.student_trainee,expression:"student_trainee"}],staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(e.student_trainee)?e._i(e.student_trainee,s)>-1:e.student_trainee},on:{change:function(t){var i=e.student_trainee,a=t.target,l=!!a.checked;if(Array.isArray(i)){var n=s,o=e._i(i,n);a.checked?o<0&&(e.student_trainee=i.concat([n])):o>-1&&(e.student_trainee=i.slice(0,o).concat(i.slice(o+1)))}else e.student_trainee=l}}})])])}))],2)]),t("template",{slot:"buttons"},[t("button",{staticClass:"btn",attrs:{type:"button"},on:{click:function(t){return e.confirmselofficetrainee(1)}}},[e._v("确定")])])],2),t("c-modal",{attrs:{config:e.searchconfig}},[t("div",{staticClass:"flex-item class-sel-list"},[t("div",{staticClass:"list info-list list-inner"},e._l(e.searchlist,(function(s){return t("div",{staticClass:"item"},[t("label",{staticClass:"flex flex-start flex-row"},[t("div",{staticClass:"fitem"},[e._v(e._s(s.name)+"-"+e._s(s.username))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchArr,expression:"searchArr"}],staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(e.searchArr)?e._i(e.searchArr,s)>-1:e.searchArr},on:{change:function(t){var i=e.searchArr,a=t.target,l=!!a.checked;if(Array.isArray(i)){var n=s,o=e._i(i,n);a.checked?o<0&&(e.searchArr=i.concat([n])):o>-1&&(e.searchArr=i.slice(0,o).concat(i.slice(o+1)))}else e.searchArr=l}}})])])})),0)]),t("template",{slot:"buttons"},[t("button",{staticClass:"btn",attrs:{type:"button"},on:{click:function(t){return e.confirmselofficetrainee1(1)}}},[e._v("确定")])])],2)],2),t("div",{staticClass:"result",on:{click:function(t){e.selectDoctor.show=!0}}},[t("p",[e._v(" 已选参与人 "),"office"==e.surelevel.levelcode||"hospital"==e.surelevel.levelcode?[e._v(" ("+e._s(Number(e.student.length)+Number(e.student_turndoctor.length)+Number(e.student_trainee.length))+") ")]:[e._v("("+e._s(e.newbasecount)+")")]],2)])],1)])],1),t("c-picker",{attrs:{config:e.seldept},on:{confirm:e.selectdept}}),t("c-picker",{attrs:{config:e.seltype},on:{confirm:e.selecttype}}),t("c-timepicker",{attrs:{config:e.getstarttime},on:{confirm:e.selectstarttime}}),t("c-timepicker",{attrs:{config:e.getendtime},on:{confirm:e.selectendtime}}),t("div",{staticClass:"rotationh"},[t("van-popup",{attrs:{"lazy-render":!1,"close-on-click-overlay":!1,position:"bottom"},model:{value:e.hospitalconfig.show,callback:function(t){e.$set(e.hospitalconfig,"show",t)},expression:"hospitalconfig.show"}},[t("van-picker",{ref:"hospital",attrs:{"show-toolbar":"",title:"请选择",columns:e.hospitalList,"value-key":"name","default-index":0},on:{confirm:e.hospitalonConfirm,cancel:e.hospitalonCancel}})],1)],1),t("div",{staticClass:"rotationh"},[t("van-popup",{attrs:{"lazy-render":!1,"close-on-click-overlay":!1,position:"bottom"},model:{value:e.popShow,callback:function(t){e.popShow=t},expression:"popShow"}},[t("van-picker",{ref:"pick",attrs:{"show-toolbar":"",title:"请选择",columns:e.columnsc,"value-key":"name"},on:{confirm:e.onConfirm,cancel:e.onCancel}})],1)],1),t("div",{staticClass:"rotationc"},[t("van-popup",{attrs:{"lazy-render":!1,"close-on-click-overlay":!1,position:"bottom"},model:{value:e.popShow2,callback:function(t){e.popShow2=t},expression:"popShow2"}},[t("van-nav-bar",{attrs:{title:"请选择","left-text":"取消","right-text":"确定","left-arrow":""},on:{"click-left":e.onClickLeft,"click-right":e.onClickRight}}),t("van-toast"),t("div",{staticClass:"popCK"},[t("div",{staticClass:"popCBox"},[t("van-sidebar",{on:{change:e.onChange},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},e._l(e.columns,(function(e,s){return t("van-sidebar-item",{key:s,attrs:{title:e.name}})})),1)],1),t("div",{staticClass:"popKBox"},[t("el-tree",{ref:"tree",attrs:{"show-checkbox":"","check-strictly":!0,data:e.treeList,props:e.defaultProps,"node-key":"id","default-checked-keys":e.deptnameidList,"default-expanded-keys":e.deptnameidList},on:{"check-change":e.checkClick,check:e.changetree}})],1)])],1)],1)],1)},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"otherInfo"},[t("span",[e._v("备注")])])}],l=(s(70560),s(88848)),n=s(3032),o=s(36797),c=s.n(o),r=s(68934),d=s(22760),h=s(93830),u=s(30908),p=s(53003),m=s(49931),f=s(62266),v=s(63822);s(8499);let g=new n["default"];var b={components:{cHeader:d.Z,cModal:h.Z,cTab:u.Z,cTabs:p.Z,cTimepicker:m.Z,cPicker:f.Z},data(){return{searchFlag:!0,searchArr:[],levelcode:"",bus:g,searchConfig:{id:0,pid:0},data:"",hosIdByDeptSave:0,hosIdByDept:0,levellist:[],levelname:"科室",surelevel:"",hospitallist:"",selectlevels:"",baselist:"",officelist:"",isstutype:"grade",getstarttime:{show:!1,istime:!0,isday:!0},getendtime:{show:!1,istime:!0,isday:!0},seldept:{show:!1,mainlist:[],valueKey:function(e){return e.deptname||e.name}},seltype:{show:!1,mainlist:[],valueKey:"name"},selhospital:{show:!1,title:"选择参与人员",hideOnClickOut:!0},isallseloffice:!1,isallselofficetrainee:!1,student_turndoctor:[],student_trainee:[],selofficelist:[],selofficetraineelist:[],seloffice:{show:!1,title:"选择住院医",hideOnClickOut:!0},selofficetrainee:{show:!1,title:"选择实习生",hideOnClickOut:!0},searchname:"",studentname:"",choiceteacher:!1,choicestudent:!1,theme:"",starttime:"",endtime:"",typename:"",placename:"",teacher:[],student:[],remark:"",teacherlist:[],studentlist:[],selectDoctor:{show:!1,title:"已选参与人员"},selectTeacher:{show:!1,title:"已选主讲人"},selectStudent:{show:!1,title:"选择参与人员"},typelist:"",technicallist:[],gradelist:[],stutypelist:[],basechecklist:[{name:"专业在该基地的学员",id:"",attendbusinfo:"base",type:1,count:"",ischecked:!1}],isCheckedAll_a:!1,isCheckedAll_b:!1,searchconfig:{show:!1,title:"选择搜索的参与人员"},searchlist:[],hospitalbusidlist:"",hospitalattend:"",hos_grade_list:[],hos_stutype_list:[],hos_base_list:[],hos_list:[],allGrade:!1,allStutype:!1,allBase:!1,oneGrade:[],oneStutype:[],oneBase:[],gradesubmitlist:[],stutypesubmitlist:[],basesubmitlist:[],hospitalcount:"",hossubmitlist:{},newbasecount:"",inittranieelist:"",date:"",timeFlag:0,showTime:!1,selectTimePick:"",currentIndex:"",minDate:new Date,showDate:!1,level:"",timeArr:[{date:"请选择",startTime:"请选择",endTime:"请选择"}],form:{dept:"请选择",theme:"",type:"请选择",address:"",speakers:"请选择",remark:"",student:"请选择",period:""},periodShow:!1,autosize:{maxHeight:60,minHeight:60},hospitalconfig:{show:!1},baseconfig:{show:!1},deptconfig:{show:!1},indexList:[0,0,0],columnsc:[],popShow:!1,popShow2:!1,columns:[],oriactiveKey:"",activeKey:"",treeList:[],defaultProps:{children:"childrens",label:"name",disabled:function(e,t){return 1!=e.havePermission}},orideptnameidList:[],deptnameidList:[],hospitalList:[],teachingActionPlanPeriodSetList:[]}},computed:{},watch:{surelevel:function(e){e&&(this.teacherlist=[],this.studentlist=[],this.teacher=[],this.student=[])},teacher:function(e){0==e.length&&(this.selectTeacher.show=!1)},student:function(e){0==e.length&&(this.selectDoctor.show=!1)},"selectlevels.id":function(e,t){e!=t&&"office"==this.surelevel.levelcode&&this.checkalltrainee()},"typename.name":function(e,t){e!=t&&this.checkalltrainee()}},created(){},mounted(){var e=this;this.initgrade(),this.initstutype(),this.initalldept(),this.inittypelist(),this.inithospitalgradelist(),this.inithospitalstudentlist(),this.inithospitalbaselist(),this.registerToNative("goBack",(function(t){e.back()})),this.hospitalresult(),this.initisgettrainee(),this.getTree(),this.getPeriodSetList()},methods:{...(0,v.nv)(["showAlert","showConfirm","showLoading","hideLoading","toast"]),...r.Z,cancelTime(){this.showTime=!1},confirmselofficetrainee1(e){if(!this.searchFlag)return;this.searchFlag=!1;let t=[];if(1==e)if("base"==this.surelevel.levelcode)this.searchArr.forEach((e=>{let t=!0;this.student.forEach((s=>{s.id==e.id&&(t=!1)})),t&&(e.type=0,this.student.push(e))}));else{let e=this.student_trainee.concat(this.student_turndoctor);this.searchArr.forEach((t=>{let s=!0;e.forEach((e=>{e.id==t.id&&(s=!1)})),s&&(t.type=3,this.student_trainee.push(t))}))}"office"==this.surelevel.levelcode||"hospital"==this.surelevel.levelcode?(this.student_turndoctor.forEach((e=>{let s=e.name;t.push(s)})),this.student_trainee.forEach((e=>{let s=e.name;t.push(s)}))):"base"==this.surelevel.levelcode&&this.student.forEach((e=>{let s="";s=e.count?e.name+"-"+e.count+"人":e.name,t.push(s)})),this.searchFlag=!0,1==e?this.searchconfig.show=!1:(this.form.student=0==t.length?"请选择":t.join("、"),this.choicestudent=!1)},confirmselofficetrainee(e){let t=[];console.log(this.surelevel.levelcode),"base"==this.surelevel.levelcode?this.student.forEach((e=>{let s=e.name+"-"+val.count+"人";t.push(s)})):(this.student_turndoctor.forEach((e=>{let s=e.name;t.push(s)})),this.student_trainee.forEach((e=>{let s=e.name;t.push(s)}))),this.form.student=0==t.length?"请选择":t.join("、"),0==e?this.seloffice.show=!1:this.selofficetrainee.show=!1},closeTime(e){let t=this.timeArr[this.currentIndex];if(this.showTime=!1,0==this.timeFlag?t.startTime=e:t.endTime=e,"请选择"!=t.startTime&&"请选择"!=t.endTime){let e=t.startTime.split(":"),s=t.endTime.split(":");(Number(e[0])>Number(s[0])||Number(s[0])==Number(e[0])&&Number(e[1])>Number(s[1]))&&(t.endTime="",this.toast("开始时间不得大于结束时间！"))}if(""!=t.date&&void 0!=t.date){let s=t.date.replace(/-/g,"/");0==this.timeFlag&&(t.start=e?new Date(s+" "+e).getTime():""),1==this.timeFlag&&(t.end=e?new Date(s+" "+e).getTime():"")}this.timeArr.splice(this.currentIndex,1,t)},selectTime(e,t){this.currentIndex=e,this.timeFlag=t,this.showTime=!0},cancelDate(){this.showDate=!1},closeDate(e){console.log(e,"----"),this.showDate=!1;let t=this.timeArr[this.currentIndex];if(t.date=c()(e.getTime()).format("YYYY-MM-DD"),void 0==e||""==e)t.start="",t.end="";else{let e=t.date.replace(/-/g,"/");""!=t.startTime&&"请选择"!=t.startTime&&(t.start=new Date(e+" "+t.startTime).getTime()),""!=t.endTime&&"请选择"!=t.endTime&&(t.end=new Date(e+" "+t.endTime).getTime())}console.log(t,"current"),this.timeArr.splice(this.currentIndex,1,t)},selectDate(e){this.showDate=!0,this.currentIndex=e},deleteTime(e){if(1==this.timeArr.length)return!1;this.timeArr.splice(e,1)},addTime(){this.timeArr.push({date:"请选择",startTime:"请选择",endTime:"请选择",start:"",end:""})},initisgettrainee(){this.post("/actionplanbase/getautocheckteachtype",{command:"actionplanbase/getautocheckteachtype",sessionid:$.cookie("sid"),loginid:$.cookie("uid")}).done((e=>{e&&0==e.errcode?this.inittranieelist=e.beanlist:e.errdesc?this.toast(e.errdesc):this.toast("服务器错误，请联系管理员。")}))},checkalltrainee(){let{timeFlag:e,isempty:t}=this.checkTime(),s=this;"office"===s.surelevel.levelcode&&s.selectlevels.id&&""!=s.selectlevels.id&&s.typename.id&&""!=s.typename.id&&(t?e?s.inittranieelist.map((e=>{s.typename.id!=e.id?s.student_trainee=[]:this.post("/actionplanbase/getattender",{command:"actionplanbase/getattender",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),actionplanlevel:s.surelevel.levelcode,actiontime:JSON.stringify(s.timeArr),officeattend:"trainee",deptid:s.selectlevels.id}).done((e=>{e&&0==e.errcode?e.result.attendlist.map((e=>{s.student_trainee.push({type:0,id:e.id,name:e.name,username:e.username})})):e.errdesc?this.toast(e.errdesc):this.toast("服务器错误，请联系管理员。")}))})):this.toast("请检查活动日期是否重复!"):this.toast("请选择日期或者时间!"))},inithospitalgradelist(){let e=this;this.post("/traineestudent/queryDictionaryList",{command:"traineestudent/queryDictionaryList",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),uid:$.cookie("uid"),code:"turngrade"}).done((t=>{t&&0==t.errcode?(e.hos_grade_list=t.dic_list,e.initGrade()):t.errdesc?e.toast(t.errdesc):e.toast("服务器错误，请联系管理员。")}))},inithospitalstudentlist(){let e=this;this.post("/traineestudent/queryDictionaryList",{command:"traineestudent/queryDictionaryList",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),uid:$.cookie("uid"),code:"stud_type"}).done((t=>{t&&0==t.errcode?(e.hos_stutype_list=t.dic_list,e.initStutype()):t.errdesc?e.toast(t.errdesc):e.toast("服务器错误，请联系管理员。")}))},inithospitalbaselist(){let e=this;this.post("/deptinfo/getdeptlist",{command:"deptinfo/getdeptlist",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),uid:$.cookie("uid"),deptcode:"base"}).done((t=>{t&&0==t.errcode?(e.hos_base_list=t.beanlist,e.initBase()):t.errdesc?e.toast(t.errdesc):e.toast("服务器错误，请联系管理员。")}))},selectAllGrade(){this.allGrade=!this.allGrade,this.initGrade()},initGrade(){let e=[];this.hos_grade_list.map(((t,s)=>{this.allGrade?e.push(!0):(e.push(!1),this.gradesubmitlist=[])})),this.oneGrade=e},selectGrade(e,t){this.allGrade&&(this.allGrade=!1,this.gradesubmitlist=[]);for(let s=0;s<this.oneGrade.length;s++)s===e&&(this.oneGrade[e]?this.oneGrade.splice(e,1,!1):this.oneGrade.splice(e,1,!0))},selectAllstudenttype(){this.allStutype=!this.allStutype,this.initStutype()},initStutype(){let e=[],t=[];this.hos_stutype_list.map((s=>{this.allStutype?(e.push(!0),t.push(s)):(e.push(!1),this.stutypesubmitlist=[])})),this.oneStutype=e},selectStutype(e,t){this.allStutype&&(this.allStutype=!1,this.stutypesubmitlist=[]);for(let s=0;s<this.oneStutype.length;s++)s===e&&(this.oneStutype[e]?this.oneStutype.splice(e,1,!1):this.oneStutype.splice(e,1,!0))},selectAllBase(){this.allBase=!this.allBase,this.initBase()},initBase(){let e=[],t=[];this.hos_base_list.map((s=>{this.allBase?(e.push(!0),t.push(s)):(e.push(!1),this.basesubmitlist=[])})),this.oneBase=e},selectBase(e,t){this.allBase&&(this.allBase=!1,this.basesubmitlist=[]);for(let s=0;s<this.oneBase.length;s++)s===e&&(this.oneBase[e]?this.oneBase.splice(e,1,!1):this.oneBase.splice(e,1,!0))},hospitalresult(){let e=this;e.allGrade=!1,e.allStutype=!1,e.allBase=!1,e.initGrade(),e.initStutype(),e.initBase()},hospitalsubmit(){let e=this,t=[],s=[],i=[],a=[],l=[],n=[];if($(".grade li.active").each(((e,t)=>{a.push(JSON.parse($(t).attr("gradeItem")))})),e.gradesubmitlist=a,$(".stutype li.active").each(((e,t)=>{l.push(JSON.parse($(t).attr("gradeItem")))})),e.stutypesubmitlist=l,$(".base li.active").each(((e,t)=>{n.push(JSON.parse($(t).attr("gradeItem")))})),e.basesubmitlist=n,0==this.gradesubmitlist.length&&0==this.stutypesubmitlist.length&&0==this.basesubmitlist.length)return e.hospitalcount="",void(e.choicestudent=!1);e.gradesubmitlist.length>0&&e.gradesubmitlist.map((e=>{e.bustype="grade",t.push(e.id)})),e.stutypesubmitlist.length>0&&e.stutypesubmitlist.map((e=>{e.bustype="type",s.push(e.id)})),e.basesubmitlist.length>0&&e.basesubmitlist.map((e=>{e.bustype="base",i.push(e.id)})),e.hossubmitlist={gradelist:e.gradesubmitlist,stutypelist:e.stutypesubmitlist,baselist:e.basesubmitlist},e.post("/actionplanbase/getattender",{command:"actionplanbase/getattender",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),actionplanlevel:"hospital",actiontime:JSON.stringify(e.timeArr),gradebean:{bustype:"grade",gradelist:t},stdtypebean:{bustype:"stdtype",stdtypelist:s},basebean:{bustype:"hospital",hospitallist:i}}).done((t=>{t&&0==t.errcode?(t.result.grouplist.length>0&&t.result.grouplist[0].count?e.hospitalcount=t.result.grouplist[0].count+"人":e.hospitalcount="0人",e.choicestudent=!1):t.errdesc?e.toast(t.errdesc):e.toast("服务器错误，请联系管理员。");let s=[];"hospital"==this.surelevel.levelcode&&s.push(this.hospitalcount),this.form.student=0==s.length?"请选择":s.join("、")}))},selectstarttime(e){this.starttime=e},selectendtime(e){this.endtime=e},initalldept(){let e=this;this.post("/actionplanbase/getusermanagerdept",{command:"actionplanbase/getusermanagerdept",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),uid:$.cookie("uid"),paramcode:"actionplanaddroles"}).done((t=>{t&&0==t.errcode?(e.hospitallist=t.beanlist.hospitallist,e.baselist=t.beanlist.baselist,e.officelist=t.beanlist.officelist,e.initlevellist()):t.errdesc?e.toast(t.errdesc):e.toast("服务器错误，请联系管理员。")}))},initlevellist(){let e=this;this.post("/actionplanbase/getactionplanlevel",{command:"actionplanbase/getactionplanlevel",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),uid:$.cookie("uid")}).done((t=>{if(t&&0==t.errcode){let s,i,a=t.actionplanlevellist;a.map((e=>{this.$set(e,"checkflag",!1),"hospital"==e.levelcode&&(s=e),"base"==e.levelcode&&(i=e)})),e.levellist=a}else t.errdesc?e.toast(t.errdesc):e.toast("服务器错误，请联系管理员。")}))},inittypelist(){let e=this;this.post("/turnbaseinfo/turnbaseinfolevel",{command:"turnbaseinfo/turnbaseinfolevel",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),code:"teachtype"}).done((t=>{t&&0==t.errcode?e.seltype.mainlist=JSON.parse(t.baseinfolevellist):t.errdesc?e.toast(t.errdesc):e.toast("服务器错误，请联系管理员。")}))},sellevel(){this.surelevel?"hospital"==this.levelcode?this.hospitalconfig.show=!0:"base"==this.levelcode?this.popShow=!0:"office"==this.levelcode&&(this.popShow2=!0):this.toast("请先选择活动级别")},selectdept(e){if(!this.levelcode)return this.toast("请先选择活动级别"),!1;this.selectlevels=e,this.teacherlist=[],this.teacher=[],this.studentlist=[],this.student=[],this.student_turndoctor=[],this.student_trainee=[],this.initteacherlist(this.selectlevels.id),this.seldept.show=!1,this.form.dept=this.selectlevels.deptname||this.selectlevels.name},selectlevel(e,t){if(console.log("INPUT"===t.target.tagName,0==e.levelvalue),"INPUT"===t.target.tagName||0==e.levelvalue)return;console.log(e);let s=this;if(e==this.surelevel)return;this.teacherlist=[],this.teacher=[],this.studentlist=[],this.student=[],this.selectlevels="",this.hospitalcount="",this.student_turndoctor=[],this.student_trainee=[],this.studentname="";let i=[],a=[],l=[];this.hos_grade_list.map((e=>{i.push(!1)})),this.hos_stutype_list.map((e=>{a.push(!1)})),this.hos_base_list.map((e=>{l.push(!1)})),this.oneGrade=i,this.oneStutype=a,this.oneBase=l,this.basechecklist.map((e=>{e.ischecked=!1})),this.surelevel=e,this.levellist.map((t=>{t.levelcode==e.levelcode?t.checkflag=!0:t.checkflag=!1})),this.form.dept="请选择",this.form.speakers="请选择",s.selectlevels={},this.form.student="请选择",this.levelcode=e.levelcode,"hospital"==e.levelcode?(this.levelname="院校",s.seldept.mainlist=s.hospitallist,s.student_trainee=[],s.orideptnameidList=[],s.deptnameidList=[],s.indexList=[0,0,0],s.activeKey=0,s.$refs.pick.setColumnIndex(0,0),s.$refs.pick.setColumnIndex(1,0),s.$refs.pick.setColumnIndex(2,0),this.$refs.tree.setCheckedKeys([])):"base"==e.levelcode?(this.levelname="基地",s.seldept.mainlist=s.baselist,s.student_trainee=[],s.orideptnameidList=[],s.deptnameidList=[],s.indexList=[0,0,0],s.activeKey=0,s.$refs.hospital.setColumnIndex(0),this.$refs.tree.setCheckedKeys([])):(this.levelname="科室",s.seldept.mainlist=s.officelist,s.$refs.hospital.setColumnIndex(0),s.$refs.pick.setColumnIndex(0,0),s.$refs.pick.setColumnIndex(1,0),s.$refs.pick.setColumnIndex(2,0)),console.log(s.levelcode)},selecttype(e){console.log(e),console.log(this.teachingActionPlanPeriodSetList);let t="";this.teachingActionPlanPeriodSetList.forEach((s=>{s.paramValue==e.key&&(t=s.param1)})),this.form.period=t,this.periodShow=!!t,this.typename=e,this.form.type=e.name,this.seltype.show=!1},initteacher(){this.selectlevels.id?(this.searchname="",this.choiceteacher=!0):this.toast("请先选择科室")},closeteacher(){if(this.teacher.length<=0)this.toast("请选择主讲人");else{this.choiceteacher=!1;let e=[];this.teacher.forEach((t=>{e.push(t.name)})),this.form.speakers=0==e.length?"请选择":e.join("、")}},initteacherlist(e){if(console.log(this.levelcode),!this.levelcode)return!1;let t,s=this;"hospital"==this.levelcode?(t={hospitalId:e},s.searchConfig.id=e):"base"==this.levelcode?(t={hospitalId:s.hosIdByDept,baseId:e},s.searchConfig.pid=s.hosIdByDept,s.searchConfig.id=e):"office"==this.levelcode&&(t={hospitalId:s.hosIdByDept,deptId:e},s.searchConfig.pid=s.hosIdByDept,s.searchConfig.id=e),this.post("/base/teachers/listSpeaker",t).done((e=>{s.teacherlist=e.model}))},searchteacher(){let e=this;if(""==e.searchname&&"office"==e.surelevel.levelcode)e.initteacherlist(e.selectlevels.id);else{if(!e.searchname)return void this.toast("请输入您要搜索的内容");{let t;"hospital"==this.levelcode?t={hospitalId:e.searchConfig.id,keyword:e.searchname}:"base"==this.levelcode?t={hospitalId:e.searchConfig.pid,baseId:e.searchConfig.id,keyword:e.searchname}:"office"==this.levelcode&&(t={hospitalId:e.searchConfig.pid,deptId:e.searchConfig.id,keyword:e.searchname}),this.post("/base/teachers/listSpeaker",t).done((t=>{e.teacherlist=t.model}))}}},checkTime(){let e=!0,t=!0;return this.timeArr.forEach(((s,i)=>{("请选择"==s.date||"请选择"==s.startTime||"请选择"==s.endTime)&&(t=!1),t&&this.timeArr.forEach(((t,a)=>{i!=a&&(t.start>=s.end||t.end<=s.start||(e=!1))}))})),{timeFlag:e,isempty:t}},initstudent(){var{timeFlag:e,isempty:t}=this.checkTime();this.selectlevels.id?t?e?(this.searchArr=[],"base"==this.surelevel.levelcode?this.getgradelist(this.selectlevels.id,"base","base"):this.getgradelist(this.selectlevels.id,"turn","base"),console.log(this.selectlevels),this.choicestudent=!0):this.toast("请检查活动日期是否重复!"):this.toast("请选择日期或者时间!"):this.toast("请先选择院区基地或者科室")},initgrade(){let e=this;this.post("/turnbaseinfo/turnbaseinfolevel",{command:"turnbaseinfo/turnbaseinfolevel",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),code:"turngrade"}).done((t=>{if(t&&0==t.errcode){e.gradelist=[];let s=JSON.parse(t.baseinfolevellist);s.map((t=>{e.gradelist.push(t.id)}))}else t.errdesc?e.toast(t.errdesc):e.toast("服务器错误，请联系管理员。")}))},initstutype(){let e=this;this.post("/hr/querylevellist",{command:"hr/querylevellist",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),code:"stud_type"}).done((t=>{if(t&&0==t.errcode){e.stutypelist=[];let s=t.levellist;s.map((t=>{e.stutypelist.push(t.key)}))}else t.errdesc?e.toast(t.errdesc):e.toast("服务器错误，请联系管理员。")}))},getgradelist(e,t,s){let i=this;if(i.studentlist=[],i.hospitalattend=t,i.hospitalbusidlist=e,"hospital"==i.surelevel.levelcode&&i.isstutype!==t&&(i.isstutype=t,i.student&&i.student.length>0))for(let l=i.student.length-1;l>=0;l--)1==i.student[l].type&&i.student.splice(l,1);let a={};"hospital"==s?(a.hospitalbusidlist=e,a.hospitalattend=t):"base"==s&&(a.deptid=e,a.baseattend=t),this.post("/actionplanbase/getattender",{command:"actionplanbase/getattender",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),actionplanlevel:s,actiontime:JSON.stringify(this.timeArr),...a}).done((e=>{e&&0==e.errcode?"hospital"==s?e.result.grouplist&&e.result.grouplist.length>0&&(e.result.grouplist.map((e=>{i.studentlist.push({name:e.name,id:e.id,count:e.count,type:1})})),i.selhospital.show=!0):("base"==s&&"base"==t||"base"==s&&"turn"==t)&&(i.basechecklist[0].count=e.result.grouplist[0].count):e.errdesc?i.toast(e.errdesc):i.toast("服务器错误，请联系管理员。")}))},initstudentlist(e){let t=this;"hospital"==t.levelcode?"turndoctor"==e?this.post("/base/turnplandetail/listTurnResident?pageSize=0&pageNum=0",{hospitalId:this.selectlevels.id,actionDateList:[c()(t.date.getTime()).format("YYYY-MM-DD")],userId:$.cookie("uid")}).done((s=>{s&&200==s.resCode&&(t.studentlist=[],t.selofficelist=[],t.selofficetraineelist=[],s.rows?"turndoctor"==e?(s.rows.map((e=>{t.selofficelist.push({type:0,id:e.id,name:e.name,username:e.username})})),t.seloffice.show=!0):"trainee"==e&&(s.rows.map((e=>{t.selofficetraineelist.push({type:3,id:e.id,name:e.name,username:e.username})})),t.selofficetrainee.show=!0):t.toast("当前没有查询到该类型的学员。"))})):this.post("/base/traineeplandetail/listTurnTrainee?pageSize=0&pageNum=0",{hospitalId:this.selectlevels.id,actionDateList:[c()(t.date.getTime()).format("YYYY-MM-DD")],userId:$.cookie("uid")}).done((s=>{s&&200==s.resCode&&(t.studentlist=[],t.selofficelist=[],t.selofficetraineelist=[],s.rows?"turndoctor"==e?(s.rows.map((e=>{t.selofficelist.push({type:2,id:e.id,name:e.name,username:e.username})})),t.seloffice.show=!0):"trainee"==e&&(s.rows.map((e=>{t.selofficetraineelist.push({type:3,id:e.id,name:e.name,username:e.username})})),t.selofficetrainee.show=!0):t.toast("当前没有查询到该类型的学员。"))})):"office"==t.levelcode&&("turndoctor"==e?this.post("/base/turnplandetail/listTurnResident?pageSize=0&pageNum=0",{hospitalId:t.hosIdByDept,deptId:t.selectlevels.id,actionDateList:[c()(t.date.getTime()).format("YYYY-MM-DD")],userId:$.cookie("uid")}).done((s=>{console.log(s),console.log(e),s&&200==s.resCode&&(t.studentlist=[],t.selofficelist=[],t.selofficetraineelist=[],s.rows?"turndoctor"==e?(s.rows.map((e=>{t.selofficelist.push({type:0,id:e.id,name:e.name,username:e.username})})),t.seloffice.show=!0):"trainee"==e&&(s.rows.map((e=>{t.selofficetraineelist.push({type:3,id:e.id,name:e.name,username:e.username})})),t.selofficetrainee.show=!0):t.toast("当前没有查询到该类型的学员。"))})):this.post("/base/traineeplandetail/listTurnTrainee?pageSize=0&pageNum=0",{hospitalId:t.hosIdByDept,deptId:t.selectlevels.id,actionDateList:[c()(t.date.getTime()).format("YYYY-MM-DD")],userId:$.cookie("uid")}).done((s=>{s&&200==s.resCode&&(t.studentlist=[],t.selofficelist=[],t.selofficetraineelist=[],s.rows?"turndoctor"==e?(s.rows.map((e=>{t.selofficelist.push({type:2,id:e.id,name:e.name,username:e.username})})),t.seloffice.show=!0):"trainee"==e&&(s.rows.map((e=>{t.selofficetraineelist.push({type:3,id:e.id,name:e.name,username:e.username})})),t.selofficetrainee.show=!0):t.toast("当前没有查询到该类型的学员。"))})))},choiceall(e){let t=this;"turndoctor"==e?(this.isCheckedAll_a=!this.isCheckedAll_a,this.isCheckedAll_a?t.student_turndoctor=t.selofficelist:t.student_turndoctor=[]):"trainee"==e&&(this.isCheckedAll_b=!this.isCheckedAll_b,this.isCheckedAll_b?t.student_trainee=t.selofficetraineelist:t.student_trainee=[])},searchstudent(){let e=this;e.studentname?this.post("/actionplanbase/getattenderforsearch",{command:"actionplanbase/getattenderforsearch",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),actionplanlevel:e.surelevel.levelcode,attendername:e.studentname}).done((t=>{t&&0==t.errcode&&(e.searchlist=[],t.attendlist&&t.attendlist.length>0&&t.attendlist.map((t=>{e.searchlist.push({type:0,id:t.id,name:t.name,username:t.username})})),0==e.searchlist.length?e.toast("未搜索到哟~"):e.searchconfig.show=!0)})):this.toast("请输入搜索内容")},deletedoctor(e,t,s){let i=this;console.log(e,t,s),console.log(i.student),t?this.showConfirm({title:"温馨提示",msg:"您是否要删除当前参与人员？",theme:"modal-confirm modal-white",cancel:function(){},ok:function(){0==s?(i.student.map(((t,s)=>{t.id==e&&i.student.splice(s,1)})),i.student_turndoctor.map(((t,s)=>{t.id==e&&i.student_turndoctor.splice(s,1)}))):2==s?i.student_turndoctor.map(((t,s)=>{t.id==e&&i.student_turndoctor.splice(s,1)})):3==s&&i.student_trainee.map(((t,s)=>{t.id==e&&i.student_trainee.splice(s,1)}))}}):this.showConfirm({title:"温馨提示",msg:"您是否要删除当前选中主讲人？",theme:"modal-confirm modal-white",cancel:function(){},ok:function(){i.teacher.map(((t,s)=>{t.id==e&&i.teacher.splice(s,1)}))}})},checkbase(e){this.hospitalattend=e.attendbusinfo,this.student.map(((e,t)=>{1==e.type&&this.student.splice(t,1)})),this.student.push(e),this.basechecklist.map((t=>{t.attendbusinfo==e.attendbusinfo?t.ischecked=!0:t.ischecked=!1}));let t=[];this.student.forEach((e=>{let s=e.name+"-"+e.count+"人";t.push(s)})),this.form.student=t.join("、"),this.newbasecount=e.count},submit(){let e=this,{timeFlag:t,isempty:s}=this.checkTime();if(!e.selectlevels.id)return void e.toast("请选择科室！");if(!e.typename)return void e.toast("请选择活动类型！");if(!this.form.theme)return void e.toast("请输入活动主题！");if(this.teacher.length<=0)return void e.toast("请选择主讲人！");if(!this.form.address)return void e.toast("请选择活动地点！");s?t||this.toast("请检查活动日期是否重复!"):this.toast("请选择日期或者时间!");let i=[],a=[];console.log(e.hossubmitlist),"office"==e.surelevel.levelcode?a=e.student.concat(e.student_turndoctor).concat(e.student_trainee):"hospital"==e.surelevel.levelcode?(e.hossubmitlist.gradelist||(e.hossubmitlist.gradelist=[]),e.hossubmitlist.stutypelist||(e.hossubmitlist.stutypelist=[]),e.hossubmitlist.baselist||(e.hossubmitlist.baselist=[]),a=e.student.concat(e.student_turndoctor).concat(e.student_trainee)):a=e.student,console.log("student",a),a&&a.map((t=>{"hospital"==e.surelevel.levelcode?i.push({attendbusid:t.id,attendbusinfo:t.name+"-"+t.username,bustype:"",type:t.type}):"base"==e.surelevel.levelcode?1==t.type&&i.push({attendbusid:e.selectlevels.id,attendbusinfo:t.name+"-"+t.count,bustype:e.hospitalattend,type:t.type}):i.push({attendbusid:t.id,attendbusinfo:t.name+"-"+t.username,bustype:"",type:t.type})}));let l=[];e.teacher&&e.teacher.map((e=>{l.push({uid:e.id})}));let n={attendinfo:{gradebean:{bustype:"",gradelist:[]},stdtypebean:{bustype:"",stdtypelist:[]},basebean:{bustype:"",baselist:[]}}};if(a.length>0)if(n.attendinfo.actionplanlevel=e.surelevel.levelcode,n.attendinfo.deptid=e.selectlevels.id,n.attendinfo.actiontime=JSON.stringify(e.timeArr),"hospital"==e.surelevel.levelcode)e.hossubmitlist&&e.hossubmitlist.gradelist&&e.hossubmitlist.gradelist.length>0&&(e.hossubmitlist.gradelist.map((e=>{n.attendinfo.gradebean.gradelist.push(e.id)})),n.attendinfo.gradebean.bustype="grade",e.hossubmitlist.stutypelist.map((e=>{n.attendinfo.stdtypebean.stdtypelist.push(e.key)})),n.attendinfo.stdtypebean.bustype="stdtype",e.hossubmitlist.baselist.map((e=>{n.attendinfo.basebean.baselist.push(e.id)})),n.attendinfo.basebean.bustype="baselist"),e.student&&e.student.length>0&&(n.attendinfo.hospitalbusidlist=[],e.student.map((e=>{1==e.type&&n.attendinfo.hospitalbusidlist.push(e.id)})));else if("base"==e.surelevel.levelcode)for(let o=0;o<e.basechecklist.length;o++)if(1==e.basechecklist[o].ischecked){n.attendinfo.baseattend=e.basechecklist[o].attendbusinfo,n.attendinfo.actiontime=JSON.stringify(e.timeArr);break}console.log("selectlevels",e.selectlevels),this.showConfirm({title:"温馨提示",msg:"您是否确认提交？",theme:"modal-confirm modal-white",cancel:function(){},ok:function(){e.post("/actionplan/addactionplan",{command:"actionplan/addactionplan",sessionid:$.cookie("sid"),loginid:$.cookie("uid"),uid:$.cookie("uid"),actionplanlevel:e.surelevel.levelcode,theme:e.form.theme,type:e.typename.key,deptid:e.selectlevels.id,place:e.form.address,actiontime:JSON.stringify(e.timeArr),attendinfolist:i,speakerlist:l,remark:e.form.remark,period:e.form.period?Number(e.form.period):null,...n}).done((function(t){t&&0==t.errcode?(e.toast("新增成功~"),setTimeout((()=>{e.$router.push({name:"fdAction_list"})}),500)):t.errdesc?e.toast(t.errdesc):e.toast("服务器错误，请联系管理员。")})).fail((function(e){}))}})},textareaFocus(){$(".g-main").css("padding-bottom","6rem")},textareaBlur(){$(".g-main").css("padding-bottom","0")},back(){let e=this;this.showConfirm({title:"温馨提示",msg:"你当前操作尚未提交保存，是否确认返回？",theme:"modal-confirm modal-white",cancel:function(){},ok:function(){e.$router.push({name:"fdAction_list"})}})},getTree(){let e=this;e.post("/base/dept/listMyHospital",{keywords:"",type:3}).done((t=>{e.hospitalList=t.model})),e.post("/base/dept/getMyDeptTree",{showHospital:1,showNoDeptHospital:0,needBaseDept:1}).done((t=>{e.columns=t.model,e.treeList=t.model[0].childrens,e.hosIdByDept=t.model[0].id,e.hosIdByDeptSave=t.model[0].id})),e.post("/base/dept/getHosBaseTree",{showHospital:1,showNoDeptHospital:0}).done((t=>{t.model.forEach((e=>{null==e.childrens&&(e.childrens=[]),e.childrens&&e.childrens.forEach((e=>{e.childrens=null}))}));let s=t.model;for(let e=0;e<s.length;e++)for(let t=0;t<s[e].childrens.length;t++)0==s[e].childrens[t].havePermission&&(s[e].childrens.splice(t,1),t--);for(let e=0;e<s.length;e++)0==s[e].childrens.length&&(s.splice(e,1),e--);e.columnsc=JSON.parse(JSON.stringify(s).replace(/childrens/g,"children")),console.log(111,e.columnsc)}))},hospitalonConfirm(e,t){let s=this;console.log(e,t),s.hospitalconfig.show=!1,s.hospitalconfig.hospitalselect=t,s.deptid=e.id,s.selectdept(e)},hospitalonCancel(){let e=this;e.$refs.hospital.setColumnIndex(0,e.hospitalconfig.hospitalselect),e.hospitalconfig.show=!1},onConfirm(e,t){let s=this;console.log(2592,s.columnsc),console.log(2593,t),s.indexList=t,console.log(2595,s.columnsc[t[0]].children[t[1]]),s.hosIdByDept=s.columnsc[t[0]].children[t[1]].pid,s.deptname=s.columnsc[t[0]].children[t[1]].name,s.deptid=s.columnsc[t[0]].children[t[1]].id,this.popShow=!1,s.selectdept({id:s.deptid,deptname:s.deptname})},onCancel(){let e=this;e.popShow=!1,console.log(this.indexList),e.$refs.pick.setColumnIndex(0,this.indexList[0]),e.$refs.pick.setColumnIndex(1,this.indexList[1]),e.$refs.pick.setColumnIndex(2,this.indexList[2])},handleNodeClick(e){console.log(e)},onChange(e){let t=this;t.hosIdByDeptSave=t.columns[e].id,t.treeList=t.columns[e].childrens,console.log(t.hosIdByDeptSave)},onClickLeft(){let e=this;e.popShow2=!1,e.activeKey=e.oriactiveKey,e.deptnameidList=e.orideptnameidList,this.$refs.tree.setCheckedKeys(e.orideptnameidList)},onClickRight(){let e=this;e.hosIdByDept=e.hosIdByDeptSave,console.log(2438,e.hosIdByDept),this.$refs.tree.getCheckedKeys()[0]&&this.$refs.tree.getCheckedNodes()[0]?(console.log("22222222222",this.$refs.tree.getCheckedNodes()[0]),e.deptid=this.$refs.tree.getCheckedKeys()[0],e.deptname=this.$refs.tree.getCheckedNodes()[0].name,e.deptnameid=this.$refs.tree.getCheckedKeys()[0],e.deptnameidList=this.$refs.tree.getCheckedKeys(),e.orideptnameidList=this.$refs.tree.getCheckedKeys(),e.deptid=this.$refs.tree.getCheckedNodes()[0].id,e.popShow2=!1,e.selectdept(this.$refs.tree.getCheckedNodes()[0])):((0,l.Z)({message:"请选择科室",position:"bottom"}),(0,l.Z)({message:"请选择科室",position:"bottom"}),(0,l.Z)({message:"请选择科室",position:"bottom"}),(0,l.Z)({message:"请选择科室",position:"bottom"}))},checkClick(e,t,s){t&&this.$refs.tree.setCheckedKeys([e.id])},changetree(e,t){0==t.checkedKeys.length&&this.$refs.tree.setCheckedKeys([e.id])},clickbase(){let e=this;e.popShow=!0},clickdept(){let e=this;e.popShow2=!0,e.oriactiveKey=e.activeKey,e.orideptnameidList=e.deptnameidList,console.log(e.orideptnameidList),this.$refs.tree.setCheckedKeys(e.orideptnameidList)},getPeriodSetList(){let e=this;e.get("/base/commpara/getListByCode?code=teachingActionPlanPeriodSet_4").done((t=>{0!=t.resCode&&200!=t.resCode||(e.teachingActionPlanPeriodSetList=t.model)}))}}},y=b,k=s(1001),C=(0,k.Z)(y,i,a,!1,null,"12a4168e",null),_=C.exports},54816:function(e){e.exports="data:image/png;base64,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"}}]);
//# sourceMappingURL=678.fc38030a.js.map